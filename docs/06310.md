# ARKit + Vision:ä¸€ä¸ªæœ‰è¶£çš„ç»„åˆ

> åŸæ–‡:[https://dev.to/jordanosterberg/arkitâ€”â€”ä¸€ä¸ªæœ‰è¶£çš„ç»„åˆ](https://dev.to/jordanosterberg/arkit--vision-an-intriguing-combination)

ç»è¿‡æ•°å‘¨çš„æ€è€ƒï¼Œæˆ‘åº”è¯¥é¦–å…ˆå¯¹è‹¹æœæ–°å‘å¸ƒçš„ ARKit åšäº›ä»€ä¹ˆï¼Œæˆ‘å†³å®šæˆ‘ä¸ä¼šæŠŠæˆ‘çš„æ€ç»´å±€é™äºè¿™ä¸€ä¸ª APIã€‚æˆ‘å·²ç»çœ‹äº†å¾ˆå¤šå…³äº CoreML/Vision çš„å¯¹è±¡è¯†åˆ«ç‰¹æ€§çš„æ•™ç¨‹ï¼Œæˆ‘å†³å®šäº²è‡ªå°è¯•ä¸€ä¸‹ã€‚

**TLï¼›DR: ARKit å’Œ Vision æ˜¯å®Œç¾çš„ç»“åˆã€‚**

### æˆ‘ä»¬åœ¨åšä»€ä¹ˆï¼Ÿ

æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª ARKit åº”ç”¨ç¨‹åºï¼Œæ— è®ºä½•æ—¶ç‚¹å‡»å±å¹•ï¼Œå®ƒéƒ½ä¼šæ˜¾ç¤º iOS è®¾å¤‡è®¤ä¸ºç›¸æœºä¸­æ˜¾ç¤ºçš„å¯¹è±¡æ˜¯ä»€ä¹ˆã€‚(å‚è§æ–‡ç« åº•éƒ¨çš„ç¤ºä¾‹å›¾ç‰‡)

### é¡¹ç›®è®¾ç½®

æˆ‘ä»¬ä» Xcode (9 æˆ–æ›´é«˜ç‰ˆæœ¬)å¼€å§‹æˆ‘ä»¬çš„æ—…ç¨‹ï¼Œåœ¨é‚£é‡Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„**å¢å¼ºç°å®åº”ç”¨**...

[![select-ar-app](img/5b449ec457977112554308083f64c805.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--PC3jSswv--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/http://i.imgur.com/A4f1KOi.png)

...ç»™å®ƒä¸€ä¸ªåå­—...(åœ¨æˆ‘çš„ä¾‹å­ä¸­æ˜¯â€œarkit-testing-2â€)å¹¶å°†**å†…å®¹æŠ€æœ¯**è®¾ç½®ä¸º **SpriteKit** ...

[![content-tech](img/fd8d742fb1cedf84a280e2f6537cb104.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--1V5J9Oz3--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/http://i.imgur.com/AVO3ecp.png)

...é€‰æ‹©å®ƒåœ¨æˆ‘ä»¬ç¡¬ç›˜ä¸Šçš„ä½ç½®ï¼Œç„¶åå¼€å§‹å·¥ä½œã€‚

### ViewController.swift

æˆ‘ä»¬å°†æŠŠé‡ç‚¹æ”¾åœ¨è¿™å ‚è¯¾çš„é‡è¦ä»£ç ä¸Šï¼Œå› ä¸ºå¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯æ™®é€šçš„æ ·æ¿æ–‡ä»¶ã€‚

```
override func viewWillAppear(_ animated: Bool) {
    super.viewWillAppear(animated)

    // Create a session configuration
    let configuration = ARWorldTrackingSessionConfiguration()

    // Run the view's session
    sceneView.session.run(configuration)
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨`viewWillAppear`ä¸­ï¼Œåˆ›å»ºäº†`ARWorldTrackingSessionConfiguration`ç±»ï¼Œç„¶åè¿è¡Œè§†å›¾çš„ä¼šè¯ã€‚å¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥ä¿®æ”¹é…ç½®ï¼Œä½†æ˜¯åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸ä¼šä½¿ç”¨å®ƒã€‚

```
func view(_ view: ARSKView, nodeFor anchor: ARAnchor) -> SKNode? {
    // Create and configure a node for the anchor added to the view's session.
    let labelNode = SKLabelNode(text: "ğŸ‘¾")
    labelNode.horizontalAlignmentMode = .center
    labelNode.verticalAlignmentMode = .center
    return labelNode;
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œæä¾›äº†ä¸€ä¸ª`ARSKView`å¯¹è±¡å’Œä¸€ä¸ª`ARAnchor`å¯¹è±¡ã€‚è¿™ä¸ª`ARAnchor`ç‰©ä½“ä»¥åä¼šå¾ˆé‡è¦ã€‚åœ¨å‡½æ•°å†…éƒ¨ï¼Œé…ç½®å¹¶è¿”å›ä¸€ä¸ª`SKLabelNode`ã€‚è¿™åœ¨åé¢ä¹Ÿä¼šå¾ˆé‡è¦ã€‚

åœ¨æˆ‘ä»¬è¿›å…¥è¿™ä¸ªæ ·æ¿æ–‡ä»¶ä¸­çš„å¦ä¸€ä¸ªé‡è¦æ–‡ä»¶ä¹‹å‰ï¼Œè®©æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹æˆ‘ä»¬çš„`viewDidLoad`æ–¹æ³•ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ä¼šé‡åˆ°æˆ‘åœ¨åˆ›å»ºè¿™ä¸ªé¡¹ç›®æ—¶é‡åˆ°çš„é”™è¯¯ã€‚

æ›¿æ¢...

```
// Load the SKScene from 'Scene.sks'
if let scene = SKScene(fileNamed: "Scene") {
    sceneView.presentScene(scene)
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

éšç€...

```
let scene = Scene(size: self.view.frame.size)
sceneView.presentScene(scene) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä¸ç¡®å®šè¿™ä¸ªé”™è¯¯æ˜¯ä»€ä¹ˆï¼Œæˆ–è€…ä¸ºä»€ä¹ˆå®ƒå¯ä»¥ä¿®å¤å®ƒï¼Œä½†æ˜¯å®ƒç¡®å®å¯ä»¥ã€‚å¦‚æœéœ€è¦çš„è¯ï¼Œæ‚¨å¯ä»¥å°è¯•åŸå§‹ä»£ç å¹¶æ‰¾åˆ°æ›¿ä»£çš„ä¿®å¤æ–¹æ³•ã€‚

### é›¨ç‡•

é¦–å…ˆï¼Œæ³¨é‡Šæ‰`touchesBegan`ä¸­çš„ä»¥ä¸‹ä»£ç :

```
// Create a transform with a translation of 0.2 meters in front of the camera
var translation = matrix_identity_float4x4
translation.columns.3.z = -0.2
let transform = simd_mul(currentFrame.camera.transform, translation)

// Add a new anchor to the session
let anchor = ARAnchor(transform: transform)
sceneView.session.add(anchor: anchor) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ˜¯çš„ï¼ŒæŠŠè¿™äº›éƒ½æ³¨é‡Šæ‰ã€‚ä¸è¦åˆ é™¤å®ƒï¼Œæˆ‘ä»¬ç¨åä¼šå›æ¥ã€‚

### è¿œæ™¯ï¼

åœ¨`Scene.swift`æ–‡ä»¶ä¸­ï¼Œç¡®ä¿åœ¨å¼€å§‹ä¹‹å‰å¯¼å…¥ Vision æ¡†æ¶:

```
import Vision 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨å»[è‹¹æœå¼€å‘è€…ç½‘ç«™çš„æœºå™¨å­¦ä¹ é¡µé¢](https://developer.apple.com/machine-learning/)ä¸‹è½½ InceptionV3 æ¨¡å‹ã€‚ä½ å¯ä»¥ä¸‹è½½ä½ å–œæ¬¢çš„ä»»ä½•å‹å·ï¼Œè¿™åªæ˜¯æˆ‘å–œæ¬¢çš„ä¸€ä¸ªï¼Œå®ƒçš„æ–‡ä»¶å¤§å°ç›¸å¯¹è¾ƒå°ã€‚

**ç¼–è€…æŒ‰**:ç½‘ç«™ä¸Šå·²ç»æ²¡æœ‰ InceptionV3 å‹å·äº†ã€‚å¹¸è¿çš„æ˜¯ï¼Œæ‚¨å¯ä»¥ä¸‹è½½ä¸åŒçš„æ¨¡å‹å¹¶ç›¸åº”åœ°ä¿®æ”¹ä»£ç ã€‚

æ‚¨ç°åœ¨æ‰€è¦åšçš„å°±æ˜¯å°† InceptionV3 MLModel æ–‡ä»¶æ‹–æ”¾åˆ°æ‚¨çš„é¡¹ç›®ä¸­ï¼Œå°±åƒæ‚¨å¤„ç†ä»»ä½•å…¶ä»–æ–‡ä»¶ä¸€æ ·ã€‚

Xcode åœ¨è¿™é‡Œä¸ºæ‚¨åšçš„æ˜¯ä¸ºæ¨¡å‹ç”Ÿæˆä¸€ä¸ªå¿«æ·çš„æ¥å£ã€‚æˆ‘æ¨èè§‚çœ‹ WWDC17 ä¸Šçš„è§†è§‰å’Œä»‹ç» CoreML ä¼šè®®æ¥äº†è§£æ›´å¤šä¿¡æ¯ï¼Œåˆ†åˆ«ä½äº[è¿™é‡Œ](https://developer.apple.com/videos/play/wwdc2017/506/)å’Œ[è¿™é‡Œ](https://developer.apple.com/videos/play/wwdc2017/703/)ã€‚

ç°åœ¨æˆ‘ä»¬ç»ˆäºå‡†å¤‡å¥½åœ¨`touchesBegan`ä¸­ç¼–å†™ä¸€äº›ä»£ç äº†ã€‚

è®©æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªåå°çº¿ç¨‹ï¼Œä»¥ä¾¿åœ¨è¿è¡Œå…¶ä¸­ä¸€ä¸ªè¯·æ±‚æ—¶ä¸ä¼šå®Œå…¨ç ´åæˆ‘ä»¬åº”ç”¨ç¨‹åºçš„æ€§èƒ½(æˆ‘æ˜¯é€šè¿‡è‰°è‹¦çš„åŠªåŠ›æ‰çŸ¥é“çš„):

```
DispatchQueue.global(qos: .background).async {

} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª doï¼Œcatchï¼Œå¹¶ä»æˆ‘ä»¬åˆšæ‰ä¸‹è½½çš„ CoreML æ¨¡å‹ä¸­åˆ›å»ºä¸€ä¸ª`VNCoreMLModel`å¯¹è±¡(å½“ç„¶ï¼Œè¿™å–å†³äºæ‚¨çš„ç½‘é€Ÿ)

```
do {            
    let model = try VNCoreMLModel(for: Inceptionv3().model)
} catch {} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨æˆ‘ä»¬çš„`do` `catch`é‡Œé¢ï¼Œåœ¨æˆ‘ä»¬çš„æ¨¡å‹åˆå§‹åŒ–ä¹‹åï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª`VNCoreMLRequest`å’Œä¸€ä¸ª`completionHandler`ï¼Œå°±åƒè¿™æ ·:

```
let request = VNCoreMLRequest(model: model, completionHandler: { (request, error) in

}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª`VNImageRequestHandler`å¹¶æ‰§è¡Œæˆ‘ä»¬çš„è¯·æ±‚(åœ¨`VNCoreMLRequest`çš„`completionHandler`ä¹‹åå†™è¿™æ®µä»£ç ):

```
let handler = VNImageRequestHandler(cvPixelBuffer: currentFrame.capturedImage, options: [:])
try handler.perform([request]) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è®©æˆ‘è§£é‡Šä¸€ä¸‹è¿™æ˜¯ä»€ä¹ˆä»£ç ï¼Œå› ä¸ºå®ƒå¯èƒ½æœ‰ç‚¹å¥‡æ€ªã€‚

æˆ‘ä»¬æ­£åœ¨åˆ›å»ºä¸€ä¸ªå›¾åƒè¯·æ±‚å¤„ç†ç¨‹åºæ¥å¤„ç†æˆ‘ä»¬çš„è¯·æ±‚ï¼Œå¹¶å‘å®ƒä¼ é€’ä¸€ä¸ª...

`CVPixelBuffer`ï¼Ÿï¼ï¼Ÿé‚£æ˜¯ä»€ä¹ˆé¬¼ä¸œè¥¿ï¼Ÿæ ¹æ® [StackOverflow](https://stackoverflow.com/questions/41822136/what-is-a-cvpixelbuffer-in-ios) çš„è¯´æ³•ï¼ŒCVPixelBuffer æ˜¯`CoreVideo`æ¡†æ¶çš„ä¸€éƒ¨åˆ†ã€‚å¯¹æˆ‘ä»¬æ¥è¯´å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŠŠ ARKit ä»`currentFrame`ç‰©ä½“ä¸­æ‹‰å‡ºæ¥è®¿é—®å®ƒï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨åšä»»ä½•ç¹é‡çš„å·¥ä½œäº†ã€‚

```
currentFrame.capturedImage 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶åæˆ‘ä»¬ç”¨`handler.perform([request])`æ‰§è¡Œæˆ‘ä»¬çš„è¯·æ±‚ã€‚

ç°åœ¨è®©æˆ‘ä»¬åœ¨`completionHandler` :
é‡Œé¢å†™ä»£ç 

```
// Jump onto the main thread
DispatchQueue.main.async {
    // Access the first result in the array after casting the array as a VNClassificationObservation array
    guard let results = request.results as? [VNClassificationObservation], let result = results.first else {
        print ("No results?")
        return
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¤ªæ£’äº†ï¼Œæˆ‘ä»¬çš„è¯¾å¿«ç»“æŸäº†ã€‚è¿˜è®°å¾—æˆ‘ä»¬ä¹‹å‰è¯„è®ºçš„ä»£ç å—ï¼Ÿè®©æˆ‘ä»¬åœ¨æ‰§è¡Œå®Œé‚£ä¸ª`guard`è¯­å¥åï¼ŒæŠŠå®ƒç²˜è´´è¿›å»ã€‚

æˆ‘ä»¬è¿˜å°†ä¿®æ”¹ä¸€ä¸ªå±æ€§ï¼Œä½¿æˆ‘ä»¬çš„æ–‡æœ¬åœ¨å®ä¾‹åŒ– ARKit å¯¹è±¡æ—¶çœ‹èµ·æ¥ç¦»è®¾å¤‡æ›´è¿œ:

```
// Create a transform with a translation of 0.2 meters in front of the camera
translation.columns.3.z = -0.4 // Originally this was -0.2 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœæ‚¨æ„¿æ„ï¼Œå¯ä»¥å°†æ³¨é‡Šæ›´æ–°ä¸º`0.4`ç±³ï¼Œå› ä¸ºè¯¥æ³¨é‡Šæ˜¯é’ˆå¯¹å±æ€§çš„å‰ä¸€ä¸ªå€¼çš„ã€‚

æœ€åä¸€ä»¶äº‹ï¼Œæˆ‘ä»¬çš„åœºæ™¯è¯¾ç»“æŸäº†ã€‚åˆ›å»ºä¸€ä¸ªåä¸º`ARBridge`çš„æ–° swift æ–‡ä»¶ï¼Œå¹¶ç²˜è´´ä»¥ä¸‹ä»£ç :

```
import UIKit
import ARKit

class ARBridge {

    static let shared = ARBridge()

    var anchorsToIdentifiers = [ARAnchor : String]()

} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

`anchorsToIdentifiers`å±æ€§å°†å…è®¸æˆ‘ä»¬å°†ä¸€ä¸ª ARAnchor ä¸å…¶å¯¹åº”çš„æœºå™¨å­¦ä¹ å€¼ç›¸å…³è”ã€‚

è®©æˆ‘ä»¬ç»™è¿™ä¸ªå­—å…¸æ·»åŠ ä¸€ä¸ªå€¼ï¼Œå¹¶é‡æ–°æ„é€ æˆ‘ä»¬çš„ä»£ç ï¼Œä»¥ä¾¿å®ƒèƒ½æ­£ç¡®æ‰§è¡Œ:

```
// Create a new ARAnchor
let anchor = ARAnchor(transform: transform)

// Set the identifier
ARBridge.shared.anchorsToIdentifiers[anchor] = result.identifier

// Add a new anchor to the session
sceneView.session.add(anchor: anchor) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

é™„æ³¨:å¦‚æœæˆ‘ä»¬åœ¨åœºæ™¯ä¸­æ·»åŠ é”šä¹‹åä¿å­˜äº†æˆ‘ä»¬çš„æ ‡è¯†ç¬¦ï¼Œå®ƒå°†ä¸ä¼šæ­£ç¡®æ˜¾ç¤ºã€‚ç¡®ä¿æ‚¨çš„ä»£ç æŒ‰ç…§ä¸Šé¢æ˜¾ç¤ºçš„é¡ºåºã€‚

æˆ‘ä»¬éƒ½å‡†å¤‡å¥½äº†ï¼è¿™æ˜¯æˆ‘ä»¬åˆšåˆšåœ¨`touchesBegan`å‡½æ•°ä¸­å†™çš„æ‰€æœ‰ä»£ç :

```
DispatchQueue.global(qos: .background).async {
                do {
                    let model = try VNCoreMLModel(for: Inceptionv3().model)
                    let request = VNCoreMLRequest(model: model, completionHandler: { (request, error) in
                        // Jump onto the main thread
                        DispatchQueue.main.async {
                            // Access the first result in the array after casting the array as a VNClassificationObservation array
                            guard let results = request.results as? [VNClassificationObservation], let result = results.first else {
                                print ("No results?")
                                return
                            }

                            // Create a transform with a translation of 0.4 meters in front of the camera
                            var translation = matrix_identity_float4x4
                            translation.columns.3.z = -0.4
                            let transform = simd_mul(currentFrame.camera.transform, translation)

                            // Add a new anchor to the session
                            let anchor = ARAnchor(transform: transform)

                            // Set the identifier
                            ARBridge.shared.anchorsToIdentifiers[anchor] = result.identifier

                            sceneView.session.add(anchor: anchor)
                        }
                    })

                    let handler = VNImageRequestHandler(cvPixelBuffer: currentFrame.capturedImage, options: [:])
                    try handler.perform([request])
                } catch {}
            } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### ã€æœ€åã€‘å›åˆ° ViewController.swift

æˆ‘ä»¬ç°åœ¨å”¯ä¸€éœ€è¦åšçš„å°±æ˜¯ä¿®æ”¹æˆ‘ä»¬çš„`view`æ–¹æ³•æ¥æ£€ç´¢ä¸æˆ‘ä»¬çš„`ARAnchor`ç›¸å…³è”çš„æ–‡æœ¬ï¼Œå®ƒæ˜¯ç”±æˆ‘ä»¬çš„æœºå™¨å­¦ä¹ æ¨¡å‹ç”Ÿæˆçš„ã€‚

```
func view(_ view: ARSKView, nodeFor anchor: ARAnchor) -> SKNode? {
    // Create and configure a node for the anchor added to the view's session.
    guard let identifier = ARBridge.shared.anchorsToIdentifiers[anchor] else {
        return nil
    }

    let labelNode = SKLabelNode(text: identifier)
    labelNode.horizontalAlignmentMode = .center
    labelNode.verticalAlignmentMode = .center
    labelNode.fontName = UIFont.boldSystemFont(ofSize: 16).fontName
    return labelNode
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœæ²¡æœ‰ä¸`ARAnchor`ç›¸å…³è”çš„æ–‡æœ¬ï¼Œåˆ™ä¸è¿”å›`SKNode`ã€‚å¦‚æœæ–‡æœ¬å­˜åœ¨ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª`SKLabelNode`ï¼Œæ”¹å˜å­—ä½“ï¼Œå¹¶è¿”å›å®ƒï¼

## æµ‹è¯•ï¼ï¼ï¼

æˆ‘åœ¨æˆ¿é—´é‡Œè·‘æ¥è·‘å»ï¼ŒæŠŠç›¸æœºå¯¹å‡†éšæœºçš„ç‰©ä½“ï¼Œç»“æœæ˜¯è¿™æ ·çš„:

[![example-1](img/3dacd55ea7728c2c6518c11507ffa371.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--BwFXqvM4--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/http://i.imgur.com/FX0JXeL.jpg)
[![example-2](img/fc2cbcec6ff76cb37cfcf0a2db8109b4.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--RU-la6EM--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/http://i.imgur.com/Ilj3fMN.jpg)
[![example-3](img/61a8d2e3b5698fab1aac400b8fb920e9.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--MQ4Q9IW2--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/http://i.imgur.com/3HGgAkk.jpg)

å®ƒè®¤ä¸ºæˆ‘æ¡Œå­ä¸Šçš„ MacBook Air æ˜¯ä¸€ä¸ªå¬è¯Šå™¨(å¯èƒ½æ˜¯è€³æœºæˆ–éº¦å…‹é£)ï¼Œæˆ‘åºŠå¤´æŸœä¸Šçš„ç¬”æ˜¯ä¸€æŠŠå·¦è½®æ‰‹æªï¼Œæˆ‘çš„ Apple Watch sport band æ˜¯ä¸€æŠŠæ–§å¤´ã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œé¢„æµ‹ç‰©ä½“æ˜¯ä»€ä¹ˆæ˜¯ä»¤äººæƒŠå¥‡çš„ã€‚å®ƒè®¤ä¸ºè¿™ä¸ªé¡¹ç›®çš„ä»£ç æ˜¯ä¸€ä¸ªç½‘ç«™ï¼Œè¿™æ˜¯ç¨å¾®æ­£ç¡®çš„ã€‚å®ƒè¿˜ä» Razer æ£€æµ‹åˆ°äº†æˆ‘çš„é¼ æ ‡å«ä¸Šçš„è›‡å›¾æ¡ˆï¼Œè¿™çœŸæ˜¯å¤ªç¥å¥‡äº†ã€‚

å¯¹äºä¸åŒçš„æ¨¡å‹ï¼Œæˆ‘è‚¯å®šä¼šæœ‰ä¸åŒçš„ç»“æœï¼Œæ‰€ä»¥å°è¯•å¤šä¸ªæ¨¡å‹ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚è¿™å°±åƒå°†å®ƒä»¬æ‹–æ”¾åˆ°é¡¹ç›®ä¸­å¹¶æ›´æ”¹è®¿é—®æ¨¡å‹çš„ä»£ç è¡Œä¸€æ ·ç®€å•ã€‚

æœ€ç»ˆçš„é¡¹ç›®å¯ä»¥åœ¨ GitHub [è¿™é‡Œ](https://github.com/JordanOsterberg/ARKit-Vision-Example)æ‰¾åˆ°ï¼Œå¦‚æœä½ åªæ˜¯æƒ³è¿è¡Œå®ƒï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼

éå¸¸æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼Œå¸Œæœ›æ‚¨å–œæ¬¢æˆ‘å¯¹ ARKit å’Œ Vision çš„(éå¸¸åŸºæœ¬çš„)åŠªåŠ›ï¼