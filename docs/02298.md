# JavaScript çš„ç¥ç§˜â€œè¿™â€â€”â€”ä»€ä¹ˆï¼Œä»€ä¹ˆæ—¶å€™ï¼Œä¸ºä»€ä¹ˆ

> åŸæ–‡:[https://dev.to/ptasker/javascripts-cryptic-this 216](https://dev.to/ptasker/javascripts-cryptic-this--what-when-and-why-216)

<small>*ç…§ç‰‡ç”± Tarun Ram åœ¨ Unsplash* ä¸Šæ‹æ‘„</small>

åœ¨ MDN å¼€å§‹ç»„ç»‡ä»–ä»¬çš„ JavaScript æ–‡æ¡£ä¹‹å‰ï¼Œå¯»æ‰¾ JavaScript é—®é¢˜çš„ç­”æ¡ˆç»å¸¸ä¼šä½¿æ‚¨é™·å…¥å †æ ˆæº¢å‡ºã€‚

å¥½å§ï¼Œè¿™äº›å¤© MDN å·²ç»åŸºæœ¬ä¸Šæ‘’å¼ƒäº†è¿™ç§åšæ³•ï¼Œé™¤éä½ æ­£åœ¨å¯»æ‰¾ JavaScript çš„`this`å…³é”®å­—ç”¨æ³•çš„ç­”æ¡ˆã€‚

[æ–‡æ¡£å¾ˆæ£’](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/this)ï¼ŒçœŸçš„å¾ˆæ£’ï¼Œä½†æ˜¯å®ƒå¹¶æ²¡æœ‰å……æ»¡æœ‰ç”¨çš„ã€çœŸå®çš„ä¾‹å­ã€‚æ‰€ä»¥æˆ‘æƒ³æˆ‘åº”è¯¥æŠŠä¸€äº›å…³äºè¿™ä¸ªå¦‚æ­¤ç¥å¥‡çš„å…³é”®å­—çš„æç¤ºå’ŒæŠ€å·§æ”¾åœ¨ä¸€èµ·ã€‚

### [](#oldskool-js)è€å­¦ç©¶ JS

> "åœ¨æˆ‘é‚£ä¸ªæ—¶ä»£ï¼Œæˆ‘ä»¬å¿…é¡»è­¦æƒ•æˆ‘ä»¬çš„ç›®æ ‡ï¼"

å¥½çš„ï¼Œæ‰€ä»¥æ˜¯çš„ï¼Œå¦‚æœä½ åœ¨ä½ çš„å¼€å‘æ§åˆ¶å°ä¸­è¿è¡Œ`console.log(this)`ï¼Œä½ é€šå¸¸ä¼š*çœ‹åˆ°é»˜è®¤æƒ…å†µä¸‹çš„`this = Window{}`ã€‚è¶…çº§æœ‰ç”¨...ğŸ˜*

 *å½“æ‚¨åœ¨å‡½æ•°
ä¸­æ£€æŸ¥`this`çš„å€¼æ—¶ï¼Œäº‹æƒ…å˜å¾—æ›´åŠ æœ‰è¶£

```
function mahFunc(){
    console.log(this);
}

mahFunc();
// Window{} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‚¨åº”è¯¥ä»ç„¶å¯ä»¥çœ‹åˆ°çª—å£å¯¹è±¡ã€‚å¥½äº†ï¼Œè¿™é‡Œæ²¡ä»€ä¹ˆæ–°ä¸œè¥¿ã€‚

ä½†æ˜¯å¦‚æœåŠ ä¸Š`'use strict'`å‘¢ï¼Ÿ

```
function mahFunc(){
    'use strict'
    console.log(this);
}
// undefined 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å—¯ã€‚

ç°åœ¨å¥½äº†ï¼Œä½†æ˜¯å¦‚æœä½ åœ¨çª—å£ global ä¸Šè°ƒç”¨`mahFunc()`(å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå…¨å±€å‡½æ•°)å‘¢ï¼Ÿ

```
function mahFunc(){
    'use strict'
    console.log(this);
}

window.mahFunc();
// Window 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å•Šï¼Ÿ

ä¸¥æ ¼æ¨¡å¼æ˜¯ä¸€ç§æœ‰è¶£çš„æ–¹å¼ï¼Œä½†æ˜¯å®ƒé€šå¸¸ä¼šä½¿é”™è¯¯æ›´åŠ æ˜æ˜¾ï¼Œå¹¶æ¸…ç†æ‚¨çš„ JavaScriptã€‚

MDN æ–‡æ¡£ä¸­æ²¡æœ‰æåˆ°çš„æ˜¯ï¼Œåƒ Webpack/Browserify è¿™æ ·çš„ç»‘å®šå™¨/åŠ è½½å™¨/è¿æ¥å™¨å¯èƒ½é»˜è®¤å¯ç”¨äº†ä¸¥æ ¼æ¨¡å¼ã€‚ä½ å¯èƒ½æœ€ç»ˆä¼šç”¨ä¸€äº›å¤æ€ªçš„åŠ è½½å™¨åœ¨ä½ ä¸çŸ¥é“çš„æƒ…å†µä¸‹å¯ç”¨å®ƒï¼Œå› ä¸ºä½ æ‰€æœ‰çš„è„šæœ¬éƒ½æ†ç»‘åœ¨ä¸€èµ·ã€‚

æ‰€ä»¥ï¼Œå¦‚æœä½ çœ‹åˆ°ä½ çš„`this`ç”µè¯å›å¤äº†ä¸€äº›æœ‰è¶£çš„äº‹æƒ…ï¼Œè¯·ç•™å¿ƒã€‚

## [](#call-me-plz)å«æˆ‘ plz

å¥½çš„ï¼Œæ‰€ä»¥`this`åœ¨å…¨çƒèŒƒå›´å†…å¾ˆå¥‡æ€ªï¼Œä½†æ˜¯ç°åœ¨è°ä¸ä½¿ç”¨å¯¹è±¡å’Œ ES2015 ç±»å‘¢ï¼Ÿå¦‚æœä½ æƒ³åœ¨ä½ çš„å‡½æ•°ä¸­ä¸º`this`ä½¿ç”¨ä¸åŒçš„å€¼*(as-in not`undefined`æˆ–`Window`)ï¼Œä½ å¯ä»¥ç”¨ [`.call()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call) å’Œ [`.apply()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply) ä¼ é€’ä¸€ä¸ªä¸Šä¸‹æ–‡ã€‚æˆ‘æ€»æ˜¯ç”¨â€˜yadda-yadda . prototype . call()â€™æ¥è®°ä½è¿™äº›ã€‚* 

```
function mahFunc(){
    console.log(this);
}

const config = {

    stepOne(){
        //do step one
    },

    stepTwo(){
        //do step 2
    }
}

mahFunc.call(config);

//{stepOne: Æ’, stepTwo: Æ’} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç»™ä½ ã€‚`this`å¼•ç”¨åœ¨å‚æ•°ä¸­ä¼ é€’ç»™`.call()`çš„å¯¹è±¡ã€‚é…·å§ï¼Ÿ

è¿™æ ·ä½ å°±å¯ä»¥ä¸ºä¸€ä¸ªå‡½æ•°æŒ‡å®šä¸€ä¸ªä¸Šä¸‹æ–‡ã€‚å®ƒéå¸¸æ–¹ä¾¿ï¼Œä¹Ÿæ˜¯å¾ˆå¤šæ¡†æ¶å’Œæ†ç»‘åŒ…åœ¨å†…éƒ¨ä½¿ç”¨çš„â€”â€”çœ‹çœ‹ä½ çš„ Webpack æ†ç»‘åŒ…å§ï¼

æˆ‘ä¸ä¼šä¸€ä¸€åˆ—ä¸¾`this`æ‰€æœ‰å¯èƒ½çš„æƒ…å†µ/ç”¨é€”ï¼Œæœ‰å¾ˆå¤šï¼Œè€Œä¸” [MDN doc](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/this) çœŸçš„å¾ˆå¥½ã€‚

è®°ä½`this`å¾ˆé‡è¦ğŸ™„ã€‚

å¸–å­ [JavaScript çš„ç¥ç§˜â€œè¿™ä¸ªâ€â€”â€”ä»€ä¹ˆï¼Œä»€ä¹ˆæ—¶å€™ï¼Œä¸ºä»€ä¹ˆ](http://petetasker.com/javascripts-cryptic-this-what-when-and-why/)é¦–å…ˆå‡ºç°åœ¨[ä¸ŠğŸ”¥æ•°æ®åº“å…³é”®ğŸ”¥](http://petetasker.com)ã€‚*