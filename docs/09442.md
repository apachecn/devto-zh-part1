# æ„å»ºè‡ªå·±çš„ React è·¯ç”±å™¨ v4

> åŸæ–‡:[https://dev.to/tylermcginnis/build-your-own-react-router-v4](https://dev.to/tylermcginnis/build-your-own-react-router-v4)

æˆ‘ä»ç„¶è®°å¾—æˆ‘ç¬¬ä¸€æ¬¡å¼€å§‹å­¦ä¹ å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºä¸­çš„è·¯ç”±æ—¶çš„æ„Ÿè§‰ã€‚é‚£æ—¶ï¼Œæˆ‘è¿˜åªæ˜¯ä¸€ä¸ªå°ç”·å­©ï¼Œè¿˜åœ¨å°è¯•æ•´ä¸ªâ€œå•é¡µç”³è¯·â€çš„äº‹æƒ…ï¼Œå¦‚æœæˆ‘è¯´è¿™ä¸ä¼šè®©æˆ‘æ»¡è„‘å­éƒ½æ˜¯ä¾¿ä¾¿ï¼Œé‚£æˆ‘å°±æ˜¯åœ¨æ’’è°ã€‚ä»ä¸€å¼€å§‹ï¼Œå°±å¥½åƒæˆ‘çš„å¤§è„‘æŠŠæˆ‘çš„åº”ç”¨ç¨‹åºä»£ç å’Œæˆ‘çš„è·¯ç”±å™¨ä»£ç å½“ä½œä¸¤ä¸ªç‹¬ç‰¹å’Œä¸åŒçš„æƒ³æ³•ã€‚ä»–ä»¬å°±åƒåŒçˆ¶å¼‚æ¯çš„å…„å¼Ÿï¼Œå½¼æ­¤ä¸å–œæ¬¢å¯¹æ–¹ï¼Œä½†æ— è®ºå¦‚ä½•éƒ½è¢«è¿«ç”Ÿæ´»åœ¨ä¸€èµ·ã€‚

åœ¨è¿‡å»çš„å‡ å¹´é‡Œï¼Œæˆ‘å¾ˆå¹¸è¿åœ°èƒ½å¤Ÿå°†è¿™ç§è·¯ç”±æ€æƒ³ä¼ æˆç»™å…¶ä»–å¼€å‘äººå‘˜ï¼Œè¿™ä¸€ç‚¹å¯èƒ½è¿˜æ²¡æœ‰å¾—åˆ°æ‚¨çš„è®¤å¯ã€‚ä¸å¹¸çš„æ˜¯ï¼Œäº‹å®è¯æ˜ï¼Œæˆ‘ä»¬å¤§å¤šæ•°äººçš„å¤§è„‘ä¼¼ä¹ä¸æˆ‘çš„å¤§è„‘ç»“æ„ç›¸ä¼¼ã€‚æˆ‘è®¤ä¸ºè¿™æœ‰å‡ ä¸ªåŸå› ã€‚é¦–å…ˆï¼Œè·¯ç”±é€šå¸¸ç›¸å½“å¤æ‚ã€‚å¯¹äºé‚£äº›åº“ä½œè€…æ¥è¯´ï¼Œè¿™ä½¿å¾—æ‰¾åˆ°è·¯ç”±çš„æ­£ç¡®æŠ½è±¡å˜å¾—æ›´åŠ å¤æ‚ã€‚ç¬¬äºŒï¼Œç”±äºè¿™ç§å¤æ‚æ€§ï¼Œè·¯ç”±åº“çš„æ¶ˆè´¹è€…å€¾å‘äºç›²ç›®åœ°ä¿¡ä»»æŠ½è±¡ï¼Œè€Œæ²¡æœ‰çœŸæ­£ç†è§£å…¶èƒŒåå‘ç”Ÿäº†ä»€ä¹ˆã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ã€‚é¦–å…ˆæ˜¯åè€…ï¼Œé€šè¿‡é‡æ–°åˆ›å»ºæˆ‘ä»¬è‡ªå·±çš„ React è·¯ç”±å™¨ v4 çš„ç®€åŒ–ç‰ˆæœ¬ï¼Œè¿™å°†æ­ç¤ºå‰è€…ï¼Œå³ RRv4 æ˜¯å¦æ˜¯ä¸€ä¸ªåˆç†çš„æŠ½è±¡ã€‚

è¿™æ˜¯æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä»£ç ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å®ƒæ¥æµ‹è¯•æˆ‘ä»¬çš„~React è·¯ç”±å™¨å®ç°ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œç©æœ€åä¸€ä¸ªä¾‹å­

```
const Home = () => (
  <h2>Home</h2>
)

const About = () => (
  <h2>About</h2>
)

const Topic = ({ topicId }) => (
  <h3>{topicId}</h3>
)

const Topics = ({ match }) => {
  const items = [
    { name: 'Rendering with React', slug: 'rendering' },
    { name: 'Components', slug: 'components' },
    { name: 'Props v. State', slug: 'props-v-state' },
  ]

  return (
    <div>
      <h2>Topics</h2>
      <ul>
        {items.map(({ name, slug }) => (
          <li key={name}>
            <Link to={`${match.url}/${slug}`}>{name}</Link>
          </li>
        ))}
      </ul>
      {items.map(({ name, slug }) => (
        <Route key={name} path={`${match.path}/${slug}`} render={() => (
          <Topic topicId={name} />
        )} />
      ))}
      <Route exact path={match.url} render={() => (
        <h3>Please select a topic.</h3>
      )}/>
    </div>
  )
}

const App = () => (
  <div>
    <ul>
      <li><Link to="/">Home</Link></li>
      <li><Link to="/about">About</Link></li>
      <li><Link to="/topics">Topics</Link></li>
    </ul>

    <hr/>

    <Route exact path="/" component={Home}/>
    <Route path="/about" component={About}/>
    <Route path="/topics" component={Topics} />
  </div>
) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœä½ å¯¹ React è·¯ç”±å™¨ v4 ä¸ç†Ÿæ‚‰ï¼Œè¿™é‡Œæœ‰ä¸ªåŸºæœ¬å‰æã€‚å½“ URL ä¸æ‚¨åœ¨ Route çš„`path`å±æ€§ä¸­æŒ‡å®šçš„ä½ç½®åŒ¹é…æ—¶ï¼Œå‘ˆç°ä¸€äº› UIã€‚`Link` s æä¾›äº†ä¸€ç§å£°æ˜å¼çš„ã€å¯è®¿é—®çš„æ–¹å¼æ¥æµè§ˆä½ çš„åº”ç”¨ç¨‹åºã€‚æ¢å¥è¯è¯´ï¼Œ`Link`ç»„ä»¶å…è®¸æ‚¨æ›´æ–° URLï¼Œè€Œ`Route`ç»„ä»¶åŸºäºæ–°çš„ URL æ›´æ”¹æ‚¨çš„ UIã€‚*æœ¬æ•™ç¨‹çš„é‡ç‚¹å®é™…ä¸Šå¹¶ä¸æ˜¯æ•™æˆ RRV4 çš„åŸºç¡€çŸ¥è¯†ï¼Œæ‰€ä»¥å¦‚æœä¸Šé¢çš„ä»£ç ä»ç„¶ä»¤äººå›°æƒ‘ï¼Œè¯·å‰å¾€[å®˜æ–¹æ–‡æ¡£](https://reacttraining.com/react-router)ï¼Œæ‘†å¼„ä¸€ä¸‹ç¤ºä¾‹ï¼Œä¸€æ—¦æ‚¨æ›´ç†Ÿæ‚‰äº†ï¼Œå†å›æ¥ã€‚*

æ‚¨åº”è¯¥æ³¨æ„åˆ°çš„ç¬¬ä¸€ä»¶äº‹æ˜¯ï¼Œæˆ‘ä»¬åœ¨åº”ç”¨ç¨‹åºä¸­å¼•å…¥äº†è·¯ç”±å™¨æä¾›çš„ä¸¤ä¸ªç»„ä»¶ï¼Œ`Link`å’Œ`Route`ã€‚React Router v4 æˆ‘æœ€å–œæ¬¢çš„ä¸€ç‚¹æ˜¯ API æ˜¯â€œJust Componentsâ€ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœæ‚¨å·²ç»ç†Ÿæ‚‰ Reactï¼Œé‚£ä¹ˆæ‚¨å¯¹ç»„ä»¶ä»¥åŠå¦‚ä½•ç»„åˆç»„ä»¶çš„ç›´è§‰å°†ç»§ç»­é€‚ç”¨äºæ‚¨çš„è·¯ç”±ä»£ç ã€‚å¯¹äºæˆ‘ä»¬çš„ç”¨ä¾‹æ¥è¯´ï¼Œæ›´æ–¹ä¾¿çš„æ˜¯ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»ç†Ÿæ‚‰å¦‚ä½•åˆ›å»ºç»„ä»¶ï¼Œåˆ›å»ºæˆ‘ä»¬è‡ªå·±çš„ React è·¯ç”±å™¨åªä¸è¿‡æ˜¯åšæˆ‘ä»¬å·²ç»ç†Ÿæ‚‰çš„äº‹æƒ…ï¼Œåˆ›å»ºæ›´å¤šç»„ä»¶ã€‚

* * *

æˆ‘ä»¬å°†ä»åˆ›å»ºæˆ‘ä»¬çš„`Route`ç»„ä»¶å¼€å§‹ã€‚åœ¨æˆ‘ä»¬æ·±å…¥ç ”ç©¶ä»£ç ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ API(æ–¹ä¾¿çš„æ˜¯å®ƒéœ€è¦å“ªäº›æ”¯æŒ)ã€‚

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä½ ä¼šæ³¨æ„åˆ°`<Route>`å¯ä»¥æ¥å—ä¸‰ä¸ªé“å…·ã€‚`exact`ã€`path`å’Œ`component`ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬çš„`Route`ç»„ä»¶çš„`propTypes`ç›®å‰çœ‹èµ·æ¥åƒè¿™æ ·ï¼Œ

```
static propTypes = {
  exact: PropTypes.bool,
  path: PropTypes.string,
  component: PropTypes.func,
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™é‡Œæœ‰ä¸€äº›å¾®å¦™ä¹‹å¤„ã€‚é¦–å…ˆï¼Œä¸éœ€è¦`path`çš„åŸå› æ˜¯ï¼Œå¦‚æœæ²¡æœ‰ç»™`Route`ä¸€ä¸ªè·¯å¾„ï¼Œå®ƒä¼šè‡ªåŠ¨è¢«æ¸²æŸ“ã€‚ç¬¬äºŒï¼Œ`component`æ²¡æœ‰è¢«æ ‡è®°ä¸ºå¿…éœ€çš„åŸå› æ˜¯ï¼Œå¦‚æœè·¯å¾„åŒ¹é…ï¼Œå®é™…ä¸Šæœ‰å‡ ç§ä¸åŒçš„æ–¹æ³•æ¥å‘Šè¯‰ React Router æ‚¨æƒ³è¦å‘ˆç°çš„ UIã€‚ä¸€ç§ä¸åœ¨ä¸Šé¢ä¾‹å­ä¸­çš„æ–¹æ³•æ˜¯ä½¿ç”¨`render`é“å…·ã€‚çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼Œ

```
<Route path='/settings' render={({ match }) => {
  return <Settings authed={isAuthed} match={match} />
}} /> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å…è®¸ä½ æ–¹ä¾¿åœ°å†…åµŒä¸€ä¸ªè¿”å›ç”¨æˆ·ç•Œé¢çš„å‡½æ•°ï¼Œè€Œä¸æ˜¯åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ç»„ä»¶ã€‚æ‰€ä»¥æˆ‘ä»¬ä¹Ÿå°†å®ƒæ·»åŠ åˆ°æˆ‘ä»¬çš„ propTypes ä¸­ï¼Œ

```
static propTypes = {
  exact: PropTypes.bool,
  path: PropTypes.string,
  component: PropTypes.func,
  render: PropTypes.func,
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†`Route`æ”¶åˆ°äº†ä»€ä¹ˆé“å…·ï¼Œè®©æˆ‘ä»¬å†æ¥è°ˆè°ˆå®ƒå®é™…ä¸Šæ˜¯åšä»€ä¹ˆçš„ã€‚Routeâ€œå½“ URL åŒ¹é…æ‚¨åœ¨ Route çš„`path` prop ä¸­æŒ‡å®šçš„ä½ç½®æ—¶ï¼Œå‘ˆç°ä¸€äº› UIâ€ã€‚åŸºäºè¿™ä¸ªå®šä¹‰ï¼Œæˆ‘ä»¬çŸ¥é“`<Route>`å°†éœ€è¦ä¸€äº›åŠŸèƒ½æ¥æ£€æŸ¥å½“å‰ URL æ˜¯å¦åŒ¹é…ç»„ä»¶çš„`path`å±æ€§ã€‚å¦‚æœæ˜¯çš„è¯ï¼Œæˆ‘ä»¬å°†å‘ˆç°ä¸€äº›ç”¨æˆ·ç•Œé¢ã€‚å¦‚æœæ²¡æœ‰ï¼Œæˆ‘ä»¬å°†é€šè¿‡è¿”å› null ä¸åšä»»ä½•äº‹æƒ…ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹è¿™åœ¨ä»£ç ä¸­æ˜¯ä»€ä¹ˆæ ·å­ï¼Œç›¸ä¿¡æˆ‘ä»¬å°†æ„å»ºå‡ºåŒ¹é…å‡½æ•°ï¼Œç¨åæˆ‘ä»¬å°†ç§°ä¹‹ä¸º`matchPath`ã€‚

```
class Route extends Component {
  static propTypes = {
    exact: PropTypes.bool,
    path: PropTypes.string,
    component: PropTypes.func,
    render: PropTypes.func,
  }

  render () {
    const {
      path,
      exact,
      component,
      render,
    } = this.props

    const match = matchPath(
      location.pathname, // global DOM variable
      { path, exact }
    )

    if (!match) {
      // Do nothing because the current
      // location doesn't match the path prop.

      return null
    }

    if (component) {
      // The component prop takes precedent over the
      // render method. If the current location matches
      // the path prop, create a new element passing in
      // match as the prop.

      return React.createElement(component, { match })
    }

    if (render) {
      // If there's a match but component
      // was undefined, invoke the render
      // prop passing in match as an argument.

      return render({ match })
    }

    return null
  }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨`Route`çœ‹èµ·æ¥ç›¸å½“ç¨³å›ºã€‚å¦‚æœå½“å‰ä½ç½®ä¸ä¼ å…¥çš„`path`å±æ€§åŒ¹é…ï¼Œæˆ‘ä»¬æ¸²æŸ“ä¸€äº› UIï¼Œå¦‚æœä¸åŒ¹é…ï¼Œæˆ‘ä»¬ä»€ä¹ˆä¹Ÿä¸åšã€‚

è®©æˆ‘ä»¬æš‚æ—¶åé€€ä¸€æ­¥ï¼Œè®¨è®ºä¸€ä¸‹è·¯ç”±çš„ä¸€èˆ¬æƒ…å†µã€‚åœ¨å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºä¸­ï¼Œç”¨æˆ·åªæœ‰ä¸¤ç§æ–¹æ³•æ¥æ›´æ–° URLã€‚ç¬¬ä¸€ç§æ–¹æ³•æ˜¯å•å‡»é”šæ ‡è®°ï¼Œç¬¬äºŒç§æ–¹æ³•æ˜¯å•å‡»åé€€/å‰è¿›æŒ‰é’®ã€‚ä»æ ¹æœ¬ä¸Šè¯´ï¼Œæˆ‘ä»¬çš„è·¯ç”±å™¨éœ€è¦çŸ¥é“å½“å‰çš„ URLï¼Œå¹¶åŸºäºå®ƒå‘ˆç° UIã€‚è¿™ä¹Ÿæ„å‘³ç€æˆ‘ä»¬çš„è·¯ç”±å™¨éœ€è¦çŸ¥é“ URL ä½•æ—¶æ”¹å˜ï¼Œè¿™æ ·å®ƒå°±å¯ä»¥æ ¹æ®æ–°çš„ URL æ¥å†³å®šæ˜¾ç¤ºå“ªä¸ªæ–°çš„ UIã€‚å¦‚æœæˆ‘ä»¬çŸ¥é“æ›´æ–° URL çš„å”¯ä¸€æ–¹æ³•æ˜¯é€šè¿‡é”šå®šæ ‡ç­¾æˆ–å‰è¿›/åé€€æŒ‰é’®ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¡åˆ’å¹¶åº”å¯¹è¿™äº›å˜åŒ–ã€‚ç¨åå½“æˆ‘ä»¬æ„å»ºæˆ‘ä»¬çš„`<Link>`ç»„ä»¶æ—¶ï¼Œæˆ‘ä»¬å°†è®¨è®ºé”šæ ‡ç­¾ï¼Œä½†æ˜¯ç°åœ¨ï¼Œæˆ‘æƒ³æŠŠé‡ç‚¹æ”¾åœ¨åé€€/å‰è¿›æŒ‰é’®ä¸Šã€‚React Router ä½¿ç”¨ [History](https://github.com/ReactTraining/history) çš„`.listen`æ–¹æ³•æ¥ç›‘å¬å½“å‰ URL çš„å˜åŒ–ï¼Œä½†æ˜¯ä¸ºäº†é¿å…å¼•å…¥å¦ä¸€ä¸ªåº“ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ HTML5 çš„`popstate`äº‹ä»¶ã€‚`popstate`ï¼Œæ¯å½“ç”¨æˆ·ç‚¹å‡»å‰è¿›æˆ–åé€€æŒ‰é’®å°±ä¼šè¢«è§¦å‘ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ã€‚å› ä¸ºæ˜¯`Route`åŸºäºå½“å‰ URL å‘ˆç°ç”¨æˆ·ç•Œé¢ï¼Œæ‰€ä»¥æ¯å½“å‘ç”Ÿ`popstate`äº‹ä»¶æ—¶ï¼Œèµ‹äºˆ`Route`ç›‘å¬å’Œé‡æ–°å‘ˆç°çš„èƒ½åŠ›æ˜¯æœ‰æ„ä¹‰çš„ã€‚é€šè¿‡é‡æ–°æ¸²æŸ“ï¼Œæ¯ä¸ª`Route`å°†é‡æ–°æ£€æŸ¥å®ƒä»¬æ˜¯å¦ä¸æ–°çš„ URL åŒ¹é…ã€‚å¦‚æœæœ‰ï¼Œä»–ä»¬ä¼šæ¸²æŸ“ UIï¼Œå¦‚æœæ²¡æœ‰ï¼Œä»–ä»¬ä»€ä¹ˆä¹Ÿä¸åšã€‚è®©æˆ‘ä»¬çœ‹çœ‹ç°åœ¨è¿™ä¸ªæ˜¯ä»€ä¹ˆæ ·å­ï¼Œ

```
class Route extends Component {
  static propTypes: {
    path: PropTypes.string,
    exact: PropTypes.bool,
    component: PropTypes.func,
    render: PropTypes.func,
  }

  componentWillMount() {
    addEventListener("popstate", this.handlePop)
  }

  componentWillUnmount() {
    removeEventListener("popstate", this.handlePop)
  }

  handlePop = () => {
    this.forceUpdate()
  }

  render() {
    const {
      path,
      exact,
      component,
      render,
    } = this.props

    const match = matchPath(location.pathname, { path, exact })

    if (!match)
      return null

    if (component)
      return React.createElement(component, { match })

    if (render)
      return render({ match })

    return null
  }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½ åº”è¯¥æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬æ‰€åšçš„å°±æ˜¯åœ¨ç»„ä»¶æŒ‚è½½æ—¶æ·»åŠ ä¸€ä¸ª`popstate`ç›‘å¬å™¨ï¼Œå½“`popstate`äº‹ä»¶è¢«è§¦å‘æ—¶ï¼Œæˆ‘ä»¬è°ƒç”¨`forceUpdate`ï¼Œè¿™å°†å¼€å§‹ä¸€ä¸ªé‡æ–°æ¸²æŸ“ã€‚

ç°åœ¨ï¼Œä¸ç®¡æˆ‘ä»¬æ¸²æŸ“å¤šå°‘ä¸ª`<Route>`,æ¯ä¸ªéƒ½å°†åŸºäºå‰è¿›/åé€€æŒ‰é’®è¿›è¡Œç›‘å¬ã€é‡æ–°åŒ¹é…å’Œé‡æ–°æ¸²æŸ“ã€‚

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨â€œæŒ¥èˆç€æ‰‹â€çš„ä¸€ä»¶äº‹å°±æ˜¯æˆ‘ä»¬çš„`matchPath`å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å¯¹æˆ‘ä»¬çš„è·¯ç”±å™¨è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒå°†å†³å®šå½“å‰çš„ URL æ˜¯å¦ä¸æˆ‘ä»¬ä¸Šé¢è°ˆåˆ°çš„`<Route>`ç»„ä»¶çš„è·¯å¾„ç›¸åŒ¹é…ã€‚ä¸`matchPath`çš„ä¸€ä¸ªç»†å¾®å·®åˆ«æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿è€ƒè™‘åˆ°`<Route>`çš„`exact`é“å…·ã€‚å¦‚æœä½ ä¸ç†Ÿæ‚‰`exact`çš„åŠŸèƒ½ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªç›´æ¥æ¥è‡ªæ–‡æ¡£çš„è§£é‡Š

> å½“`true`æ—¶ï¼Œåªæœ‰å½“è·¯å¾„ä¸`location.pathname` *å®Œå…¨åŒ¹é…*æ—¶æ‰ä¼šåŒ¹é…ã€‚

| path | location.pathname |ç²¾ç¡®|åŒ¹é…ï¼Ÿ|
| `/one` | `/one/two` | `true` |ã€å¦ã€‘|
| `/one` | `/one/two` | `false` |æ˜¯

ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ·±å…¥ç ”ç©¶ä¸€ä¸‹`matchPath`å‡½æ•°çš„å®ç°ã€‚å¦‚æœä½ å›å¤´çœ‹çœ‹æˆ‘ä»¬çš„`Route`ç»„ä»¶ï¼Œä½ ä¼šçœ‹åˆ°`matchPatch`çš„ç­¾åæ˜¯è¿™æ ·çš„ï¼Œ

```
const match = matchPath(location.pathname, { path, exact }) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å…¶ä¸­`match`è¦ä¹ˆæ˜¯å¯¹è±¡ï¼Œè¦ä¹ˆæ˜¯ç©ºå€¼ï¼Œè¿™å–å†³äºæ˜¯å¦åŒ¹é…ã€‚åŸºäºè¿™ä¸ªç­¾åï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·æ„å»º`matchPath`çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œ

```
const matchPatch = (pathname, options) => {
  const { exact = false, path } = options
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€äº› ES6 é­”æœ¯ã€‚æˆ‘ä»¬è¯´â€œåˆ›å»ºä¸€ä¸ªåä¸º exact çš„å˜é‡ï¼Œå®ƒç­‰åŒäº options.exactï¼Œé™¤éå®ƒæ˜¯æœªå®šä¹‰çš„ï¼Œç„¶åå°†å…¶è®¾ç½®ä¸º falseã€‚è¿˜è¦åˆ›å»ºä¸€ä¸ªåä¸º path çš„å˜é‡ï¼Œå®ƒç­‰åŒäº options.pathã€‚

ä¹‹å‰æˆ‘æåˆ°è¿‡â€œä¸éœ€è¦`path`çš„åŸå› æ˜¯å› ä¸ºå¦‚æœæ²¡æœ‰ç»™`Route`ä¸€ä¸ªè·¯å¾„ï¼Œå®ƒä¼šè‡ªåŠ¨è¢«æ¸²æŸ“â€ã€‚å› ä¸ºæ˜¯æˆ‘ä»¬çš„`matchPath`å‡½æ•°é—´æ¥å†³å®šäº†æŸäº›ä¸œè¥¿æ˜¯å¦è¢«æ¸²æŸ“(é€šè¿‡æ˜¯å¦æœ‰åŒ¹é…)ï¼Œç°åœ¨è®©æˆ‘ä»¬æ·»åŠ è¿™ä¸ªåŠŸèƒ½ã€‚

```
const matchPatch = (pathname, options) => {
  const { exact = false, path } = options

  if (!path) {
    return {
      path: null,
      url: pathname,
      isExact: true,
    }
  }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨åˆ°äº†åŒ¹é…éƒ¨åˆ†ã€‚React Router ä¸ºæ­¤ä½¿ç”¨äº† [pathToRegex](https://github.com/pillarjs/path-to-regexp) ï¼Œæˆ‘ä»¬å°†ç®€åŒ–äº‹æƒ…ï¼Œåªä½¿ç”¨ä¸€ä¸ªç®€å•çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚

```
const matchPatch = (pathname, options) => {
  const { exact = false, path } = options

  if (!path) {
    return {
      path: null,
      url: pathname,
      isExact: true,
    }
  }

  const match = new RegExp(`^${path}`).exec(pathname)

} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœä½ ä¸ç†Ÿæ‚‰`.exec`ï¼Œå¦‚æœæ‰¾åˆ°åŒ¹é…ï¼Œå®ƒå°†è¿”å›ä¸€ä¸ªåŒ…å«åŒ¹é…æ–‡æœ¬çš„æ•°ç»„ï¼Œå¦åˆ™è¿”å› nullã€‚

è¿™é‡Œæ˜¯æˆ‘ä»¬çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºè·¯ç”±åˆ°`/topics/components æ—¶çš„æ¯ä¸ª`match`

| path | location . pathname | return value |
|`/`|`/topics/components`|`['/']`|
|`/about`|`null`|
|`/topics`|`['/topics']`|
|`/topics/rendering`|`null`|
|`/topics/components`|`['/topics/components']`|
|`/topics/props-v-state`|`null`|
|`/topics`|`['/topics']`|

> è¯·æ³¨æ„ï¼Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­çš„æ¯ä¸ª`<Route>`éƒ½æœ‰ä¸€ä¸ª`match`ã€‚é‚£æ˜¯å› ä¸ºï¼Œå—¯ï¼Œæ¯ä¸ª`<Route>`åœ¨å®ƒçš„ render æ–¹æ³•ä¸­è°ƒç”¨`matchPath`ã€‚

ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†`.exec`è¿”å›çš„`match`æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬ç°åœ¨éœ€è¦åšçš„å°±æ˜¯æ‰¾å‡ºæ˜¯å¦æœ‰åŒ¹é…ã€‚

`` JavaScript
const match patch =(è·¯å¾„åï¼Œé€‰é¡¹)= > {
const { exact = falseï¼Œpath } =é€‰é¡¹`

 `å¦‚æœ(ï¼path) {
return {
path: nullï¼Œ
url: pathnameï¼Œ
isExact: trueï¼Œ
}
}

const match = new RegExp( `^${path}`)ã€‚æ‰§è¡Œ(è·¯å¾„å)

å¦‚æœ(ï¼match) {
//æ²¡æœ‰åŒ¹é…ã€‚
è¿”å›ç©ºå€¼

const URL = match[0]
const is exact = pathname = = = URL

if (exact &&ï¼isExact) {
//æœ‰åŒ¹é…ï¼Œä½†ä¸æ˜¯
//ç”±
//ç²¾ç¡®é“å…·æŒ‡å®šçš„ç²¾ç¡®åŒ¹é…ã€‚

```
return null 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

}

return {
è·¯å¾„ï¼Œ
urlï¼Œ
isExactï¼Œ
}
}
`

 `* * *

å‰é¢æˆ‘æåˆ°è¿‡ï¼Œå¦‚æœä½ æ˜¯ç”¨æˆ·ï¼Œåªæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥æ›´æ–° URLï¼Œé€šè¿‡åé€€/å‰è¿›æŒ‰é’®ï¼Œæˆ–è€…ç‚¹å‡» achor æ ‡ç­¾ã€‚æˆ‘ä»¬å·²ç»é€šè¿‡`Route`ä¸­çš„`popstate`äº‹ä»¶ç›‘å¬å™¨å¤„ç†äº†åé€€/å‰è¿›ç‚¹å‡»çš„é‡æ–°æ¸²æŸ“ï¼Œç°åœ¨è®©æˆ‘ä»¬é€šè¿‡æ„å»ºæˆ‘ä»¬çš„`Link`ç»„ä»¶æ¥å¤„ç†é”šæ ‡ç­¾ã€‚

`Link`çš„ API çœ‹èµ·æ¥åƒè¿™æ ·ï¼Œ

 ``<Link to='/some-path' replace={false} />`` 

 ``å…¶ä¸­`to`æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ˜¯é“¾æ¥åˆ°çš„ä½ç½®ï¼Œè€Œ`replace`æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå½“å®ƒä¸ºçœŸæ—¶ï¼Œç‚¹å‡»é“¾æ¥å°†æ›¿æ¢å†å²å †æ ˆä¸­çš„å½“å‰æ¡ç›®ï¼Œè€Œä¸æ˜¯æ·»åŠ ä¸€ä¸ªæ–°æ¡ç›®ã€‚

å°†è¿™äº› propTypes æ·»åŠ åˆ°æˆ‘ä»¬çš„é“¾æ¥ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°è¿™ä¸ªï¼Œ

``javascript
class Link extends Component {
static propTypes = {
to: PropTypes.string.isRequired,
replace: PropTypes.bool,
}
}`` 

 ``ç°åœ¨æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬çš„`Link`ç»„ä»¶ä¸­çš„ render æ–¹æ³•éœ€è¦è¿”å›ä¸€ä¸ª anchor æ ‡ç­¾ï¼Œä½†æ˜¯æˆ‘ä»¬æ˜¾ç„¶ä¸æƒ³åœ¨æ¯æ¬¡åˆ‡æ¢è·¯ç”±æ—¶éƒ½åˆ·æ–°æ•´ä¸ªé¡µé¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†é€šè¿‡æ·»åŠ ä¸€ä¸ª`onClick`å¤„ç†ç¨‹åºæ¥åŠ«æŒ anchor æ ‡ç­¾

``javascript
ç±»é“¾æ¥æ‰©å±•ç»„ä»¶{
é™æ€ propTypes = {
åˆ°:PropTypes.string.isRequiredï¼Œ
replace: PropTypes.boolï¼Œ
}`

 `handle click =(event)= > {
const { replaceï¼Œto } = this . props
event . prevent default()

```
// route here. 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

}

render() {
const { toï¼Œchildren} = this.props

```
return (
  <a href={to} onClick={this.handleClick}>
    {children}
  </a>
) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

}
}
`

 `ç°åœ¨æ‰€ç¼ºå°‘çš„å®é™…ä¸Šæ˜¯æ”¹å˜å½“å‰çš„ä½ç½®ã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼ŒReact è·¯ç”±å™¨ä½¿ç”¨äº†[å†å²](https://github.com/reacttraining/history)çš„`push`å’Œ`replace`æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬å°†ä½¿ç”¨ HTML5 çš„[æ¨çŠ¶æ€](https://developer.mozilla.org/en-US/docs/Web/API/History_API#The_pushState()_method)å’Œ[æ›¿æ¢çŠ¶æ€](https://developer.mozilla.org/en-US/docs/Web/API/History_API#The_replaceState()_method)æ–¹æ³•æ¥é¿å…æ·»åŠ ä¾èµ–é¡¹ã€‚

> åœ¨æœ¬å¸–ä¸­ï¼Œæˆ‘ä»¬å°†å†å²åº“ä½œä¸ºé¿å…å¤–éƒ¨ä¾èµ–æ€§çš„ä¸€ç§æ–¹å¼ï¼Œä½†è¿™å¯¹ React è·¯ç”±å™¨ä»£ç è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒè§„èŒƒäº†åœ¨å„ç§æµè§ˆå™¨ç¯å¢ƒä¸­ç®¡ç†ä¼šè¯å†å²çš„å·®å¼‚ã€‚

`pushState`å’Œ`replaceState`éƒ½æ¥å—ä¸‰ä¸ªå‚æ•°ã€‚ç¬¬ä¸€ä¸ªæ˜¯ä¸æ–°çš„å†å²æ¡ç›®ç›¸å…³è”çš„å¯¹è±¡â€”â€”æˆ‘ä»¬ä¸éœ€è¦è¿™ä¸ªåŠŸèƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬åªä¼ å…¥ä¸€ä¸ªç©ºå¯¹è±¡ã€‚ç¬¬äºŒä¸ªæ˜¯æ ‡é¢˜ï¼Œæˆ‘ä»¬ä¹Ÿä¸éœ€è¦å®ƒï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ä¼ å…¥ nullã€‚ç¬¬ä¸‰ä¸ªï¼Œä¹Ÿæ˜¯æˆ‘ä»¬å®é™…ä½¿ç”¨çš„ä¸€ä¸ªï¼Œæ˜¯ä¸€ä¸ªç›¸å¯¹ URLã€‚

`` JavaScript
const history push =(path)=>{
history . pushstate({ }ï¼Œnullï¼Œpath)
}`

 `const history replace =(path)= > {
history . replace state({ }ï¼Œnullï¼Œpath)
}
`

 `ç°åœ¨åœ¨æˆ‘ä»¬çš„`Link`ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬å°†æ ¹æ®`replace`å±æ€§è°ƒç”¨`historyPush`æˆ–`historyReplace`ï¼Œ

``javascript
ç±»é“¾æ¥æ‰©å±•ç»„ä»¶{
é™æ€ prop types = {
to:prop types . string . is requiredï¼Œ
replace: PropTypes.boolï¼Œ
}
handle click =(event)=>{
const { replaceï¼Œto } = this . props
event . prevent default()`

 ````
replace ? historyReplace(to) : historyPush(to) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

}

render() {
const { toï¼Œchildren} = this.props

```
return (
  <a href={to} onClick={this.handleClick}>
    {children}
  </a>
) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

}
}
`

 `* * *

ç°åœ¨ï¼Œæˆ‘ä»¬åªéœ€è¦å¢åŠ ä¸€é¡¹é‡è¦çš„å†…å®¹ã€‚å¦‚æœæ‚¨ç”¨æˆ‘ä»¬å½“å‰çš„è·¯ç”±å™¨ä»£ç æ¥ç©æˆ‘ä»¬çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œæ‚¨ä¼šæ³¨æ„åˆ°ä¸€ä¸ªç›¸å½“å¤§çš„é—®é¢˜ã€‚å½“ä½ å››å¤„å¯¼èˆªæ—¶ï¼ŒURL ä¼šæ›´æ–°ï¼Œä½†æ˜¯ UI ä¼šä¿æŒä¸å˜ã€‚è¿™æ˜¯å› ä¸ºå³ä½¿æˆ‘ä»¬ç”¨`historyReplace`æˆ–`historyPush`å‡½æ•°æ”¹å˜äº†ä½ç½®ï¼Œæˆ‘ä»¬çš„`<Route>`å¹¶ä¸çŸ¥é“è¿™ç§æ”¹å˜ï¼Œä¹Ÿä¸çŸ¥é“å®ƒä»¬åº”è¯¥é‡æ–°æ¸²æŸ“å’ŒåŒ¹é…ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦è·Ÿè¸ªå“ªäº›`<Route>`å·²ç»è¢«æ¸²æŸ“ï¼Œå¹¶åœ¨è·¯çº¿æ”¹å˜æ—¶è°ƒç”¨å®ƒä»¬çš„`forceUpdate`ã€‚

> React Router é€šè¿‡ç»“åˆä½¿ç”¨ setStateã€context å’Œ history æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

ä¸ºäº†ä¿æŒæˆ‘ä»¬çš„è·¯ç”±å™¨ç®€å•ï¼Œæˆ‘ä»¬å°†é€šè¿‡å°†å®ƒä»¬çš„å®ä¾‹æ¨é€åˆ°ä¸€ä¸ªæ•°ç»„æ¥è·Ÿè¸ªå“ªäº›`<Route>`å·²ç»è¢«æ¸²æŸ“ï¼Œç„¶åæ¯å½“ä½ç½®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥éå†è¯¥æ•°ç»„å¹¶åœ¨æ‰€æœ‰å®ä¾‹ä¸Šè°ƒç”¨ forceUpdateã€‚

`` JavaScript
let instances =[]`

 `const register =(comp)= > instances . push(comp)
const unregister =(comp)=>instances . splice(instances . index of(comp)ï¼Œ1)
`

 `æ³¨æ„æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸¤ä¸ªå‡½æ•°ã€‚æ¯å½“ä¸€ä¸ª`<Route>`è¢«å®‰è£…çš„æ—¶å€™æˆ‘ä»¬å°±è°ƒç”¨`register`ï¼Œæ¯å½“å®ƒè¢«å¸è½½çš„æ—¶å€™æˆ‘ä»¬å°±è°ƒç”¨`unregister`ã€‚ç„¶åï¼Œæ¯å½“æˆ‘ä»¬è°ƒç”¨`historyPush`æˆ–`historyReplace`(æ¯æ¬¡ç”¨æˆ·ç‚¹å‡»`<Link>`æ—¶æˆ‘ä»¬éƒ½ä¼šè¿™æ ·åš)ï¼Œæˆ‘ä»¬å¯ä»¥éå†è¿™äº›å®ä¾‹å’Œ`forceUpdate`ã€‚

è®©æˆ‘ä»¬é¦–å…ˆæ›´æ–°æˆ‘ä»¬çš„`<Route>`ç»„ä»¶ï¼Œ

``javascript
ç±»è·¯ç”±æ‰©å±•ç»„ä»¶{
é™æ€ prop types:{
path:prop types . stringï¼Œ
exact: PropTypes.boolï¼Œ
ç»„ä»¶:PropTypes.funcï¼Œ
render: PropTypes.funcï¼Œ
}`

 `componentWillMount(){
addevent listener(" popstate "ï¼Œthis . handle pop)
register(this)
}

componentWillUnmount() {
å–æ¶ˆæ³¨å†Œ(this)
removeEventListener(" popstate "ï¼Œthis.handlePop)
}

...
}
`

 `ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ›´æ–°`historyPush`å’Œ`historyReplace`

`` JavaScript
const history push =(path)=>{
history . pushstate({ }ï¼Œnullï¼Œpath)
instances . foreach(instance =>instance . force update())
}`

 `const history replace =(path)= > {
history . replace state({ }ï¼Œnullï¼Œpath)
instances . foreach(instance =>instance . force update())
}
`

 `ğŸ‰ç°åœ¨ï¼Œæ¯å½“ä¸€ä¸ª`<Link>`è¢«ç‚¹å‡»å¹¶ä¸”ä½ç½®æ”¹å˜æ—¶ï¼Œæ¯ä¸ª`<Route>`éƒ½ä¼šæ„è¯†åˆ°è¿™ä¸€ç‚¹å¹¶é‡æ–°åŒ¹é…å’Œæ¸²æŸ“ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬å®Œæ•´çš„è·¯ç”±å™¨ä»£ç çœ‹èµ·æ¥åƒä¸‹é¢çš„ä»£ç ï¼Œæˆ‘ä»¬ä¸Šé¢çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºå¯ä»¥å¾ˆå¥½åœ°ä½¿ç”¨å®ƒã€‚

``javascript
ä»' react 'å¯¼å…¥ Reactï¼Œ{ PropTypesï¼ŒComponent }`

 `let instances = []

const register =(comp)= > instances . push(comp)
const unregister =(comp)=>instances . splice(instances . index of(comp)ï¼Œ1)

const history push =(path)= > {
history . pushstate({ }ï¼Œnullï¼Œpath)
instances . foreach(instance =>instance . force update())
}

const history replace =(path)= > {
history . replacestate({ }ï¼Œnullï¼Œpath)
instances . foreach(instance =>instance . force update())
}

const matchPath =(è·¯å¾„åï¼Œé€‰é¡¹)=> {
const { exact = falseï¼Œpath } =é€‰é¡¹

å¦‚æœ(ï¼path) {
return {
path: nullï¼Œ
url:è·¯å¾„åï¼Œ
isExact: true
}
}

const match = new RegExp( `^${path}`)ã€‚æ‰§è¡Œ(è·¯å¾„å)

å¦‚æœ(ï¼åŒ¹é…)
è¿”å› null

const URL = match[0]
const is exact = pathname = = = URL

if (exact &&ï¼isExact)
è¿”å›ç©ºå€¼

return {
è·¯å¾„ï¼Œ
urlï¼Œ
isExactï¼Œ
}

ç±»è·¯ç”±æ‰©å±•ç»„ä»¶{
é™æ€å±æ€§ç±»å‹:{
è·¯å¾„:å±æ€§ç±»å‹.å­—ç¬¦ä¸²ï¼Œ
ç¡®åˆ‡:å±æ€§ç±»å‹.å¸ƒå°”ï¼Œ
ç»„ä»¶:å±æ€§ç±»å‹.å‡½æ•°ï¼Œ
æ¸²æŸ“:å±æ€§ç±»å‹.å‡½æ•°ï¼Œ
}

componentWillMount(){
addevent listener(" popstate "ï¼Œthis . handle pop)
register(this)
}

componentWillUnmount() {
å–æ¶ˆæ³¨å†Œ(this)
removeEventListener(" popstate "ï¼Œthis.handlePop)
}

handle pop =()= > {
this . force update()
}

render() {
const {
pathï¼Œ
exactï¼Œ
componentï¼Œ
renderï¼Œ
} = this.props

```
const match = matchPath(location.pathname, { path, exact })

if (!match)
  return null

if (component)
  return React.createElement(component, { match })

if (render)
  return render({ match })

return null 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

}
}

ç±»é“¾æ¥å°†ç»„ä»¶{
é™æ€ propTypes = {
æ‰©å±•ä¸º:PropTypes.string.isRequiredï¼Œ
replace: PropTypes.boolï¼Œ
}
handle click =(event)=>{
const { replaceï¼Œto } = this.props

```
event.preventDefault()
replace ? historyReplace(to) : historyPush(to) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

}

render() {
const { toï¼Œchildren} = this.props

```
return (
  <a href={to} onClick={this.handleClick}>
    {children}
  </a>
) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

}
}
`

 `é¢å¤–æ”¶è·:React è·¯ç”±å™¨ API è¿˜é™„å¸¦äº†ä¸€ä¸ª`<Redirect>`ç»„ä»¶ã€‚ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰ç¼–å†™çš„ä»£ç ï¼Œåˆ›å»ºè¿™ä¸ªç»„ä»¶éå¸¸ç®€å•

``javascript
ç±»é‡å®šå‘æ‰©å±•ç»„ä»¶{
é™æ€é»˜è®¤é“å…·= {
push: false
}`

 `é™æ€ prop types = {
to:prop types . string . is requiredï¼Œ
push:prop types . bool . is requiredï¼Œ
}

componentidmount(){
const { toï¼Œpush } = this.props

```
push ? historyPush(to) : historyReplace(to) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

}

render() {
è¿”å› null
}
}
`

 `è¯·æ³¨æ„ï¼Œè¿™ä¸ªç»„ä»¶å®é™…ä¸Šå¹¶ä¸å‘ˆç°ä»»ä½• UIï¼Œç›¸åï¼Œå®ƒçº¯ç²¹å……å½“è·¯ç”±æ§åˆ¶å™¨ï¼Œå› æ­¤å¾—åã€‚

æˆ‘å¸Œæœ›è¿™æœ‰åŠ©äºæ‚¨æ›´å¥½åœ°ç†è§£ React Router ä¸­å‘ç”Ÿçš„äº‹æƒ…ï¼ŒåŒæ—¶ä¹Ÿæœ‰åŠ©äºæ‚¨æ¬£èµ React Router çš„ä¼˜é›…å’Œâ€œåªæ˜¯ç»„ä»¶â€APIã€‚æˆ‘ä¸€ç›´è¯´ React ä¼šè®©ä½ æˆä¸ºæ›´å¥½çš„ JavaScript å¼€å‘è€…ã€‚æˆ‘ç°åœ¨ä¹Ÿç›¸ä¿¡ React è·¯ç”±å™¨ä¼šè®©ä½ æˆä¸ºæ›´å¥½çš„ React å¼€å‘è€…ã€‚å› ä¸ºä¸€åˆ‡éƒ½åªæ˜¯ç»„ä»¶ï¼Œæ‡‚ React å°±æ‡‚ React è·¯ç”±å™¨ã€‚

psã€‚æ„Ÿè°¢ Ryanï¼Œä»–åˆ›å»ºäº†è¿·ä½ è·¯ç”±å™¨çš„ç¬¬ä¸€ä¸ªå®ç°ï¼Œå¹¶åœ¨è¿™ç¯‡æ–‡ç« ä¸­å¸®åŠ©äº†æˆ‘ã€‚``````````````````````