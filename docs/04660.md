# ä½¿ç”¨ React å±æ€§ç±»å‹è½»æ¾éªŒè¯å±æ€§

> åŸæ–‡:[https://dev . to/a _ reiterer/validating-props-easy-with-react-proptypes-PLG](https://dev.to/a_reiterer/validating-props-easily-with-react-proptypes-plg)

React PropTypes æ˜¯ä¸€ç§é€šè¿‡éªŒè¯é€šè¿‡ props ä¼ é€’çš„å€¼çš„æ•°æ®ç±»å‹æ¥å¸®åŠ©æ‚¨æ•è· bug çš„å¥½æ–¹æ³•ã€‚å®ƒä»¬è¿˜æä¾›äº†å°† props æ ‡è®°ä¸ºå¼ºåˆ¶æˆ–è®¾ç½®é»˜è®¤å€¼çš„å¯èƒ½æ€§ã€‚å®ƒä»¬ä¸è´¹å¹ç°ä¹‹åŠ›å°±èƒ½å¸¦æ¥å·¨å¤§çš„å¥½å¤„ã€‚

[FrÃ© Sonneveld](https://unsplash.com/photos/2qLT_Rq-2tk?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) åœ¨ [Unsplash](https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) ä¸Šçš„æ ‡é¢˜ç…§ç‰‡

## [](#introduction)ç®€ä»‹

å¦‚æœä½ æƒ³æŠŠä»»ä½•å€¼ä¼ é€’ç»™ä¸€ä¸ªç»„ä»¶ï¼Œä½ ä¸ä¼šç»•è¿‡ *props* ã€‚å®ƒä»¬æ˜¯ç»„ä»¶çš„æ¥å£ï¼Œç”¨äºè·å–ç»„ä»¶æ ‘ä¸­çš„æ•°æ®ã€‚å½“æ‚¨çš„åº”ç”¨ç¨‹åºå˜å¾—æ›´å¤§æ›´å¤æ‚æ—¶ï¼Œæ‚¨æˆ–æ‚¨çš„åŒäº‹å¯èƒ½æƒ³è¦é‡ç”¨ä¸€äº›ç°æœ‰çš„ç»„ä»¶ã€‚å¯èƒ½ä½ å¾ˆä¹…ä»¥å‰å°±å†™å¥½äº†ç»„ä»¶ï¼Œæ‰€ä»¥ä½ å¾—å¼„æ¸…æ¥šï¼Œæ€ä¹ˆç”¨ï¼Œéœ€è¦å“ªäº›é“å…·ã€‚

ä¸ºäº†æ‰¾åˆ°ç­”æ¡ˆï¼Œä½ å¯ä»¥çœ‹çœ‹è¿™ä¸ªç»„ä»¶çš„æºä»£ç ï¼Œçœ‹çœ‹æ‰€æœ‰å‡ºç°çš„ *this.props* ã€‚æ‚¨å¯ä»¥æƒ³è±¡è¿™å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ï¼Œè¿™å–å†³äºç»„ä»¶ã€‚ä½†æ˜¯ç°åœ¨ä½ çŸ¥é“å“ªäº›é“å…·æ˜¯å¿…é¡»çš„äº†ï¼Œä½ å¯ä»¥å¼€å§‹äº†â€”â€”ä½†æ˜¯ç­‰ç­‰ï¼Œä½ çŸ¥é“è¦ä¼ ä¸‹æ¥çš„*æ˜¯ä»€ä¹ˆ*å—ï¼Ÿä»…ä»…æ˜¯ä¸€ä¸ª*å­—ç¬¦ä¸²*è¿˜æ˜¯éœ€è¦ä¸€ä¸ª*å¯¹è±¡*ï¼Ÿä½ çœ‹ï¼Œæ²¡é‚£ä¹ˆå®¹æ˜“ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªè§£å†³æ–¹æ¡ˆ: **React PropTypes** ã€‚

## React prop types åˆ°åº•æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Ÿ

PropTypes ä¸ä»…å¯ä»¥å¸®åŠ©æ‚¨æ•è· bugï¼Œè¿˜å¯ä»¥ä½œä¸ºä¸€ä¸ªæ–¹ä¾¿çš„æ–‡æ¡£ï¼Œè¯´æ˜å¦‚ä½•ä½¿ç”¨ç»„ä»¶æ¥ä¼ é€’å±æ€§ã€‚è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå°ä¾‹å­:

```
import React from 'react';
import PropTypes from 'prop-types';

const Person = (props) => <div> 
  <h1>{props.firstName} {props.lastName}</h1>
  {props.country ? <p>Country: {props.country}</p> : null}
</div>;

Person.propTypes = {
  firstName:PropTypes.string,
  lastName:PropTypes.string,
  country:PropTypes.string
};

export default Person; 
```

å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªå°ç»„ä»¶æ¥æ˜¾ç¤ºä¸€ä¸ªäººçš„å§“åå’Œå›½å®¶ã€‚æˆ‘ä»¬å°†åå­—å’Œå§“æ°æ˜¾ç¤ºä¸ºæ ‡é¢˜ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªåŒ…å«å›½å®¶çš„æ®µè½ï¼Œä½†å‰ææ˜¯è®¾ç½®äº†å›½å®¶ã€‚ä¸€å¼€å§‹ï¼Œæˆ‘åªæ˜¯åˆ›å»ºäº†*å±æ€§ç±»å‹*æ¥å®šä¹‰ç±»å‹ï¼Œè€Œä¸å…³å¿ƒå¼ºåˆ¶å±æ€§ã€‚

é‚£ä¹ˆå®ƒæ˜¯åšä»€ä¹ˆçš„å‘¢ï¼Ÿ*é“å…·ç±»å‹*å®šä¹‰ä¸€ä¸ª*é“å…·*çš„ç±»å‹ã€‚æ‰€ä»¥æ¯æ¬¡ï¼Œä¸€ä¸ªå€¼é€šè¿‡ä¸€ä¸ªå±æ€§ï¼Œå®ƒçš„ç±»å‹è¢«éªŒè¯ã€‚å¦‚æœæ‚¨é€šè¿‡*å±æ€§*ä¼ é€’ä¸€ä¸ªä¸*å±æ€§ç±»å‹*ä¸­æŒ‡å®šçš„æ•°æ®ç±»å‹ä¸åŒçš„å€¼ï¼Œæ‚¨çš„æµè§ˆå™¨æ§åˆ¶å°ä¸­å°†ä¼šæ˜¾ç¤ºä¸€æ¡é”™è¯¯æ¶ˆæ¯:

[![Warning: Failed prop type: Invalid prop `country` of type `number` supplied to `Person`, expected `string`.](../Images/3c53e545708200dd95cef87c3089c9a9.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--veZAwTT0--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/http://www.andreasreiterer.at/wp-content/uploads/2017/09/propTypes_wrong_type_error.jpg) 

<figcaption>å½“ä½ ä¼ é€’ä¸€ä¸ªå¸¦æœ‰é”™è¯¯æ•°æ®ç±»å‹çš„å€¼æ—¶å¾—åˆ°çš„é”™è¯¯æ¶ˆæ¯</figcaption>

å¦‚æœä½ è¿™æ ·è®¾ç½®ä½ çš„*å±æ€§ç±»å‹*ï¼Œä½ å·²ç»å¾—åˆ°äº†ç¬¬ä¸€ä¸ªå¥½å¤„:

*   æ‚¨å¾ˆå®¹æ˜“å‘ç°ç”±äºä¼ é€’é”™è¯¯æ•°æ®ç±»å‹(ä¾‹å¦‚:å¯¹è±¡è€Œä¸æ˜¯å­—ç¬¦ä¸²)çš„æ•°æ®è€Œå¯¼è‡´çš„é”™è¯¯
*   ä½¿ç”¨ä½ çš„ç»„ä»¶çš„äººå¯ä»¥åœ¨ä¸€ä¸ªåœ°æ–¹çœ‹åˆ°æ‰€æœ‰å¯ç”¨çš„*å±æ€§*ï¼ŒåŒ…æ‹¬ä»–ä»¬æƒ³è¦çš„æ•°æ®ç±»å‹ã€‚
*   ä¸€äº›ä»£ç ç¼–è¾‘å™¨æ”¯æŒ props çš„ä»£ç è¡¥å…¨ï¼Œå› æ­¤å½“æ‚¨åœ¨å·¥å…·æç¤ºä¸­è¾“å…¥ç»„ä»¶æ—¶ï¼Œå¯ä»¥çœ‹åˆ°å¯ç”¨çš„ propsã€‚

ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†ä»€ä¹ˆæ˜¯ PropTypesï¼Œä»¥åŠå®ƒä»¬çš„ç”¨é€”ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å®ƒä»¬è¿˜èƒ½åšä»€ä¹ˆã€‚

## [](#data-type-validation)æ•°æ®ç±»å‹éªŒè¯

å¦‚ä¸Šä¾‹æ‰€ç¤ºï¼Œ *React å±æ€§ç±»å‹*ç”¨äºæ•°æ®ç±»å‹éªŒè¯ã€‚è¿™å°±æ˜¯å®ƒä»¬çš„ç”¨é€”ã€‚æˆ‘è®¤ä¸ºå¤§å¤šæ•°æ—¶å€™ä½ å¯èƒ½ä¼šæ£€æŸ¥åŸºæœ¬çš„æ•°æ®ç±»å‹ã€‚

### [](#basic-data-types-arrays-and-objects)åŸºæœ¬æ•°æ®ç±»å‹ã€æ•°ç»„å’Œå¯¹è±¡

ä»¥ä¸‹æ˜¯åŸºæœ¬æ•°æ®ç±»å‹å’Œçš„ç¤ºä¾‹:

```
Person.propTypes = {
  email: PropTypes.string,
  age: PropTypes.number,
  worksRemote: PropTypes.bool,
  updateCallback: PropTypes.func
} 
```

å¯ä»¥ä½¿ç”¨çš„å…¶ä»–ç±»å‹æœ‰:

```
PropTypes.array,
PropTypes.arrayOf(PropTypes.string),
PropTypes.object,
PropTypes.objectOf(PropTypes.number) 
```

### [](#complex-data-types)å¤æ‚æ•°æ®ç±»å‹

ç”šè‡³å¯ä»¥æ ¹æ®ç‰¹å®šçš„å½¢çŠ¶æ¥éªŒè¯æ™®é€šçš„ JavaScript å¯¹è±¡:

```
Person.propTypes = { 
  car: PropTypes.shape({
    registrationNumber: PropTypes.string,
    year: PropTypes.number
  })
} 
```

ä½ åˆšæ‰çœ‹åˆ°çš„æ˜¯ä¸€ä¸ªå¦‚ä½•éªŒè¯ä¸€ä¸ªå¯¹è±¡çš„ä¾‹å­ï¼Œè¿™ä¸ªå¯¹è±¡å·²ç»é€šè¿‡äº†*â€œcarâ€é“å…·ã€‚*å¦‚æœæ‚¨ä¼ é€’ä¸€ä¸ªå¸¦æœ‰å­—ç¬¦ä¸²å­—æ®µâ€œyearâ€çš„å¯¹è±¡ï¼Œæ‚¨ä¼šå¾—åˆ°ä¸€æ¡é”™è¯¯æ¶ˆæ¯ã€‚å¤ªå¥½äº†ï¼

### [](#specifying-a-range-of-valid-prop-values)æŒ‡å®šæœ‰æ•ˆå±æ€§å€¼çš„èŒƒå›´

æœ‰æ—¶ï¼Œæ‚¨å¯èƒ½å¸Œæœ›ä¼ é€’ä¸€ä¸ªåˆé€‚å€¼ï¼Œä¹Ÿå°±æ˜¯ç»™å®šçš„ä¸€ç»„å€¼ä¸­çš„ä¸€ä¸ªã€‚è¿™æ ·åšï¼Œå¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·:

```
Person.propTypes = {
  gender: PropTypes.oneOf([
    'female', 'male'
  ])
} 
```

å¦‚æœä½ ç°åœ¨é€šè¿‡*ã€æ€§åˆ«ã€‘å±æ€§ä¼ é€’*ã€æœªçŸ¥ã€‘*ï¼Œ*ä½ çš„æµè§ˆå™¨ä¼šæ˜¾ç¤ºä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºå®ƒä¸ç¬¦åˆæŒ‡å®šçš„*å±æ€§ç±»å‹:*

[![Warning: Failed prop type: Invalid prop `gender` of value `unknown` supplied to `Person`, expected one of ["female","male"].](../Images/8f0d543d5372528dc6cdc0a4e05f8bba.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--3BbvwVbh--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/http://www.andreasreiterer.at/wp-content/uploads/2017/09/propTypes_oneOf_error.jpg) 

<figcaption>ä¼ é€’çš„å±æ€§ä¸ç¬¦åˆæŒ‡å®šçš„å€¼é›†</figcaption>

é™¤äº†æŒ‡å®šç¡®åˆ‡çš„å€¼ï¼Œæ‚¨è¿˜å¯ä»¥ä¸º*å±æ€§*æŒ‡å®šä¸€ç»„ç±»å‹:

```
PropTypes.oneOfType([
  PropTypes.string,
  PropTypes.number
]) 
```

## [](#flagging-props-as-mandatory)å°†é“å…·æ ‡è®°ä¸ºå¼ºåˆ¶

è¿™æ˜¯å¦ä¸€ä¸ªé‡è¦çš„è¯é¢˜ã€‚å¦‚æœä½ æƒ³è¦æ±‚ä»»ä½•ä½¿ç”¨ä½ çš„ç»„ä»¶çš„äººæ€»æ˜¯é€šè¿‡æŸä¸ªé“å…·ï¼Œä½ å¯ä»¥æŠŠå®ƒæ ‡è®°ä¸ºå¼ºåˆ¶çš„ã€‚çœ‹çœ‹ä½ å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ï¼Œè¿™å¾ˆç®€å•ï¼ğŸ˜Š

ä½ è¿˜è®°å¾—è¿™ç¯‡æ–‡ç« å¼€å¤´çš„ä¾‹å­å—ï¼Ÿæˆ‘å°†å†æ¬¡æ˜¾ç¤ºå®ƒï¼Œä½†ç°åœ¨æˆ‘ä»¬å°†åå­—å’Œå§“æ°æ ‡è®°ä¸º**å¿…éœ€çš„**:

```
[...]

const Person = (props) => <div> 
  <h1>{props.firstName} {props.lastName}</h1>
  {props.country ? <p>Country: {props.country}</p> : null}
</div>;

Person.propTypes = { 
  firstName:PropTypes.string.isRequired, 
  lastName:PropTypes.string.isRequired, 
  country:PropTypes.string 
}; 

[...] 
```

é‚£å¾ˆå®¹æ˜“ï¼Œä¸æ˜¯å—ï¼Ÿæ‚¨å¯ä»¥å°†â€œisRequiredâ€é“¾æ¥åˆ°ä»»ä½•ç»™å®šçš„ PropType æ•°æ®ç±»å‹ï¼Œå¦‚æœæ²¡æœ‰æä¾›*å±æ€§*ï¼Œè¿™å°†å¯¼è‡´ä¸€ä¸ªé”™è¯¯æ¶ˆæ¯ã€‚

## [](#set-default-prop-values)è®¾ç½®é»˜è®¤å±æ€§å€¼

å¦‚æœæ‚¨å¸Œæœ›æŸäº›å±æ€§åœ¨æœªæä¾›ä»»ä½•å†…å®¹çš„æƒ…å†µä¸‹å…·æœ‰é»˜è®¤å€¼ï¼Œæ‚¨å¯ä»¥é€šè¿‡å®šä¹‰ *defaultProps* æ¥å®ç°:

```
Person.defaultProps = {
  country: 'Austria' 
} 
```

ä»¥ä¸Šç¡®ä¿äº†æ¯å½“æœ‰äººä½¿ç”¨ *"Person"* ç»„ä»¶å¹¶ä¸”æ²¡æœ‰æä¾›å›½å®¶æ—¶ï¼Œè¯¥äººè‡ªåŠ¨å˜æˆå¥¥åœ°åˆ©äººï¼ğŸ˜

## [](#wrapping-up)åŒ…è£…å®Œæ¯•

*React å±æ€§ç±»å‹*æ˜¯éªŒè¯ç»„ä»¶è¾“å…¥çš„å¥½æ–¹æ³•ã€‚è€Œä¸”ï¼Œå¦‚æœæœ‰äººè¦ä½¿ç”¨æ‚¨çš„ç»„ä»¶ï¼Œå®ƒä¼šæä¾›æ‰€æœ‰å¯ç”¨å±æ€§å’Œé¢„æœŸæ•°æ®ç±»å‹çš„å¿«é€Ÿæ¦‚è¿°ã€‚

æ‰€ä»¥åœ¨ä½ çš„ä¸‹ä¸€ä¸ªç»„ä»¶ä¸­ï¼Œå°è¯•ä½¿ç”¨ *PropTypes* æ¥é¿å…ä¸€äº›è®¨åŒçš„é”™è¯¯ï¼Œå¹¶å¤§å¤§æé«˜ç»„ä»¶çš„å¯é‡ç”¨æ€§ã€‚

ä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« å¹¶æƒ³é˜…è¯»æ›´å¤šå—ï¼Ÿæ³¨å†Œæˆ‘çš„[ç®€è®¯](https://www.andreasreiterer.at/dev-newsletter/)ã€‚
ä½ ä¼šæŠŠæˆ‘ä»¥åæ‰€æœ‰çš„å¸–å­ç›´æ¥å‘åˆ°ä½ çš„æ”¶ä»¶ç®±é‡Œï¼Œä½ å¯ä»¥éšæ—¶é€€è®¢ã€‚

* * *

ç”¨ React PropTypes è½»æ¾éªŒè¯é“å…·çš„å¸–å­[æœ€æ—©å‡ºç°åœ¨](http://www.andreasreiterer.at/web-development/react-proptypes/) [Andreas Reiterer](http://www.andreasreiterer.at) ä¸Šã€‚