# å°†å±æ€§ç±»å‹ååº”åˆ°æµä»£ç æ¨¡å¼

> åŸæ–‡:[https://dev . to/Kenneth _ skov HUS/react-prop types-to-flow-code mod-4gh 8](https://dev.to/kenneth_skovhus/react-proptypes-to-flow-codemod-4gh8)

æˆ‘å°†å±•ç¤ºå¦‚ä½•ä½¿ç”¨ React PropTypes è‡ªåŠ¨è½¬æ¢æ‚¨ç°æœ‰çš„ä»£ç åº“ï¼Œä»¥ä½¿ç”¨æ›´å¼ºå¤§çš„æµæ³¨é‡Šã€‚å¦‚æœä½ å·²ç»çœ‹åˆ°äº†ä¸ºä»€ä¹ˆè¿™æ˜¯æœ‰ä»·å€¼çš„ï¼Œä½ å¯ä»¥è·³åˆ°ä¸‹ä¸€éƒ¨åˆ†ã€‚ğŸ‘‡ğŸ»

<figure>[![Eye candy, because you deserve it (unsplash.com/@thekorus)](img/165c3e782d4bb57f986598507dad200c.png "Eye candy, because you deserve it (unsplash.com/@thekorus)")](///static/4822d2d94a48a54d885e84246876a4ac/6e525/flow-unsplash.jpg) 

<figcaption>å…»çœ¼ï¼Œå› ä¸ºä½ å€¼å¾—æ‹¥æœ‰(unsplash.com/@thekorus)</figcaption>

</figure>

å¦‚æœè¯´ React æ˜¯è„¸ä¹¦å¼€å‘å£°æ˜å¼å’Œå¯ç»„åˆ UI çš„å…¥é—¨è¯ï¼Œé‚£ä¹ˆ React PropTypes è®©å¾ˆå¤šäººå¼€å§‹è¿›è¡Œç±»å‹æ£€æŸ¥ã€‚

PropTypes è®°å½•ç»™å®šç»„ä»¶çš„å±æ€§ï¼Œå¹¶åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¯¹å±æ€§è¿›è¡Œè¿è¡Œæ—¶éªŒè¯ã€‚æˆ‘å‘ç°å®ƒä»¬çœŸçš„å¾ˆæœ‰å¸®åŠ©ï¼Œä½†æ˜¯å®ƒä»¬ä¹Ÿæœ‰å‡ ä¸ªç¼ºç‚¹ã€‚æœ€å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨æ‰“å¼€æµè§ˆå™¨ä¹‹å‰æ•æ‰é”™è¯¯ã€‚å‘é™æ€ç±»å‹æ£€æŸ¥é—®å¥½ã€‚

ä¸ºäº†å¯¹åº”ç”¨ç¨‹åºè¿›è¡Œé™æ€ç±»å‹æ£€æŸ¥ï¼Œå¯ä»¥ä½¿ç”¨ JavaScript æ‰©å±•ï¼Œå¦‚ [Flow](https://flow.org/) æˆ– [TypeScript](https://www.typescriptlang.org/) ã€‚åœ¨è¿™ç¯‡åšæ–‡ä¸­ï¼Œæˆ‘ä¸»è¦å…³æ³¨æµï¼Œä½†æ˜¯åŒæ ·çš„æ–¹æ³•ä¹Ÿå¯ä»¥åº”ç”¨äº TypeScriptã€‚

## æ¯«æ— ç–‘é—®(å¯¹æˆ‘æ¥è¯´):æ„å»ºæ—¶çš„é™æ€ç±»å‹æ£€æŸ¥(ä½¿ç”¨ Flow æˆ– TypeScript)è¿œè¿œä¼˜äºè¿è¡Œæ—¶éªŒè¯ã€‚

å¦‚æœä½ æ˜¯å¿ƒæµæ–°æ‰‹ï¼Œ[æ–°æ–‡æ¡£ç¡®å®å¾ˆå¥½](https://flow.org/)ã€‚è®¾ç½®å¥½æµä¹‹åï¼Œä½ ç°åœ¨å¯ä»¥å¼€å§‹ç±»å‹æ³¨é‡Šä½ çš„ç»„ä»¶çŠ¶æ€å’Œå±æ€§äº†ã€‚å¯¹äºä¸€ä¸ªç®€å•çš„ç»„ä»¶ï¼Œå®ƒå¯èƒ½çœ‹èµ·æ¥åƒ:

```
/* 1) Using good old PropTypes */
function Button({ message }) =>
  <button>{message}</button>; 
Button.propTypes = {
  message: PropTypes.oneOfType([
    PropTypes.string,
    PropTypes.number,
    PropTypes.instanceOf(Message)
  ]).isRequired,
};

/* 2) Using Flow annotations */
type Props = {
  message: string | number | Message,
};

function Button({ message }: Props) =>
  <button>{message}</button>; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åˆ°ç›®å‰ä¸ºæ­¢ä¸€åˆ‡é¡ºåˆ©ã€‚ä½†æ˜¯è½¬æ¢ä¸€ä¸ªç°æœ‰çš„ä»£ç åº“æ¥ä½¿ç”¨æµæ³¨é‡Šè€Œä¸æ˜¯ PropTypes å¯èƒ½æ˜¯ä¹å‘³çš„â€¦ç„¶è€Œè¿™å¯¹äºä¸€ä¸ª codemod æ¥è¯´æ˜¯ä¸€ä¸ªå®Œç¾çš„ä»»åŠ¡ï¼

## ä¿®æ”¹ä»£ç çš„æ—¶é—´

ä¸ºäº†è‡ªåŠ¨åŒ– React PropTypes åˆ°æµæ³¨é‡Šçš„è½¬æ¢ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å¦ä¸€ä¸ªç”±è„¸ä¹¦æ¨å¹¿çš„å·¥å…·:[jscodeshift](https://github.com/facebook/jscodeshift)(JavaScript code mod toolkit)ã€‚

å¦‚æœä½ å¯¹ä½¿ç”¨ codemods è¿›è¡Œè‡ªåŠ¨åŒ–é‡æ„çš„æ¦‚å¿µä¸ç†Ÿæ‚‰ï¼Œæˆ‘å°†æ¨å¹¿æˆ‘åœ¨ meetup ä¸Šåšçš„ä¸€ä¸ªæ¼”è®²:[â€œä½¿ç”¨ JS codemods è¿›è¡Œè‡ªåŠ¨åŒ–é‡æ„çš„ä»‹ç»(Copenhagen.js Meetupï¼Œ2016 å¹´ 12 æœˆ)â€](https://www.youtube.com/watch?v=eMI0UBav8Q4):

[![Introduction to automated refactoring with JS codemods (Copenhagen.js Meetup, December 2016)](img/6801c574177c181db06ccbaadc529130.png)T2ã€‘](https://www.youtube.com/watch?v=eMI0UBav8Q4)

è¯´å¤Ÿäº†ã€‚æ˜¯æ—¶å€™æ‘†è„± PropTypes äº†ï¼åŸæ¥ [Billy Vong](https://github.com/billyvg) å·²ç»ç”¨[code mod-prop types-to-flow](https://github.com/billyvg/codemod-proptypes-to-flow)ä¸ºæˆ‘ä»¬åšäº†å¾ˆå¤šè‰°è‹¦çš„å·¥ä½œã€‚

å› æ­¤ï¼Œè¦è‡ªåŠ¨è½¬æ¢æ–‡ä»¶å¤¹ my-components ä¸­çš„æ‰€æœ‰ç»„ä»¶:

*   `git clone https://github.com/billyvg/codemod-proptypes-to-flow`
*   `jscodeshift -t codemod-proptypes-to-flow/src/index.js my-components`
*   çœ‹æ²¡æœ‰ PropTypesï¼(å°½ç®¡`createClass`ï¼Œå¯¼å…¥çš„å’Œå®šåˆ¶çš„ PropTypes éªŒè¯å™¨è¿˜ä¸è¢«æ”¯æŒâ€”â€”åˆ°ç›®å‰ä¸ºæ­¢ï¼)

æˆ‘å·²ç»æˆåŠŸåœ°åœ¨å¤šä¸ªé¡¹ç›®ä¸­ä½¿ç”¨äº†è¿™ä¸ª codemodï¼Œå®ƒæå¤§åœ°ç®€åŒ–äº†è½¬æ¢ã€‚ç°åœ¨ Flow å¼€å§‹åœ¨ä½ å†™ä»£ç çš„æ—¶å€™å‘ç°é”™è¯¯ï¼Œè€Œä¸æ˜¯åœ¨ä»£ç æ‰§è¡Œçš„æ—¶å€™ï¼ğŸ· ğŸ™ŒğŸ»

* * *

è¯·æ³¨æ„ï¼Œæœ‰äº›æƒ…å†µä¸‹æ‚¨å¸Œæœ›ä¿ç•™æ‚¨çš„å±æ€§ç±»å‹(å¯èƒ½ä¸æµæ³¨é‡Šä¸€èµ·):

*   åº“ä»£ç ä¸­çš„å±æ€§ç±»å‹å¯ä»¥å¸®åŠ©ç”¨æˆ·å¹¶è®°å½•æ¥å£
*   å¦‚æœæ‚¨æ²¡æœ‰éªŒè¯ä»»ä½•å¤–éƒ¨èµ„æº(å¦‚ API)çš„æµå®šä¹‰çš„è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ŒPropTypes ä¼šéå¸¸æœ‰ç”¨ã€‚ä¸ºæ­¤ï¼Œæˆ‘æ¨èä½¿ç”¨[babel-plugin-flow-react-proptypes](https://github.com/brigand/babel-plugin-flow-react-proptypes)åœ¨æ„å»ºæ—¶æ·»åŠ  PropTypes
*   PropTypes å¯¹äº React ä¸Šçš„å­¦ä¹ ææ–™ä»ç„¶å¾ˆæœ‰ç”¨(ä¸éœ€è¦ç”¨ Flow/TypeScript ç»™æ–°äººå¢åŠ è´Ÿæ‹…)
*   PropTypes å¯ä»¥æ¯”æµç±»å‹æ£€æŸ¥å™¨å½“å‰æ”¯æŒçš„æ›´åŠ çµæ´»(ä¾‹å¦‚ï¼Œ[éªŒè¯ä¸€ä¸ªæ•°å­—åœ¨ä¸€ä¸ªç‰¹å®šçš„èŒƒå›´å†…](https://twitter.com/Daniel15/status/851232924225556480)

* * *

*è¿™ç¯‡åšæ–‡æ˜¯ä»[https://skovhus.github.io/react-prop-types-to-flow-codemod/](https://skovhus.github.io/react-prop-types-to-flow-codemod/)T3 äº¤å‰å‘å¸ƒçš„*

*æ„Ÿè°¢[é©¬å¥‘å…‹Â·ä½©å¡æ‹‰](https://twitter.com/penzington)å’Œ[éº¦å…¹Â·å“ˆç‰¹æ›¼](https://twitter.com/Mads_Hartmann)å®¡é˜…è¿™ç¯‡æ–‡ç« ã€‚*