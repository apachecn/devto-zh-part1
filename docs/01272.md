# ç”¨ç¡’å’Œç§‘ç‰¹æ—è¿›è¡Œ E2E æµ‹è¯•

> åŸæ–‡:[https://dev . to/chrisvasqm/e2e-ç”¨ç¡’å’Œ kotlin-1kia æµ‹è¯•](https://dev.to/chrisvasqm/e2e-testing-with-selenium-and-kotlin-1kia)

# ç•™å¿ƒ

#### è¿™å°†æ˜¯ä¸€ç¯‡ looong å¸–å­ã€‚æ‰€ä»¥ï¼Œæ‹¿æ¯å’–å•¡/èŒ¶ï¼ŒæŠ“ç´§æ—¶é—´ï¼

# ç®€ä»‹

### ä»€ä¹ˆæ˜¯ E2Eï¼Ÿ

*ç«¯åˆ°ç«¯(E2E)æµ‹è¯•*æ˜¯ä¸€ç§ç”¨äºæµ‹è¯•æ•´ä¸ªæµç¨‹çš„æŠ€æœ¯ï¼Œå°±åƒæˆ‘ä»¬æ˜¯ä¸€ä¸ªçœŸå®çš„ç”¨æˆ·ä¸€æ ·ï¼Œé€šè¿‡æ¨¡æ‹Ÿä»–ä»¬åœ¨æµè§ˆå™¨ä¸Šçš„è¡Œä¸º(ç‚¹å‡»ã€æŒ‰ä¸‹æŸäº›é”®ã€åœ¨å­—æ®µä¸­é”®å…¥å†…å®¹ç­‰)ã€‚

### ç¡’æ˜¯ä»€ä¹ˆï¼Ÿ

Selenium æ˜¯ä¸€ä¸ªç”¨äº web åº”ç”¨ç¨‹åºçš„è‡ªåŠ¨åŒ–æ¡†æ¶ã€‚

### ä»€ä¹ˆæ˜¯ç§‘ç‰¹æ—ï¼Ÿ

Kotlin æ˜¯ä¸€ç§é™æ€ç±»å‹çš„ç¼–ç¨‹è¯­è¨€ï¼Œç”± T2 Jetbrains å…¬å¸å¼€å‘ï¼Œå¯ç”¨äºå‰ç«¯å’Œåç«¯çš„ç½‘ç»œã€ç§»åŠ¨å’Œæ¡Œé¢åº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬å°†åœ¨ JVM ä¸Šä½¿ç”¨å®ƒã€‚

### ä»€ä¹ˆæ˜¯çˆ±æƒ…ï¼Ÿ

å®è´ä¸è¦ä¼¤å®³æˆ‘...

æŠ±æ­‰ï¼Œæˆ‘ä¸å¾—ä¸è¿™ä¹ˆåšï¼

# è¦æ±‚

## [è¿™é‡Œ](#ide)

æˆ‘å°†ä½¿ç”¨åŒæ ·ç”± Jetbrains å¼€å‘çš„ IntelliJ IDEAã€‚

ä»ä»–ä»¬çš„[ä¸‹è½½é¡µé¢](https://www.jetbrains.com/idea/download/)ï¼Œé€‰æ‹©ç¤¾åŒºç‰ˆ(å…è´¹)ã€‚

[![IntelliJ IDEA download page](img/576bba26cdf1c6e8a2cdcda9f65eb08b.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--29dNWbKJ--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/gxu9ss9m2ahblelf2jye.png)

## ç¡’

å‰å¾€ Selenium çš„[ä¸‹è½½é¡µé¢](http://www.seleniumhq.org/download/)ä¸‹è½½ã€‚jar æ–‡ä»¶ï¼Œä½äºâ€œSelenium ç‹¬ç«‹æœåŠ¡å™¨â€éƒ¨åˆ†ã€‚

[![Selenium download page](img/8e265854adbbbe52f50bb00e1b480c6c.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--o_EzVtTT--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/xlr45xu3aqnp9jn9fowl.png)

[![Selenium download link](img/6db017f826787a06576720ba94327a44.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--FRXbJN1Q--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/6z7bfbnwrub40t5kvxjy.png)

## èŠ‚ç‚¹

è¿™å¯ä»¥é€šè¿‡ä»–ä»¬çš„[ç½‘ç«™](https://nodejs.org/en/download/)æˆ–è€…é€šè¿‡ä½ çš„æ“ä½œç³»ç»Ÿçš„ç»ˆç«¯/å‘½ä»¤è¡Œæ¥å®Œæˆ(æ­¥éª¤ä¼šå› ä½ çš„æ“ä½œç³»ç»Ÿè€Œå¼‚)ã€‚

ä¹‹åï¼Œä¸ºäº†éªŒè¯ NodeJS æ˜¯å¦å®‰è£…æˆåŠŸï¼Œåœ¨ç»ˆç«¯/å‘½ä»¤è¡Œä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤:

`npm -v`

ä½ åº”è¯¥èƒ½çœ‹åˆ°ç‰ˆæœ¬å·ï¼Œæˆ‘å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œæˆ‘çš„ç‰ˆæœ¬æ˜¯ 5.6.0ã€‚

## æµè§ˆå™¨é©±åŠ¨ç¨‹åº

åœ¨æˆ‘ä»¬çš„æœºå™¨ä¸Šå®‰è£…äº†`npm`ä¹‹åï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥å®‰è£…æˆ‘ä»¬éœ€è¦çš„æµè§ˆå™¨é©±åŠ¨ç¨‹åºäº†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è°·æ­Œæµè§ˆå™¨(è¿™é‡Œçš„[æ–‡ä»¶](https://github.com/SeleniumHQ/selenium/wiki)ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨ä¸€ä¸ªä¸åŒçš„æœç´¢â€œé©±åŠ¨ç¨‹åºâ€åœ¨å³è¾¹çš„å¯¼èˆªæ )ã€‚

### Chromedriver

ä¸ºäº†å®‰è£…`chromedriver`ï¼Œæ‚¨å¿…é¡»åœ¨ç»ˆç«¯/å‘½ä»¤è¡Œä¸Šè¿è¡Œä»¥ä¸‹å‘½ä»¤:

`npm install chromedriver`

ç°åœ¨ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå†æ¬¡æ£€æŸ¥å®‰è£…æ˜¯å¦æˆåŠŸå®Œæˆ:

`chromedriver -v`

### ç‰›é€¼ï¼Œä½†æ˜¯...

# ä»£ç åœ¨å“ªé‡Œï¼Œthoï¼Ÿ

[![Where?!](img/38571c2512cb7d722685b10ce4b16485.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--O1wEjDSf--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/w6d1imumvw5xjw3jiesn.gif)

ç»§ç»­æ‰“å¼€ IntelliJ IDEA å¹¶éµå¾ªåŸºæœ¬çš„è®¾ç½®æ­¥éª¤ã€‚

åˆ«æ€¥ï¼Œæ…¢æ…¢æ¥ï¼Œæˆ‘å¯ä»¥ç­‰ã€‚

åœ¨â€œæ¬¢è¿æ¥åˆ° IntelliJ IDEAâ€å±å¹•è§æˆ‘ã€‚

[![Welcome to IntelliJ IDEA](img/3ce2d29be1574d843a395958359b71aa.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--qaY65Y8Y--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/1as5xicwwdg4nu4qja1s.png)

é€‰æ‹©`Create New Project`ï¼Œé€‰æ‹©`Kotlin > Kotlin/JVM`ã€‚

[![Create new project](img/d41277b9757a745d7c2c35a51180ff7a.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--h5zDiYq7--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/jxxhpg699gv3ealggrgt.png)

é€‰æ‹©ä¸€ä¸ªé¡¹ç›®åç§°ï¼Œæˆ‘é€‰äº†`selenium-kotlin`ã€‚

[![Project name](img/d57b6bef3560d0e61d71e2ba8464179a.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--ER25_you--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/8gmsfcypt5sww73dozdb.png)

ç„¶åï¼Œç‚¹å‡»`Finish`æŒ‰é’®ã€‚

è½¬åˆ°å·¦ä¾§çª—æ ¼(é¡¹ç›®æµè§ˆå™¨)

[![Project explorer](img/01ea07a3c4c5c5d8ba8f9e7f635da74d.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--IttFRrkK--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/qm5jgd3pha7z9u7h7xl2.png)

## é¡¹ç›®ç»“æ„

æˆ‘ä»¬å°†åˆ›å»ºå‡ ä¸ªåŒ…æ¥åŒ¹é…è¿™ä¸ªç»“æ„:

```
selenium-kotlin    
â”‚
â””â”€â”€â”€ .idea
|    |
|    â””â”€â”€â”€ ...
|
â””â”€â”€â”€ src
|    â”‚
|    â””â”€â”€â”€ main
|    |    |
|    |    â””â”€â”€â”€ page
|    |
|    â””â”€â”€â”€ tests
|
â””â”€â”€â”€ selenium-kotlin.iml 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦å°†`main`æ–‡ä»¶å¤¹æ ‡è®°ä¸º`Sources root`ï¼Œå°†`tests`æ–‡ä»¶å¤¹æ ‡è®°ä¸º`Test Sources root`ã€‚ä½ å¯ä»¥é€šè¿‡å³å‡»è½¯ä»¶åŒ…å¹¶é€‰æ‹©`Mark Directory as > ...`æ¥å®ç°

## æ·»åŠ ç¡’åˆ°é¡¹ç›®ä¸­

è¿›å…¥`File`èœå•å¹¶é€‰æ‹©`Project Structure...`ã€‚

[![File menu](img/110fb24974136caa13ad916551bb2b4e.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--DmXDDgok--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/79u29dsa0ldn3sasll9v.png)

é€‰æ‹©`Modules`ã€‚

[![Project settings](img/7306d07bd357ad98a6f12b34e3df2a3a.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--vMSaw-K0--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/2du3sji37shc5nvtxmc5.png)

å°† selenium jar æ·»åŠ åˆ°é¡¹ç›®ä¸­ã€‚

[![Add dependency](img/090501cfb0625b2339a6576ded9bc4d8.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--w5LBQ90y--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/1g1y373qkmm12c8i1upd.png)

å¯»æ‰¾ã€‚æˆ‘ä»¬ä¹‹å‰ä¸‹è½½çš„ jar æ–‡ä»¶ã€‚å®ƒå¯èƒ½åœ¨æ‚¨çš„`./Downloads`æ–‡ä»¶å¤¹ä¸­ï¼Œé™¤éæ‚¨å°†å®ƒä¿å­˜åœ¨å…¶ä»–åœ°æ–¹ã€‚

ç‚¹å‡»`Project Structure`çª—å£å³ä¸‹è§’çš„`OK`æŒ‰é’®ï¼Œä½ ç°åœ¨åº”è¯¥å¯ä»¥åœ¨`Project Explorer`çš„`External Libraries`ä¸‹çœ‹åˆ° seleniumã€‚

## åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªé¡µé¢å¯¹è±¡æ¨¡å‹

æˆ‘ä»¬ç»ˆäºå¯ä»¥*å¼€å§‹ç¼–ç äº†ï¼*

> é¡µé¢å¯¹è±¡æ¨¡å‹æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå®ƒå¸®åŠ©æˆ‘ä»¬ç»„ç»‡æ‰€æœ‰çš„`WebElement`åŸºäºå®ƒä»¬å±äºå“ªä¸ªâ€œé¡µé¢â€ã€‚è¿™æœ‰åŠ©äºæˆ‘ä»¬å‡å°‘ä»£ç åº“ä¸åŒéƒ¨åˆ†çš„ä»£ç é‡å¤ã€‚

å‰å¾€ä½ çš„`src/main/kotlin/page`æ–‡ä»¶å¤¹ã€‚åœ¨è¿™ä¸ªåŒ…ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä»£è¡¨ web åº”ç”¨ç¨‹åºä¸­ç»™å®šé¡µé¢çš„ç±»ã€‚

[![GitHub Home Page](img/5bbed4ae9be4b3b72e106f6e501b42fe.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Hzuu0_Dh--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/pdae8wuz85mm64rif5jl.png)

å°±åƒä¸Šé¢é‚£ä¸ªç”±`GitHubHomePage.kt`è¡¨ç¤ºçš„ã€‚æ‰€ä»¥ï¼Œå»åšå§ã€‚å³å‡»`page`æ–‡ä»¶å¤¹ï¼Œé€‰æ‹©`New > Kotlin File/Class`ã€‚

æ‚¨çš„æ–‡ä»¶å°†(å‡ ä¹)ä¸ºç©º:

```
package page 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç»§ç»­æ·»åŠ ç±»å®šä¹‰:

```
class GitHubHomePage {

} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬éœ€è¦å¯¹é¡µé¢åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯æ·»åŠ ä¸€ä¸ª`open()`æ–¹æ³•ã€‚å› ä¸ºæˆ‘ä»¬æƒ³åœ¨æµ‹è¯•æœŸé—´ç”¨ä¸€ä¸ªç›´æ¥çš„ URL è®¿é—®å®ƒã€‚

```
class GitHubHomePage {

    fun open() {
        // Go to GitHub's home page
    }

} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†éœ€è¦ä¸€ä¸ª`WebDriver`å¯¹è±¡ï¼Œè¿™æ˜¯ Selenium æä¾›çš„ä¸€ä¸ªç±»ï¼Œå®ƒä»£è¡¨æˆ‘ä»¬çš„æµè§ˆå™¨(Chromeã€Firefoxã€Safariã€Internet Explorer ç­‰)ä»¥åŠå®ƒæ§åˆ¶æµè§ˆå™¨çš„æ‰€æœ‰æ–¹æ³•ã€‚

æˆ‘ä»¬éœ€è¦åœ¨æˆ‘ä»¬çš„`GitHubHomePage`çš„æ„é€ å‡½æ•°ä¸­ä¼ é€’å®ƒï¼Œç„¶åé€šè¿‡è°ƒç”¨è¢«ç§°ä¸º`get()`çš„`WebDriver`çš„æ–¹æ³•åœ¨æˆ‘ä»¬çš„`open()`æ–¹æ³•ä¸­ä½¿ç”¨å®ƒã€‚

```
class GitHubHomePage(private val driver: WebDriver) {

    fun open() {
        driver.get("https://github.com/")
    }

} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æ‚¨æ‰€è§ï¼Œ`get()`æ–¹æ³•æ¥æ”¶ä¸€ä¸ª`String`å€¼ï¼Œè¯¥å€¼å°†æˆä¸º GitHub çš„ä¸»é¡µã€‚

> æ³¨æ„:`get()`æ–¹æ³•å®é™…è°ƒç”¨çš„æ˜¯`navigate().to()`ï¼Œä½†æ˜¯`get()`æ›´çŸ­:)

ç°åœ¨æˆ‘ä»¬å¯ä»¥è¿è¡Œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæµ‹è¯•ï¼Œæ‰“å¼€ä¸€ä¸ªæµè§ˆå™¨ï¼Œç„¶åè®¿é—® GitHub çš„ç½‘ç«™ã€‚

## åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªæµ‹è¯•

å°†æ‚¨çš„`cursor`æ”¾åœ¨`GitHubHomePage`ç±»åä¹‹ä¸Šï¼Œé€šè¿‡æŒ‰`SHIFT + CTRL + A`(Windows)æˆ–`SHIFT + CMD + A`(MAC OS)ä½¿ç”¨`Find Actions`èœå•ã€‚

ä¼šå‡ºç°ä¸€ä¸ªæœç´¢æ å¯¹è¯æ¡†ï¼Œè¾“å…¥`Create test`ï¼Œç„¶åç‚¹å‡»`ENTER`ã€‚

ä¸€ä¸ªæ–°çš„å¯¹è¯æ¡†å°†ä¼šå‡ºç°ã€‚ä»ä¸‹æ‹‰åˆ—è¡¨ä¸­é€‰æ‹©`TestNG`ä½œä¸ºæ‚¨çš„`Testing Library`ï¼Œä¼šå‡ºç°ä¸€æ¡è­¦å‘Šä¿¡æ¯â€œæ¨¡å—ä¸­æœªæ‰¾åˆ° TestNG åº“â€ã€‚åˆ«æ‹…å¿ƒï¼Œåªè¦æŒ‰ä¸‹å®ƒæ—è¾¹çš„`Fix`æŒ‰é’®ã€‚

å°†å‡ºç°å¦ä¸€ä¸ªçª—å£ï¼Œç¡®ä¿â€œä½¿ç”¨ IntelliJ IDEA å‘è¡Œç‰ˆçš„â€˜TestNGâ€™â€å•é€‰æŒ‰é’®å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œç‚¹å‡»`OK`ï¼Œç„¶åé€‰ä¸­ä¸¤ä¸ªå¤é€‰æ¡†:`setUp/@Before`å’Œ`tearDown/@After`ã€‚

å®ƒåº”è¯¥æ˜¯è¿™æ ·çš„:

[![Create test dialog](img/02da93919d90c11ae31db29f142d9531.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--W-nhMg6T--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/vpkedxpqcrfzcuz1bosm.png)

ç„¶åï¼Œå†æ¬¡ç‚¹å‡»`OK`ã€‚

è¿™å°†ä½¿ç”¨`setUp()`å’Œ`tearDown()`æ–¹æ³•åœ¨`src/tests/kotlin/page`ç›®å½•ä¸­ä¸ºæ‚¨åˆ›å»ºæµ‹è¯•ç±»ã€‚

`setUp()`æ–¹æ³•å°†æ€»æ˜¯åœ¨æ¯æ¬¡æµ‹è¯•ä¹‹å‰è¿è¡Œ*ï¼Œè€Œ`tearDown()`å°†æ€»æ˜¯åœ¨æ¯æ¬¡æµ‹è¯•*ä¹‹åè¿è¡Œ*ã€‚*

æˆ‘ä»¬å°†ä½¿ç”¨å®ƒä»¬æ¥*è®¾ç½®*æˆ‘ä»¬çš„æµè§ˆå™¨ï¼Œè¿™æ¬¡æˆ‘ä»¬å°†ä½¿ç”¨ Chromeï¼Œå¹¶ä¸”æˆ‘ä»¬å°†ç¡®ä¿åœ¨æµ‹è¯•å®Œæˆåæ€»æ˜¯å…³é—­æ‰€æœ‰çš„æµè§ˆå™¨ã€‚

å›åˆ°ä»£ç ï¼

## æ‰“å¼€æµè§ˆå™¨

åœ¨`setUp()`æ–¹æ³•ä¸­ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª`ChomeDriver`ç±»çš„å®ä¾‹ã€‚

```
class GitHubHomePageTest {
    private lateinit var driver: WebDriver

    @BeforeMethod
    fun setUp() {
        driver = ChromeDriver()
    }

    @AfterMethod
    fun tearDown() {
        // Close all browsers
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## è½¬åˆ° GitHub çš„ä¸»é¡µ

ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª`GitHubHomePage`ç±»çš„å®ä¾‹ï¼Œå¹¶å°†å…¶å‘½åä¸º`open()`æ–¹æ³•ã€‚

```
class GitHubHomePageTest {
    private lateinit var driver: WebDriver
    private lateinit var gitHubHomePage: GitHubHomePage

    @BeforeMethod
    fun setUp() {
        driver = ChromeDriver()
        gitHubHomePage = GitHubHomePage(driver)
        gitHubHomePage.open()
    }

    @AfterMethod
    fun tearDown() {
        // Close all browsers
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## å®Œæˆåï¼Œå…³é—­æµè§ˆå™¨

è½¬åˆ°`tearDown()`æ–¹æ³•ï¼Œä»`driver`å®ä¾‹ä¸­è°ƒç”¨ de `quit()`æ–¹æ³•ã€‚

```
class GitHubHomePageTest {
    private lateinit var driver: WebDriver
    private lateinit var gitHubHomePage: GitHubHomePage

    @BeforeMethod
    fun setUp() {
        driver = ChromeDriver()
        gitHubHomePage = GitHubHomePage(driver)
        gitHubHomePage.open()
    }

    @AfterMethod
    fun tearDown() {
        driver.quit()
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¿«åˆ°äº†ï¼

æˆ‘ä»¬æ¥æ·»åŠ ä¸€ä¸ªæµ‹è¯•åŠŸèƒ½ï¼Œè¿˜è®°å¾—æ€ä¹ˆç”¨`Generate`èœå•å—ï¼Ÿ

`SHIFT + CTRL + A` / `SHIFT + CMD + A`ã€‚

è¾“å…¥`Generate`å¹¶ç‚¹å‡»`ENTER`ã€‚

é€‰æ‹©`Test Function`ã€‚

ç»™å®ƒèµ·ä¸€ä¸ªç±»ä¼¼äº`emptyTest`çš„åå­—ï¼Œå¹¶æš‚æ—¶æ”¾ç½®ä¸€ä¸ªå ä½ç¬¦æ³¨é‡Šã€‚æˆ‘ä»¬åªæ˜¯æƒ³çœ‹çœ‹èƒ½å¦æ‰“å¼€æµè§ˆå™¨ï¼Œè¿›å…¥ä¸»é¡µã€‚

è¿è¡Œæˆ‘ä»¬çš„`emptyTest`æœ€ç®€å•çš„æ–¹æ³•æ˜¯ç‚¹å‡»ç¼–è¾‘å™¨çª—æ ¼å·¦ä¾§çš„ç»¿è‰²æ’­æ”¾æŒ‰é’®ã€‚å°±åœ¨ 21 å·çº¿æ—è¾¹ã€‚

[![Run test method](img/52398d7269fd91e38489c5aa7ff3c8de.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--jgIAtMFb--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/tz7uejorvae0wjuxpkmr.png)

[![EmptyTest passed](img/0e87864d6dcc5b83e4bea5ceeaa8db5e.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--JFSN-3In--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/ankn0lqv1or4u1osx8gm.png)

[![yeah boi](img/b6f14f2a069cf4c021f22c698dceaa2a.png)T2ã€‘](https://i.giphy.com/media/xTiQyAVsNw6mOab8hW/giphy.gif)

# æˆ‘ä»¬æ¥åšä¸€ä¸ªçœŸå®çš„æµ‹è¯•

æµ‹è¯•ä¸€ä¸‹æˆ‘ä»¬æ˜¯å¦èƒ½æ‰¾åˆ°ä¸€ä¸ª GitHub ç”¨æˆ·åå¹¶è®¿é—®ä»–ä»¬çš„ä¸ªäººèµ„æ–™æ€ä¹ˆæ ·ï¼Ÿ

å¬èµ·æ¥å¾ˆç®€å•ï¼Œå¯¹å—ï¼Ÿ

## é‡æ„`emptyTest`

æˆ‘ä»¬éœ€è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯é‡å‘½åæˆ‘ä»¬çš„`emptyTest`æ–¹æ³•ã€‚

æ€ä¹ˆæ ·...`searchForUsername`ï¼Ÿå¾ˆå¥½ã€‚

ç°åœ¨ï¼Œæœç´¢æ åœ¨å“ªé‡Œï¼Ÿå°±åœ¨ä¸»é¡µä¸Šã€‚

å› æ­¤ï¼Œè®©æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒå°†æ¥å—ä¸€ä¸ª`String`ï¼Œå°†å…¶é”®å…¥`searchBox`å¹¶æäº¤ã€‚å®ƒåº”è¯¥æ˜¯è¿™æ ·çš„:

```
fun searchFor(query: String) {
    val searchBox = driver.findElement(By.xpath("//input[@placeholder='Search GitHub']"))
    searchBox.sendKeys(query, Keys.ENTER)
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç­‰ç­‰ï¼Œç­‰ç­‰ï¼Œç­‰ç­‰...

#### è¿™ä¸€åˆ‡çš„`findElement()`ã€`By`ã€`xpath`ã€`sendKeys()`ã€`Keys`ä»ä½•è€Œæ¥ï¼ï¼Ÿ

å¥½å§ï¼Œè®©æˆ‘è§£é‡Šä¸€ä¸‹:

`findElement()`æ˜¯æ¥è‡ª`driver`çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒå°†ä¸€ä¸ª`By.<something>`ä½œä¸ºå‚æ•°ã€‚å¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›ä¸€ä¸ª`WebElement`ï¼›å¦åˆ™ï¼Œå®ƒä¼š`throw`ä¸€ä¸ª`NoSuchElementException`ã€‚

`By.xpath()`æ¥å—ä¸€ä¸ª`String`å‚æ•°ï¼Œè¿™å°†å¸®åŠ©æˆ‘ä»¬åœ¨é¡µé¢ä¸Šå®šä½ä¸€ä¸ªå…ƒç´ ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä»»ä½•å…·æœ‰ä¸â€œSearch GitHubâ€å®Œå…¨åŒ¹é…çš„`placeholder`å±æ€§çš„`<input>`ã€‚å…¶ä»–ä¾‹å­è¿˜æœ‰`By.id`ã€`By.cssSelector`ã€`By.className`ç­‰ã€‚

`sendKeys()`æ˜¯æ¥è‡ª Selenium æä¾›çš„`WebElement`ç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒæ¥å—ä¸€ä¸ªç±»å‹ä¸º`CharSequence`çš„å‚æ•°ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€ä¸ª`char`ã€`String`æˆ–æ¥è‡ª`Keys`æšä¸¾ç±»çš„ä»»ä½•å€¼ï¼Œæ¯”å¦‚`Keys.ENTER`ï¼Œå®ƒä¸ä¼šé”®å…¥å•è¯â€œENTERâ€ï¼Œè€Œæ˜¯æ¨¡æ‹Ÿæˆ‘ä»¬æŒ‰ä¸‹é”®ç›˜ä¸Šçš„`ENTER`é”®ï¼Œä»è€Œåœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­æäº¤æŸ¥è¯¢ã€‚

### çˆ½å§ï¼Ÿä½†æ˜¯æˆ‘ä»¬è¿˜æ²¡æœ‰å®Œæˆ

ç°åœ¨æˆ‘ä»¬è¦è¿‡æ»¤æœç´¢ç»“æœï¼Œåªçœ‹åˆ°ç”¨æˆ·åï¼Œç„¶åç‚¹å‡»æˆ‘ä»¬è¦æ‰¾çš„ç”¨æˆ·åã€‚

ç”±äºè¿™ä¸ªé¡µé¢çš„å…ƒç´ åªæ˜¯â€œæœç´¢â€æµç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†åˆ›å»ºå¦ä¸€ä¸ªé¡µé¢ç±»ï¼Œå¹¶å°†å…¶å‘½åä¸º`GitHubSearchPage`(è®°å¾—åœ¨`src/main/kotlin/page`åŒ…ä¸­åˆ›å»º)ã€‚

```
class GitHubSearchPage(private val driver: WebDriver) {

} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸ºç”¨æˆ·è¿‡æ»¤å™¨æ·»åŠ `WebElement`å’Œå°†`click()`å®ƒçš„`filterByUsers()`æ–¹æ³•ã€‚

```
fun filterByUsers() {
    val usersFilter = driver.findElement(By.xpath("//a[text() = 'Users']"))
    usersFilter.click()
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸ºç”¨æˆ·èµ„æ–™é“¾æ¥æ·»åŠ å¦ä¸€ä¸ª`WebElement`å’Œä¸€ä¸ªå°†`click()`å®ƒçš„`enterUserProfile()`æ–¹æ³•ã€‚

```
fun enterUserProfile() {
    val userProfileLink = driver.findElement(By.xpath("//span[text() = 'Christian Vasquez']/../a/em"))
    userProfileLink.click()
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘è¿˜å°†æ·»åŠ ä¸€ä¸ª`open()`æ–¹æ³•ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è¿›å…¥æœç´¢é¡µé¢ï¼Œä»¥å¤‡ä»¥åéœ€è¦ã€‚

æ•´ä¸ªç±»åº”è¯¥æ˜¯è¿™æ ·çš„:

```
class GitHubSearchPage(private val driver: WebDriver) {

    fun open() {
        driver.get("https://github.com/search?")
    }

    fun filterByUsers() {
        val usersFilter = driver.findElement(By.xpath("//a[text() = 'Users']"))
        usersFilter.click()
    }

    fun enterUserProfile() {
        val userProfileLink = driver.findElement(By.xpath("//span[text() = 'Christian Vasquez']/../a/em"))
        userProfileLink.click()
    }

} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è®©æˆ‘ä»¬å¼€å§‹åœ¨æˆ‘ä»¬çš„`searchForUsername()`æµ‹è¯•å‡½æ•°ä¸­ä½¿ç”¨æ–°çš„`GitHubSearchPage`ã€‚

```
@Test
fun searchForUsername() {
    gitHubHomePage.searchFor("chrisvasqm")
    gitHUbSearchPage = GitHubSearchPage(driver)
    gitHUbSearchPage.filterByUsers()
    gitHUbSearchPage.enterUserProfile()
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨è®©æˆ‘ä»¬é€šè¿‡åœ¨æˆ‘ä»¬çš„`searchForUsername()`æ–¹æ³•ä¸­æ·»åŠ ä¸‹é¢ä¸€è¡Œæ¥æ£€æŸ¥æˆ‘ä»¬æ˜¯å¦è¢«æ­£ç¡®åœ°é‡å®šå‘åˆ°äº†â€œ[www.github.com/chrisvasqm](http://www.github.com/chrisvasqm)URL:

```
assertTrue(driver.currentUrl == "https://github.com/chrisvasqm") 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ•´ä¸ªæµ‹è¯•å‡½æ•°ç°åœ¨åº”è¯¥æ˜¯è¿™æ ·çš„:

```
@Test
fun searForUsername() {
    gitHubHomePage.searchFor("chrisvasqm")
    gitHUbSearchPage = GitHubSearchPage(driver)
    gitHUbSearchPage.filterByUsers()
    gitHUbSearchPage.enterUserProfile()

    assertTrue(driver.currentUrl == "https://github.com/chrisvasqm")
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨è®©æˆ‘ä»¬è¯•ç€è¿è¡Œæˆ‘ä»¬çš„æµ‹è¯•...

[![BOOM!](img/61dafdec4e2d5d28e3d2ccbb54698c23.png)T2ã€‘](https://i.giphy.com/media/dpnfPvaCIHBrW/giphy.gif)

æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª`NoSuchElementException`ï¼Œä½†æ‹…å¿ƒä½ ä¸€å®šæ²¡æœ‰ã€‚

å‘ç”Ÿçš„æƒ…å†µæ˜¯ï¼Œåœ¨æˆ‘ä»¬å•å‡»`usersFilter`å…ƒç´ åï¼Œæˆ‘ä»¬çš„`userProfileLink` WebElement ä¸ä¼šç«‹å³å‡ºç°ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Selenium æä¾›çš„ä¸¤ä¸ªç±»:`PageFactory`å’Œ`AjaxElementLocatorFactory`ã€‚

æˆ‘ä»¬çš„æ–¹æ³•æ˜¯ä½¿ç”¨ Kotlin æ‹¥æœ‰çš„`init {...}`å—(å®ƒç±»ä¼¼äºä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œä½†åªç”¨äºåˆå§‹åŒ–)ã€‚

```
init {
    PageFactory.initElements(AjaxElementLocatorFactory(driver, 15), this)
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™è¡Œä»£ç ç¡®ä¿åˆå§‹åŒ–æˆ‘ä»¬çš„å±æ€§ï¼Œä»¥ä¾¿åœ¨æŠ›å‡º`NoSuchElementException`ä¹‹å‰æœ€å¤šç­‰å¾… 15 ç§’ã€‚

## å“ªäº›å±æ€§ï¼Ÿ

å¥½é—®é¢˜ï¼

è®°å¾—æˆ‘ä»¬åœ¨åšè¿™ä¸ªå—ï¼Ÿ

```
val element = driver.findElement(By.xpath("VALUE")) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬å°†æ›¿æ¢ä¸º:

```
@FindBy(xpath = "VALUE")
private lateinit var element: WebElement 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ¯å½“æˆ‘ä»¬å°†`PageFactory` + `AjaxElementLocatorFactory`ç»„åˆä¸`@FindBy`æ³¨é‡Šä¸€èµ·ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬å°†è·å¾—æˆ‘ä¹‹å‰æåˆ°çš„ 15 ç§’è¶…æ—¶çš„å¥½å¤„ã€‚

è®©æˆ‘ä»¬é‡æ„æˆ‘ä»¬çš„`GitHubSearchPage`ç±»ï¼Œç„¶åå†é‡æ„

```
class GitHubSearchPage(private val driver: WebDriver) {

    @FindBy(xpath = "\"//a[text() = 'Users']\"")
    private lateinit var usersFilter: WebElement

    @FindBy(xpath = "//span[text() = 'Christian Vasquez']/../a/em")
    private lateinit var userProfileLink: WebElement

    init {
        PageFactory.initElements(AjaxElementLocatorFactory(driver, 15), this)
    }

    fun open() {
        driver.get("https://github.com/search?")
    }

    fun filterByUsers() {
        usersFilter.click()
    }

    fun enterUserProfile() {
        userProfileLink.click()
    }

} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

é‡æ–°è¿è¡Œæµ‹è¯•ğŸ¤

[![All tests passed](img/000915847a2eedb84f967b5b9540f80e.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--t_3qKIm4--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/ehkvr2gm37vem5llrum8.png)

æˆ‘ä»¬ç»ˆäºæˆåŠŸäº†ï¼

[![doge](img/b205237efaa23ffe09999e1418b6d0fc.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--fvTGAbFg--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/fnt1ijqcv1wm9t2wno5z.jpg)

å¦‚æœä½ è¿˜ä¸çŸ¥é“ Seleniumï¼Œæˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« æ•™ä¼šä½ ä¸€äº›æ–°çš„ä¸œè¥¿ã€‚

æˆ‘çŸ¥é“æˆ‘æ²¡æœ‰æ·±ç©¶ä¸ºä»€ä¹ˆæˆ‘åšäº† Kotlin æœ¬èº«çš„ä¸€äº›äº‹æƒ…ï¼Œä½†è¿™å¯èƒ½æ˜¯å°†æ¥å¦ä¸€ç¯‡æ–‡ç« çš„ä¸»é¢˜ï¼›)

ä¸çŸ¥é“ï¼Œä¹Ÿè®¸è¿™ä¼šä¿ƒä½¿ä½ è‡ªå·±å»å°è¯•å…¶ä»–çš„ä¸œè¥¿ï¼

# äº†è§£æ›´å¤š

è¿™é‡Œæœ‰å¦ä¸€ä¸ªé“¾æ¥ï¼Œä½ å¯èƒ½ä¼šå‘ç°å¯¹[äº†è§£æ›´å¤š](https://github.com/SeleniumHQ/selenium/wiki/Getting-Started)å…³äº*ç¡’*æœ‰ç”¨ã€‚

å¦‚æœä½ æƒ³äº†è§£å¦ä¸€ç§é€‰æ‹©ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå…³äºå¦‚ä½•ä½¿ç”¨ JavaScript å’Œ VS ä»£ç ç¼–è¾‘å™¨ç”¨ TestCafe è¿›è¡Œ [E2E æµ‹è¯•çš„æŒ‡å—ã€‚](https://dev.to/chrisvasqm/e2e-testing-with-testcafe-17jl)