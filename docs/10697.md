# Pebble SDK å’Œ Rocky.js å…¥é—¨

> åŸæ–‡:[https://dev . to/Brandon 927/getting-started-with-pebble-SDK-and-rocky js-2849](https://dev.to/brandonb927/getting-started-with-pebble-sdk-and-rockyjs-2849)

æœ€åæ›´æ–°æ—¶é—´:2017 å¹´ 1 æœˆ 6 æ—¥

å‘è¡¨è¿™ç¯‡æ–‡ç« ä¸€ä¸ªæœˆåï¼Œ [Pebble è¢« Fitbit](https://www.bloomberg.com/news/articles/2016-12-07/pebble-said-to-discuss-selling-software-assets-to-fitbit) æ”¶è´­ï¼Œå¦‚æœä½ æ²¡æœ‰çœ‹åˆ°[æˆ‘åœ¨ Twitter ä¸Šçš„ååº”](https://twitter.com/brandonb927/status/806518072970383361)ï¼Œæˆ‘ä¼šè®©ä½ çŸ¥é“æˆ‘å¯¹æ­¤å¾ˆä¸é«˜å…´ã€‚Fitbit å‘èª“è¦ç¡®ä¿[æ‰€æœ‰æ´»è·ƒçš„ Pebble è®¾å¤‡å°†åœ¨ 2017 å¹´](https://developer.pebble.com/blog/2016/12/14/first-steps-forward-with-fitbit/)ç»§ç»­è¿è¡Œï¼Œç„¶è€Œæˆ‘å¯¹æ­¤æŒæ€€ç–‘æ€åº¦ã€‚

ä» 2016 å¹´ 12 æœˆ 8 æ—¥èµ·ï¼Œé¾™åœ¨è¿™é‡Œã€‚

â€”â€”â€”â€”

**TLï¼›åšå£«**:æˆ‘ç”¨ RockyJS æ„å»ºå¹¶å‘å¸ƒäº†æˆ‘çš„ç¬¬ä¸€ä¸ª watchfaceï¼Œå¯ä»¥åœ¨ [Pebble åº”ç”¨å•†åº—](https://apps.getpebble.com/en_US/application/58070ba89392ff32cf0002ce)ä¸Šä¹°åˆ°ï¼æˆ‘ä¸ä»‹æ„ä½ å»é‚£é‡Œç»™å®ƒä¸€ä¸ªå¤§çš„è€â¤ğŸ˜

è¯¥æºä»£ç ä¹Ÿå¯ä»¥åœ¨ github ä¸Šæ‰¾åˆ°ã€‚

* * *

æˆ‘æœ‰ä¸€ä¸ª Fitbit Charge HRï¼Œä½†åæ¥å°±ä¸ç”¨äº†ã€‚æƒ³è¦åˆ«çš„ä¸œè¥¿ï¼ŒPebble Time è®¾å¤‡ä¼¼ä¹ç¬¦åˆæˆ‘çš„â€œæƒ³è¦å’Œéœ€è¦â€æ¸…å•ã€‚Pebble çš„å¯æ”»å‡»æ€§ã€ç¤¾åŒºå’Œç”Ÿæ€ç³»ç»Ÿå¸å¼•äº†æˆ‘ã€‚æˆ‘å¯¹æœ€åˆä½¿ç”¨é»‘ç™½ç”µå­å¢¨æ°´æ˜¾ç¤ºå±çš„è®¾å¤‡å¹¶ä¸æ„Ÿå†’ï¼Œä½†å½“å½©è‰²ç”µå­å¢¨æ°´æ˜¾ç¤ºå±å‘å¸ƒæ—¶ï¼Œæˆ‘å¼€å§‹å–œæ¬¢ä¸Šäº†å®ƒã€‚

<source>
[![My Pebble Time Steel](img/251f62aa33c6079c81192970b180baac.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--_kbj66gm--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dc1r9kxqg42ml.cloudfront.net/brandonb.ca/posts/my-pebble-time-steel.jpg) 

åœ¨å¾—åˆ°æˆ‘çš„ Pebble ä¹‹åï¼Œæˆ‘å¼€å§‹å¯»æ‰¾æˆ‘èƒ½åšäº›ä»€ä¹ˆæ¥å¼€å‘å®ƒã€‚é€šè¯»æ–‡æ¡£æ—¶ï¼Œæˆ‘æ„è¯†åˆ°æˆ‘ä¸æ„¿æ„å­¦ä¹ `C`è¯­è¨€æ¥ç¼–å†™åº”ç”¨ç¨‹åºã€‚`C`åº”ç”¨ç¨‹åºç¡®å®ä½¿ç”¨äº†ä¸€ç‚¹ç‚¹ Javascriptï¼Œé€šè¿‡`PebbleKit`å°†å…¶ç²˜è´´åˆ°æ‰‹æœºåº”ç”¨ç¨‹åºä¸Šï¼Œä½†é‚£åªæ˜¯ä¸€å°å—ä»£ç ã€‚å¹¸è¿çš„æ˜¯ï¼Œä½ å¯ä»¥ä½¿ç”¨ [RockyJS](https://pebble.github.io/rockyjs/) å®Œå…¨ç”¨ Javascript ç¼–å†™ watchfacesã€‚RockyJS æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºåµŒå…¥å¼ [Javascript watchapps](https://developer.pebble.com/blog/2016/08/15/introducing-rockyjs-watchfaces/) çš„å¼€å‘æ¡†æ¶ã€‚ä»æœ€æ–°çš„ä¸»è¦ Pebble å›ºä»¶æ›´æ–°å¼€å§‹ï¼Œç°åœ¨æœ‰äº†ä¸€ä¸ªåœ¨è®¾å¤‡ä¸Šè¿è¡Œ Javascript çš„åµŒå…¥å¼å¼•æ“ã€‚è¿™ä½¿å¾— RockyJS æ„å»ºçš„ watchapps å¯ä»¥åœ¨ Pebble watch ä¸ŠåŸç”Ÿè¿è¡Œï¼Œè€Œæ— éœ€ç¼–è¯‘æˆ cã€‚

## å…ˆå†³æ¡ä»¶

å¼€å§‹å¼€å‘ RockyJS watchfaces çš„å”¯ä¸€å…ˆå†³æ¡ä»¶æ˜¯å¯¹ Javascript å’Œ [Canvas API](https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API) æœ‰ä¸€ç‚¹äº†è§£ã€‚æ‚¨éœ€è¦çŸ¥é“çš„å…¶ä»–ä¸€åˆ‡éƒ½æ˜¯é¢å¤–çš„æ”¶è·ï¼Œæ‚¨å°†åœ¨æ¥ä¸‹æ¥çš„å‡ èŠ‚ä¸­çœ‹åˆ°åŸå› ã€‚

RockyJS èƒŒåçš„åŸºæœ¬æ¦‚å¿µæ˜¯:å®ƒæŠ½è±¡å‡ºäº†`canvas`çš„æ¦‚å¿µ(å› ä¸ºä½ è¦æ¸²æŸ“åˆ°ä¸€ä¸ªå›ºå®šçš„å±å¹•å¤§å°),è€Œæ˜¯ä¸ºä½ æä¾›äº†ä¸€ä¸ª`context`å¯¹è±¡æ¥ä½¿ç”¨ï¼Œè¿™ä¸ªå¯¹è±¡å¡«å……äº†å¯ç”¨çš„ API æ–¹æ³•ã€‚ç„¶åä»`context`å¯¹è±¡ä¸­è°ƒç”¨ç±»ä¼¼`ctx.arc`ã€`ctx.rect`ç­‰ç»˜å›¾å‘½ä»¤ã€‚

æ­£å¦‚ä½ åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­çœ‹åˆ°çš„ï¼ŒRockyJS æ˜¯åŸºäºäº‹ä»¶çš„ï¼Œæ‰€ä»¥å½“æŸäº›äº‹ä»¶è§¦å‘æ—¶ï¼Œæ¯”å¦‚`minutechange`æˆ–`hourchange`(åœ¨åˆ†é’Ÿå’Œæ•´ç‚¹)æ—¶ï¼Œå®ƒæ˜¯æœ€é«˜æ•ˆçš„ã€‚)

```
// The draw event is called when the watchface is initialized
rocky.on('draw', function (event) {
  // The draw event contains the context object that you use to draw to
  var ctx = event.context
  // Do stuff with the ctx object at this point
  ...
})

// When the minutechange event fires (every minute on the minute)
// request that rocky draws to the screen
rocky.on('minutechange', function (event) {
  rocky.requestDraw()
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## å…¥é—¨

å¼€å‘ watchfaces æœ‰å‡ æ¡é€”å¾„:

### äº‘åµçŸ³

å¦‚æœä½ æ˜¯æ–°æ‰‹ï¼Œ [CloudPebble](https://cloudpebble.net) æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚è¿™æ˜¯ç›®å‰å”¯ä¸€ä¸€æ¬¾ä¸ºæ‰€æœ‰ Pebble SDK å’Œå¹³å°å†…ç½®ä»¿çœŸå™¨æ”¯æŒçš„ Pebble IDE/ç¼–è¾‘å™¨ã€‚æ‚¨ç”šè‡³å¯ä»¥å°†æ‚¨çš„*ç‰©ç† Pebble è®¾å¤‡*è¿æ¥åˆ°æ‚¨çš„ CloudPebble å¸æˆ·ï¼Œå¹¶åœ¨**å®æ—¶å°†é¡¹ç›®æ„å»ºæ¨é€åˆ°æ‚¨çš„æ‰‹è¡¨ä¸Š**ã€‚

[![](img/cd9b084cdc69f741b883aac84a9e974f.png)T2ã€‘](https://i.giphy.com/media/5XqGhjDB48YqA/giphy.gif)

åœ¨ iOS Pebble åº”ç”¨ç¨‹åºä¸­è®¾ç½® CloudPebble æ”¯æŒçš„è¿‡ç¨‹å¦‚ä¸‹:

<source>
[![My Pebble Time Steel](img/41717c94aa24a1d10625bf0d1cbf7c4a.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--L4sN6l0T--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dc1r9kxqg42ml.cloudfront.net/brandonb.ca/posts/pebble-app-1.png)

<source>
[![My Pebble Time Steel](img/fa363acad41689615da560e087001ea1.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--LC5elwm4--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dc1r9kxqg42ml.cloudfront.net/brandonb.ca/posts/pebble-app-2.png)

<source>
[![My Pebble Time Steel](img/915cddb2b456fbc2f915f47c511159fb.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--GXbGCG9B--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dc1r9kxqg42ml.cloudfront.net/brandonb.ca/posts/pebble-app-3.png)

ä¸€æ—¦å¼€å¯å¼€å‘è€…æ¨¡å¼ï¼Œ`CloudPebble Connection`å°†ä¿æŒâ€œç­‰å¾…â€çŠ¶æ€ï¼Œç›´åˆ°æ‚¨å°†å®ƒè¿æ¥åˆ°æ‚¨çš„ CloudPebble å¸æˆ·å¹¶å°†æ‚¨çš„ç¬¬ä¸€ä¸ªé¡¹ç›®é€šè¿‡æ‰‹æœºæ¨é€åˆ°æ‚¨çš„ Pebble è®¾å¤‡ã€‚

ä¸ºæ­¤ï¼Œå‰å¾€ CloudPebble å’Œ[åˆ›å»ºä¸€ä¸ªè´¦æˆ·](https://auth.getpebble.com/users/sign_up)ã€‚è®¾ç½®å®Œæˆåï¼Œæ‚¨å¯ä»¥åˆ›å»ºæ–°é¡¹ç›®ã€‚ç¡®ä¿`Project Type`è¢«è®¾ç½®ä¸º`Rocky.js`ã€‚ç°åœ¨æ‚¨å¯ä»¥åœ¨ç¼–è¾‘å™¨ä¸­å¼€å§‹ç¼–ç äº†ï¼

å½“æ‚¨å¼€å§‹ä¸€ä¸ªé¡¹ç›®å¹¶åœ¨æ¨¡æ‹Ÿå™¨ä¸­æ­£ç¡®æ„å»ºåï¼Œæ‚¨å¯ä»¥å°†æ„å»ºæ–‡ä»¶éƒ¨ç½²åˆ°æ‚¨çš„ Pebble è®¾å¤‡ä¸Šã€‚è½¬åˆ°ä¾§è¾¹æ ä¸­çš„`Compilation`ï¼Œç„¶åç¡®ä¿é€‰æ‹©äº†`Phone`è€Œä¸æ˜¯`Emulator`ã€‚å¦‚æœæ‚¨å·²ç»æ­£ç¡®é…ç½®äº†æ‰€æœ‰è¿™äº›ï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿç‚¹å‡»`Install and Run`ã€‚è§‚çœ‹æ‚¨çš„ pebble è®¾å¤‡åŠ è½½æ‚¨çš„ watchfaceï¼Œç„¶åæ˜¾ç¤ºå®ƒï¼

### å±€éƒ¨å‘å±•

Pebble æœ‰ä¸€ä¸ª SDKï¼Œä½ å¯ä»¥é€šè¿‡è¿è¡Œ
ç”¨ [`brew`](http://brew.sh/) ä¸‹è½½

```
brew update && brew upgrade pebble-sdk && pebble sdk install latest 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

é€šè¿‡å…è®¸å¼€å‘è€…ä½¿ç”¨ SDK è¿›è¡Œæœ¬åœ°å¼€å‘ï¼Œä½ å¯ä»¥åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šåš CloudPebble æä¾›çš„åŒæ ·çš„äº‹æƒ…ã€‚SDK é™„å¸¦ä¸€ä¸ªä»¿çœŸå™¨ï¼Œå¹¶å…è®¸æ‚¨éƒ¨ç½²åˆ°æ‚¨çš„ç‰©ç† Pebble è®¾å¤‡ä¸Šã€‚æ‚¨è¿˜æœ‰æœºä¼šæ„å»ºè‡ªå·±çš„æ„å»ºæ­¥éª¤/è¿‡ç¨‹ï¼Œå¹¶åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ [pEmulator](https://github.com/blendsoul/pemulator) ã€‚

åœ¨å®ä½“ Pebble è£…ç½®ä¸Šå®‰è£… watchface å¾ˆç®€å•:

```
pebble build
pebble install [--phone <IP ADDR>] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## è‡­è™«&é—®é¢˜

åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œä½¿ç”¨ RockyJS for watchfaces å­˜åœ¨ä¸€äº›é”™è¯¯/é—®é¢˜:

*   ä¸æ”¯æŒçš„ web APIsï¼Œå¹¶ä¸”ä¸æ˜¯æ‰€æœ‰çš„`canvas`æ¸²æŸ“ä¸Šä¸‹æ–‡æ–¹æ³•éƒ½å¯ä»¥åœ¨ RockyJS watchface ä¸­ä½¿ç”¨ï¼Œ[æ£€æŸ¥è¿™é‡Œçš„ API å¥‡å¶æ ¡éªŒ](https://developer.pebble.com/docs/rockyjs/)
*   æ— æ³•ç¼–å†™çœŸæ­£çš„â€œåº”ç”¨â€ï¼Œç›®å‰åªæ”¯æŒ watchface åº”ç”¨
*   ç°åœ¨ä½¿ç”¨ ECMAScript æ˜¯ä¸å¯è¡Œçš„ï¼Œtranspiling å¯èƒ½å¯è¡Œï¼Œä½†æˆ‘è¿˜æ²¡æœ‰æµ‹è¯•è¿‡

## èµ„æº

ç›®å‰è¿˜æ²¡æœ‰å¤ªå¤šçš„èµ„æºå¯ä¾› RockyJS å¼€å‘ï¼Œæ‰€ä»¥é€‰æ‹©ä½™åœ°å¾ˆå°ã€‚ç„¶è€Œï¼Œè¿™é‡Œæœ‰ä¸€äº›æˆ‘å‘ç°éå¸¸æœ‰ç”¨çš„èµ„æº:

*   è¿™ä¸ªç¤¾åŒºæ˜¯ä¸€ä¸ªåŠ å…¥å’Œå­¦ä¹ çš„å¥½åœ°æ–¹-[https://developer.pebble.com/community/online/](https://developer.pebble.com/community/online/)
*   [RockyJS watchface æ•™ç¨‹](https://github.com/pebble-examples/rocky-watchface-tutorial-part1)
*   ä½¿ç”¨åä¸º [pEmulator](https://github.com/blendsoul/pemulator) çš„æµè§ˆå™¨å†…ç½® Pebble è®¾å¤‡ä»¿çœŸå™¨(è™½ç„¶ä¸æ˜¯çœŸæ­£çš„ä»¿çœŸå™¨)è¿›è¡Œæœ¬åœ°å¼€å‘