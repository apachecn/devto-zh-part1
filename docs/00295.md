# ä½¿ç”¨ Arduino åˆ¶ä½œå®æ—¶ç¯å…‰ç›‘è§†å™¨

> åŸæ–‡:[https://dev . to/neo/make-a-real time-light-monitor-using-arduino-29cm](https://dev.to/neo/make-a-realtime-light-monitor-using-arduino-29cm)

ä»å¯ç©¿æˆ´æŠ€æœ¯åˆ°æ™ºèƒ½å®¶å±…è®¾å¤‡ï¼Œç‰©è”ç½‘æ­£åœ¨æ”¹å˜æˆ‘ä»¬çš„ç”Ÿæ´»æ–¹å¼ã€‚ç‰©è”ç½‘å¬èµ·æ¥å¯èƒ½å¾ˆå¤æ‚ï¼Œä½†å®é™…ä¸Šå®ƒæ˜¯ä¸€ä¸ªå¾ˆå®¹æ˜“ç†è§£çš„æ¦‚å¿µã€‚ä½¿ç”¨ä¼ æ„Ÿå™¨å’Œè‡´åŠ¨å™¨ï¼Œæ—¥å¸¸ç‰©å“ä¸æ–­è¢«è½¬åŒ–ä¸ºæ™ºèƒ½è®¾å¤‡ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªå®æ—¶ Arduino ç¯å¢ƒå…‰ç›‘è§†å™¨ï¼Œå®ƒå°†ä¼ æ„Ÿå™¨è¯»æ•°å‘é€åˆ°ä¸€ä¸ª web åº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬å°†ä»‹ç»å°† Arduino æ¿è¿æ¥åˆ°ç½‘ç»œçš„åŸºç¡€çŸ¥è¯†ï¼Œä½¿ç”¨ Pusher å°†æ•°æ®ä½œä¸ºå®æ—¶é€šçŸ¥å‘é€åˆ° web åº”ç”¨ç¨‹åºã€‚

æœ¬æ–‡å°†ä»‹ç» Arduino å’Œ Pusher å¯ä»¥å®ç°çš„åŠŸèƒ½ã€‚å®ƒæ˜¯ä¸ºé‚£äº›å¯¹ç¡¬ä»¶è¡Œä¸šå¥½å¥‡ï¼Œæƒ³æ·±å…¥æœ‰è¶£çš„ç‰©è”ç½‘ä¸–ç•Œçš„äººå‡†å¤‡çš„ã€‚

## [](#requirements-for-building-our-arduino-and-pusher-integration)æ„å»ºæˆ‘ä»¬çš„ Arduino å’Œ Pusher é›†æˆçš„è¦æ±‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä½¿ç”¨äº†:
â€“ä¸€ä¸ª Arduino æ¿ã€‚MKR1000 æ¿ã€‚
â€“[Arduino IDE](https://www.arduino.cc/en/Main/Software)ã€‚
â€“å…‰ç”µæ± (æ­¤å¤„[å¯ç”¨](https://www.sparkfun.com/products/9088))ã€‚
â€“10k æ¬§å§†ç”µé˜»(æ­¤å¤„[å¯ç”¨](https://www.sparkfun.com/products/8374))ã€‚
â€“è¯•éªŒæ¿å’Œè·³çº¿ã€‚
â€“æ¨é€åº”ç”¨ç¨‹åºâ€”[åœ¨æ­¤å¤„åˆ›å»ºä¸€ä¸ª](https://pusher.com/developers)ã€‚
â€“ä½œæ›²å®¶(å¯åœ¨[https://getcomposer.org](https://getcomposer.org)ä¸‹è½½)ã€‚
â€“PHP çŸ¥è¯†ã€‚

> ğŸ’¡è¯•éªŒæ¿æ˜¯ç”¨äºä¸´æ—¶åˆ¶ä½œç¡¬ä»¶é¡¹ç›®åŸå‹çš„æ¿ã€‚å®ƒæœ‰ä¼ å¯¼ç”µæµçš„èŠ‚ç‚¹ã€‚
> 
> ğŸ’¡**è·³çº¿ç”¨äºç¡®ä¿è¯•éªŒæ¿ä¸Šé»˜è®¤æƒ…å†µä¸‹æœªè¿æ¥çš„å„ç‚¹ä¹‹é—´çš„è¿ç»­æ€§ã€‚**

## Arduino å…¥é—¨

åœ¨æœ¬èŠ‚ä¸­ï¼Œå°†è®¾ç½® Arduino IDE å¹¶ä¸ºæˆ‘ä»¬çš„å¼€å‘æ¿æ·»åŠ äº’è”ç½‘è¿æ¥ã€‚æˆ‘ä»¬å°†äº†è§£å¦‚ä½•é€‰æ‹©åˆé€‚çš„ä¸»æ¿å¹¶ä¸ºå…¶æ·»åŠ äº’è”ç½‘è¿æ¥ã€‚

è®¸å¤šä¸»æ¿æ²¡æœ‰äº’è”ç½‘è¿æ¥ï¼Œè€Œäº’è”ç½‘è¿æ¥æ˜¯åˆ¶é€ ç‰©è”ç½‘è®¾å¤‡æ‰€å¿…éœ€çš„ã€‚è¦ä¸ºæˆ‘ä»¬çš„ä¸»æ¿æ·»åŠ äº’è”ç½‘è¿æ¥ï¼Œæˆ‘ä»¬æœ‰å¤šç§é€‰é¡¹å¯ä¾›é€‰æ‹©:shieldã€å¾®èŠ¯ç‰‡æˆ–å…·æœ‰å†…ç½®æ— çº¿åŠŸèƒ½çš„ Arduino ä¸»æ¿ã€‚

> ğŸ’¡å±è”½åŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªæ‰©å±•æ¿ï¼Œå¯ä»¥æ”¾ç½®(å®‰è£…)åœ¨ Arduino æ¿çš„é¡¶éƒ¨ã€‚

ç›¾ç‰Œæœ‰å¾ˆå¤šç§:

```
 1\. Ethernet Shield. 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![](../Images/43528ca18ba978b321fe07ce342aa6e1.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--IOdnQgNn--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.pusher.com/wp-content/uploads/2018/01/make-realtime-light-monitor-using-arduino-pusher-1.jpeg) ä»¥å¤ªç½‘å±è”½([https://www . digikey . com/en/articles/techzone/2012/Jan/networking-options-for-arduino-based-systems](https://www.digikey.com/en/articles/techzone/2012/jan/networking-options-for-arduino-based-systems))

```
 2\. WiFi Shield. 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![](../Images/b57b92192188df9877ec81f9afca3fd0.png) ](https://res.cloudinary.com/practicaldev/image/fetch/s--I7BXJhlF--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.pusher.com/wp-content/uploads/2018/01/make-realtime-light-monitor-using-arduino-pusher-2.jpg) WiFi ç›¾[https://store.arduino.cc/usa/arduino-wifi-shield](https://store.arduino.cc/usa/arduino-wifi-shield)

```
 3\. 3G or LTE Shields. 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![](../Images/c71a39519a03812903eeb908e98f21b2.png) ](https://res.cloudinary.com/practicaldev/image/fetch/s--0gI7UM1u--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.pusher.com/wp-content/uploads/2018/01/make-realtime-light-monitor-using-arduino-pusher-3.jpg) Arduino GSM ç›¾[https://store.arduino.cc/usa/arduino-gsm-shield](https://store.arduino.cc/usa/arduino-gsm-shield)

æˆ‘ä»¬å°†ä½¿ç”¨å†…ç½® WiFi èŠ¯ç‰‡çš„ Arduino MKR1000ã€‚è¯¥æ¿åœ¨ [Arduino å•†åº—æœ‰å”®ã€‚](https://store.arduino.cc/usa/arduino-mkr1000)

[![](../Images/d602e10e6d3b05a4f286db4ea33f9cb7.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--v5kUnBry--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.pusher.com/wp-content/uploads/2018/01/make-realtime-light-monitor-using-arduino-pusher-4.jpg)Arduino mkr 1000 WIFI([https://store.arduino.cc/usa/arduino-mkr1000](https://store.arduino.cc/usa/arduino-mkr1000)

æ¥ä¸‹æ¥ï¼Œä»[è¿™é‡Œ](https://www.arduino.cc/en/Main/Software)ä¸‹è½½ Arduino IDE å¹¶å®‰è£…åœ¨ä½ çš„ç”µè„‘ä¸Šã€‚

å®‰è£…å®Œæˆåï¼Œé€šè¿‡å¯åŠ¨ IDE ç»§ç»­å®‰è£…**æ¿å®šä¹‰**ï¼Œç„¶åè½¬åˆ°`Tools > Boards > Board Manager`ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬æœç´¢å¹¶å®‰è£… MKR1000 çš„å®šä¹‰ã€‚

[![](../Images/f6920a6324a2f0b31d263ba581350f49.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--8ZUrTRli--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.pusher.com/wp-content/uploads/2018/01/make-realtime-light-monitor-using-arduino-pusher-5.png) è‘£äº‹ä¼šç»ç†

ä¸€æ—¦**æ¿å®šä¹‰**å®‰è£…å®Œæ¯•ï¼Œè½¬åˆ°`Tools | Boards`å¹¶é€‰æ‹©æ–°å®‰è£…çš„æ¿å®šä¹‰ã€‚

ä¸ºäº†å°†æˆ‘ä»¬çš„ Arduino æ¿è¿æ¥åˆ°äº’è”ç½‘ï¼Œæˆ‘ä»¬å¿…é¡»å®‰è£…ä¸€ä¸ªåä¸º`wifi101`çš„åº“ã€‚ä¸ºäº†å®‰è£…åº“ï¼Œè¯·è½¬åˆ°`Sketch` `>` `Include Library` `>` `Manage Libraries`ï¼Œç„¶åæœç´¢å¹¶å®‰è£…`wifi101`ã€‚

[![](../Images/84d7f87dc8a325c5e480c1e532ead9fb.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--57hntt53--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.pusher.com/wp-content/uploads/2018/01/make-realtime-light-monitor-using-arduino-pusher-6.png) å®‰è£… WiFi101 åº“

æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿›å…¥`Files > Examples > WiFi > ConnectWithWpa`æ¥æµ‹è¯•å®ƒæ˜¯å¦å·¥ä½œã€‚è¿™åº”è¯¥ä¼šåœ¨æˆ‘ä»¬çš„è‰å›¾ä¸­ç”Ÿæˆä¸€äº›ä»£ç ã€‚æ¥ä¸‹æ¥ï¼Œå°†`ssid`å’Œ`pass`ç¼–è¾‘ä¸ºæˆ‘ä»¬è·¯ç”±å™¨çš„ SSID å’Œå¯†ç :

```
 char ssid[] = "yourNetwork";     //  your network SSID (name)
    char pass[] = "secretPassword";  // your network password
    int status = WL_IDLE_STATUS;     // the Wifi radio's status 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#building-the-light-monitor-in-arduino)åœ¨ Arduino ä¸­æ„å»ºç¯å…‰ç›‘è§†å™¨

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£å¦‚ä½•è®¾ç½®ç”µè·¯å¹¶æµ‹é‡æ¥è‡ª MKR1000 æ¿ä¸Šä¼ æ„Ÿå™¨çš„æ•°æ®ã€‚é™¤äº† Arduino MKR1000 å’Œé€šå¸¸çš„è¯•éªŒæ¿å’Œè·³çº¿ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€äº›é¢å¤–çš„ç»„ä»¶ã€‚

*   å…‰ç”µæ± ([https://www.sparkfun.com/products/9088](https://www.sparkfun.com/products/9088))ã€‚
*   10k æ¬§å§†ç”µé˜»å™¨([https://www.sparkfun.com/products/8374](https://www.sparkfun.com/products/8374))ã€‚

å…‰ç”µæ± æ˜¯ä¸€ç§èƒ½è®©æˆ‘ä»¬æ¢æµ‹å…‰çº¿çš„ä¼ æ„Ÿå™¨ã€‚å®ƒä»¬é€šå¸¸è¢«è®¤ä¸ºæ˜¯å…‰æ•ç”µé˜»(LDR)ã€å…‰æ•ç”µé˜»æˆ– CdS ç”µæ± ã€‚

> ğŸ’¡å…‰ç”µæ± åŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªç”µé˜»å™¨ï¼Œå®ƒæ ¹æ®ç…§å°„åˆ°å¼¯æ›²è¡¨é¢çš„å…‰é‡æ¥æ”¹å˜ç”µé˜»å€¼(å•ä½ä¸ºæ¬§å§†)ã€‚

**ç»„è£…å…ƒä»¶**
é¦–å…ˆï¼Œå°†ç”µé˜»å™¨ä¸å…‰ç”µæ± ä¸²è”æ”¾ç½®åœ¨è¯•éªŒæ¿ä¸Šï¼Œé è¿‘ Arduino æ¿ã€‚

ç°åœ¨ï¼Œå°†ç”µé˜»å™¨çš„å¦ä¸€ç«¯è¿æ¥åˆ° Arduino æ¿ä¸Šçš„ GNDï¼Œå¹¶å°†å…‰ç”µæ± çš„å¦ä¸€ç«¯
è¿æ¥åˆ° Arduino æ¿çš„ VCC å¼•è„šã€‚æœ€åï¼Œå°†ç”µé˜»å™¨å’Œå…‰ç”µæ± ä¹‹é—´çš„ä¸­é—´å¼•è„šè¿æ¥åˆ° Arduino æ¿çš„æ¨¡æ‹Ÿå¼•è„š A0ã€‚æœ€ç»ˆç»“æœåº”è¯¥æ˜¯è¿™æ ·çš„:

[![](../Images/b27b81a08c0742aac6b373e2438f2417.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--5z8TawXv--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.pusher.com/wp-content/uploads/2018/01/make-realtime-light-monitor-using-arduino-pusher-7.png) æœ€ç»ˆç»“æœ(ç‰©è”ç½‘ä¸ Arduino èœè°±)

å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­é…ç½®ç”µè·¯æ¿ï¼Œä»¥è¯»å–æ¥è‡ªå…‰ç”µæ± çš„æ•°æ®ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°†ä»æ¨¡æ‹Ÿå¼•è„š A0 è·å–è¯»æ•°ï¼Œå¹¶å°†å…¶æ‰“å°åœ¨ä¸²è¡Œç«¯å£ä¸Šã€‚è¿™éƒ¨åˆ†çš„è‰å›¾éå¸¸ç®€å•ï¼Œåº”è¯¥æ˜¯è¿™æ ·çš„:

æˆ‘ä»¬å°†æŠŠè¿™ä¸ªè‰å›¾å¤åˆ¶å¹¶ç²˜è´´åˆ°æˆ‘ä»¬çš„ Arduino IDE ä¸­ï¼Œç„¶åä¸Šä¼ åˆ°æ¿ä¸Šã€‚

> ç¡®ä¿é€‰æ‹©äº†æ­£ç¡®çš„æ¿å’Œä¸²è¡Œç«¯å£ã€‚

```
 // Pins
    int sensorPin = A0;
    void setup() {
      // Serial
      Serial.begin(115200);
    }

    void loop() {
      // Reading
      int sensorValue = analogRead(sensorPin);
      // Display
      Serial.print("Sensor reading: ");
      Serial.println(sensorValue);
      // Wait
      delay(500);
    } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

> ğŸ’¡**æ‚¨å¯ä»¥å°† Arduino è‰å›¾æ–‡ä»¶ä¿å­˜åˆ°æ‚¨çš„æœºå™¨ä¸Šï¼Œä»¥ä¾¿ä»¥åå‚è€ƒã€‚åªè¦ä¸Šä¼ åˆ° Arduino æ¿ä¸Šï¼Œä»–ä»¬å¯ä»¥è¢«å‘½åä¸º******ã€‚****

 **è¿è¡Œåï¼Œæˆ‘ä»¬æ‰“å¼€ä¸²è¡Œç›‘è§†å™¨ï¼Œç«‹å³è§‚å¯Ÿä¼ æ„Ÿå™¨çš„è¯»æ•°:

[![](../Images/95e679e240bd3a87b8f6dd12dabe54a8.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--kFrSHx3h--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.pusher.com/wp-content/uploads/2018/01/make-realtime-light-monitor-using-arduino-pusher-8.png)

å¦‚æœæˆ‘ä»¬æŠŠæ‰‹æ”¾åœ¨ä¼ æ„Ÿå™¨ä¸Šï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å®ƒæµ‹å¾—çš„æ•°å€¼æœ‰æ‰€ä¸‹é™ã€‚ç°åœ¨è®©æˆ‘ä»¬é›†ä¸­ç²¾åŠ›åˆ›å»º web åº”ç”¨ç¨‹åºã€‚

## [](#setting-up-the-web-application)è®¾ç½® web åº”ç”¨ç¨‹åº

åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„ web åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºæ”¶é›†æ•°æ®ä½œä¸ºä¸€ä¸ª`GET`è¯·æ±‚ï¼Œå¹¶å°†å…¶å®æ—¶æ˜¾ç¤ºç»™è®¢é˜…è¯¥é¢‘é“çš„ç”¨æˆ·ã€‚å¯¹äºå®æ—¶æ˜¾ç¤ºï¼Œæˆ‘ä»¬å°†ä½¿ç”¨[æ¨æ†](http://pusher.com)ã€‚

> ğŸ’¡Pusher æ˜¯ä¸€ä¸ªç®€å•çš„æ‰˜ç®¡ APIï¼Œç”¨äºé€šè¿‡ WebSockets å°†å®æ—¶åŒå‘åŠŸèƒ½å¿«é€Ÿã€è½»æ¾ã€å®‰å…¨åœ°é›†æˆåˆ° web å’Œç§»åŠ¨åº”ç”¨ç¨‹åºæˆ–ä»»ä½•å…¶ä»–äº’è”ç½‘è¿æ¥è®¾å¤‡ã€‚

ç¬¬ä¸€æ­¥æ˜¯åˆ›å»ºä¸€ä¸ªå…è´¹çš„ pusher å¸æˆ·ï¼Œå¦‚æœä½ è¿˜æ²¡æœ‰ï¼Œé‚£ä¹ˆåœ¨[ä»ªè¡¨æ¿](https://dashboard.pusher.com)ä¸Šåˆ›å»ºä½ çš„åº”ç”¨ç¨‹åºã€‚

**åˆ›å»ºæ¨é€åº”ç”¨ç¨‹åº**
åˆ›å»ºæ¨é€å¸æˆ·å¹¶è½¬åˆ°æ‚¨çš„åº”ç”¨ç¨‹åº>åˆ›å»ºæ–°åº”ç”¨ç¨‹åºã€‚å¡«å†™æ‚¨çš„åº”ç”¨ç¨‹åºåç§°ï¼Œé€‰æ‹©ä¸€ä¸ªé›†ç¾¤ï¼Œé€‰æ‹© JavaScript å’Œ PHPï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹äº†ã€‚

åº”ç”¨ç¨‹åºè®¾ç½®å±å¹•åº”è¯¥å¦‚ä¸‹æ‰€ç¤º:

[![](../Images/ab2c7a5ae681ddeca32ca982b3276fd1.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--SrpXBSb7--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.pusher.com/wp-content/uploads/2018/01/make-realtime-light-monitor-using-arduino-pusher-9.png)

å®Œæˆåï¼Œæ‚¨å°†è·å¾—åº”ç”¨ç¨‹åºå¯†é’¥ã€‚

**è®¾ç½®æˆ‘ä»¬çš„é¡¹ç›®**
æˆ‘ä»¬å°†åœ¨æˆ‘ä»¬çš„`localhost`æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º`arduino-light-monitor`çš„æ–‡ä»¶å¤¹ã€‚

ç„¶åï¼Œæ‰“å¼€æˆ‘ä»¬çš„ç»ˆç«¯å¹¶é”®å…¥`composer require pusher/pusher-php-server`ï¼Œè¿™å°†åœ¨æˆ‘ä»¬çš„ç›®å½•ä¸­ç”Ÿæˆå‡ ä¸ªæ–‡ä»¶ã€‚

åˆ›å»ºä¸€ä¸ªåä¸º`notification.html`çš„æ–‡ä»¶ï¼Œç„¶åæˆ‘ä»¬æ·»åŠ ä¸‹é¢çš„ HTML å’Œ JavaScriptã€‘

```
 <html>
    <head>
      <title>Notifications From Light monitor</title>
      <script src="https://js.pusher.com/4.1/pusher.min.js"></script>
      <script>
        //Enable Pusher Logging - don't include this in production
        Pusher.logToConsole = true;

        //Create a new instance of pusher with your credentials
        var pusher = new Pusher('APP_KEY', {
            cluster: 'PUSHER_CLUSTER',//if you chose a different cluster replace it here
            encrypted: true
          });

        //subscribe to a channel you will listen on
        var channel = pusher.subscribe('light-monitor-channel');

        //What happens when light-readings-sent is fired
        channel.bind('light-readings-sent', function(data){
          //gets the ul in the dom
          var ul = document.querySelector('ul');
          //creates a li
          var li = document.createElement('li');
          //Attaches the data received to the text node
          var itemText = document.createTextNode(data.value);
          //Append the data to the li
          li.appendChild(itemText);
          //Append the li to the ul
          ul.appendChild(li);
        });
      </script>
    </head>
    <body>
      <ul></ul>
    </body>
    </html> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™é‡Œå‘ç”Ÿçš„äº‹æƒ…æ˜¯ï¼Œæˆ‘ä»¬è®¢é˜…ä¸€ä¸ªåä¸º`light-monitor-channel`çš„é¢‘é“ï¼Œç„¶åç­‰å¾…ï¼Œç›´åˆ°æˆ‘ä»¬æ”¶åˆ°ä¸€ä¸ªåä¸º`light-readings-sent`çš„äº‹ä»¶ã€‚æ¯å½“äº‹ä»¶è¢«è§¦å‘æ—¶ï¼Œæˆ‘ä»¬å°†æ¥æ”¶åˆ°çš„æ•°æ®è¿½åŠ åˆ°æˆ‘ä»¬çš„åˆ—è¡¨ä¸­ã€‚

æˆ‘ä»¬è¿˜å°†åˆ›å»ºå¦ä¸€ä¸ªåä¸º`index.php`çš„æ–‡ä»¶ã€‚è¿™æ˜¯å°†äº‹ä»¶å‘é€åˆ°é€šçŸ¥é€šé“çš„æ–‡ä»¶ã€‚æˆ‘ä»¬å°†æŠŠä¸‹é¢çš„ PHP ä»£ç æ·»åŠ åˆ°æ–‡ä»¶ä¸­:

```
 <?php
      require __DIR__ . '/vendor/autoload.php';

      $options = array(
        'cluster' => 'PUSHER_APP_CLUSTER',
        'encrypted' => true
      );
      $pusher = new Pusher\Pusher(
        'PUSHER_APP_KEY',// replace with yours
        'PUSHER_APP_SECRET',//replace with yours
        'PUSHER_APP_ID', //replace with yours
        $options
      );

      //checks if there is any data sent
      if(isset($_GET['value'])){
        $data['value'] = $_GET['value'];
        //triggers the event on the channel
        $pusher->trigger('light-monitor-channel', 'light-readings-sent', $data);
      } else {
        echo "Nothing to do";
      }
    ?> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

> ğŸ’¡å¦‚æœä½ éœ€è¦ä¸€ä¸ªåœ°æ–¹æ¥å­˜æ”¾ä½ çš„å†…å®¹ï¼Œä½ å¯ä»¥å»[000webhost.com](http://000webhost.com)åˆ›å»ºä¸€ä¸ªå…è´¹çš„å­åŸŸï¼Œåœ¨é‚£é‡Œä½ å¯ä»¥ä¸Šä¼ ä½ çš„ arduino-light æ–‡ä»¶å¤¹çš„å†…å®¹ã€‚

æˆ‘ä»¬å°†é€šè¿‡åœ¨ä¸¤ç§ä¸åŒçš„æµè§ˆå™¨ä¸­æ‰“å¼€`notification.html`å’Œ`index.php`æ¥æµ‹è¯•å®ƒã€‚å½“æˆ‘ä»¬é‡æ–°åŠ è½½`index.php`æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å¾—åˆ°ä¸€ä¸ªæ·»åŠ äº†å€¼â€œç©ºè¯·æ±‚â€çš„æ–°åˆ—è¡¨é¡¹ã€‚å¦‚æœæˆ‘ä»¬å°è¯•`index.php?value=123`ï¼Œæˆ‘ä»¬åº”è¯¥ä¼šå°†`value 123`å®æ—¶æ·»åŠ åˆ°æˆ‘ä»¬çš„é€šçŸ¥åˆ—è¡¨ä¸­ã€‚

è¿™ä¸æ˜¯å¾ˆæ£’å—ï¼Ÿ

## [](#sending-the-sensor-readings-to-the-web-app)å°†ä¼ æ„Ÿå™¨è¯»æ•°å‘é€åˆ° web app

æœ€åï¼Œæˆ‘ä»¬å°†çœ‹çœ‹å¦‚ä½•å°†æ•°æ®ä» Arduino æ¿å‘é€åˆ°æœåŠ¡å™¨ã€‚

ç»§ç»­æˆ‘ä»¬ä¹‹å‰çš„è‰å›¾ï¼Œæˆ‘ä»¬åªæ˜¯é€šè¿‡è®°ä¸‹é‡è¦çš„éƒ¨åˆ†æ¥æ›¿æ¢å®ƒ:

```
 // Pins
    int sensorPin = A0;

    char ssid[] = "wifi_name"; //your wifi name
    char pass[] = "wifi_pass"; // your wifi password
    int status = WL_IDLE_STATUS;

    char server[] = "yourexampleserver.com"; //replace with your localhost or domain

    // Create an instance of WiFiClient
    WiFiClient client;

    // We define the interval on which we want to send the data
    unsigned long lastConnectionTime = 0;
    const unsigned long postingInterval = 60L * 1000L; //this implies 60,000L the L represents the long datatype

    void setup() {
      // Serial
      Serial.begin(115200);

      // Attempt to connect to Wifi network:
      while ( status != WL_CONNECTED) {

        Serial.print("Attempting to connect to WPA SSID: ");
        Serial.println(ssid);

        // Connect to WPA/WPA2 network:
        status = WiFi.begin(ssid, pass);

        // Wait 10 seconds for connection:
        delay(10000);
      }

      // you're connected now
      Serial.print("You're connected to the network");
    }

    void loop() {
      if(millis() - lastConnectionTime > postingInterval) {
        //Measure the light level
        int sensorValue = analogRead(sensorPin);

        //Send the value to the server
        sendHTTPRequest(sensorValue);
      }
    }

    void sendHTTPRequest(int sensorValue){
      // Close existing connection
      client.stop();

      // Connect & send request
      if (client.connect(server, 80)) {

        Serial.println("connecting...");

        // Send the HTTP GET request:
        client.println("GET /light/?value=" + String(sensorValue) + " HTTP/1.1");
        client.println("Host: yourexampleserver.com");
        client.println("User-Agent: ArduinoWiFi/1.1");
        client.println("Connection: close");
        client.println();

        // Note the time that the connection was made:
        lastConnectionTime = millis();
      }
      else {
        // if you couldn't make a connection:
        Serial.println("connection failed");
      }
    } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨`WiFiClient`çš„å®ä¾‹åˆ›å»ºäº†ä¸€ä¸ªåˆ°æŒ‡å®š WiFi `ssid`çš„è¿æ¥ã€‚æˆ‘ä»¬å°†ä½¿ç”¨è¿™ä¸ªè¿æ¥ä¸æˆ‘ä»¬çš„è¿œç¨‹æœåŠ¡å™¨è¿›è¡Œäº¤äº’ã€‚

åœ¨`setup` `()`å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¤„ç† [S](https://www.arduino.cc/reference/en/language/functions/communication/serial/) [ææ–™](https://www.arduino.cc/reference/en/language/functions/communication/serial/)çš„åˆå§‹åŒ–ï¼Œå¹¶è¿æ¥åˆ°ç”±ä¸Šè¿°`ssid`å’Œ`pass`å˜é‡æŒ‡å®šçš„ WiFi ç½‘ç»œã€‚

åœ¨`loop` `()`å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬æ£€æŸ¥æˆ‘ä»¬æ˜¯å¦å¤„äºè¿‡è´¦åŒºé—´ï¼Œå¦‚æœæ˜¯ï¼Œæˆ‘ä»¬è¯»å–è¯»æ•°å¹¶è°ƒç”¨ä¸‹é¢å®šä¹‰çš„`sendHTTPRequest`å‡½æ•°ã€‚

åœ¨`sendHTTPRequest` `()`å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬æ¥å—ä¸€ä¸ªåä¸º`sensorValue`çš„å‚æ•°ã€‚å› ä¸º Arduino åœ¨å¾ªç¯ä¸­è¿è¡Œä»£ç ï¼Œæ‰€ä»¥è¦åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯ç”¨è¯­å¥`client.stop()`åœæ­¢ä»»ä½•ä¹‹å‰æ‰“å¼€çš„å®¢æˆ·ç«¯è¿æ¥ã€‚è¿™å°†é˜»æ­¢è¿æ¥è¢«åˆ›å»ºï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨åä¸ä¼šè¢«ä¸¢å¼ƒã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°è¯•è¿æ¥åˆ°å˜é‡`server[]`ä¸­å®šä¹‰çš„æœåŠ¡å™¨ã€‚æˆ‘ä»¬æ£€æŸ¥æ˜¯å¦å¯ä»¥å»ºç«‹è¿æ¥ï¼Œå¦‚æœä¸èƒ½ï¼Œæˆ‘ä»¬æ‰“å°åˆ°ä¸²è¡Œâ€œè¿æ¥å¤±è´¥â€ã€‚ä¸€æ—¦è¿æ¥äº†å®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬å°±é€šè¿‡ URL å°†ä¼ æ„Ÿå™¨ pin å€¼å‘é€åˆ°æˆ‘ä»¬çš„ web åº”ç”¨ç¨‹åºã€‚

å¦‚æœæˆ‘ä»¬ç°åœ¨æµ‹è¯•ï¼Œæˆ‘ä»¬å°†æœ‰å…‰ä¼ æ„Ÿå™¨è¯»æ•°æ¯åˆ†é’Ÿã€‚

[![](../Images/e5c264800b33851ed5a43a22bb31f93e.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--PjQL_DBm--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.pusher.com/wp-content/uploads/2018/01/make-realtime-light-monitor-using-arduino-pusher-10.png)

## [](#conclusion)ç»“è®º

æˆ‘ä»¬å·²ç»ä½¿ç”¨ Arduino å’Œ Pusher æˆåŠŸåœ°æ„å»ºäº†ä¸€ä¸ªå…‰ç›‘è§†å™¨ã€‚å¦‚æœä½ å–œæ¬¢è¿™ä¸ªæ•™ç¨‹ï¼Œå¹¶æƒ³åœ¨ç‰©è”ç½‘ä¸–ç•Œä¸­ä»é›¶åˆ°è‹±é›„ï¼Œä½ åº”è¯¥çœ‹çœ‹ Marco Schwartz çš„ä¹¦[â€œArduino Cookbook çš„ç‰©è”ç½‘â€ã€‚å®ƒåŒ…å«è¶…è¿‡ 60 ç§é…æ–¹ï¼Œå°†å¸®åŠ©æ‚¨æ„å»ºæ™ºèƒ½ç‰©è”ç½‘è§£å†³æ–¹æ¡ˆï¼Œå¹¶ä¸ºæ‚¨å¸¦æ¥æ‚¨è®¤ä¸ºåªå­˜åœ¨äºè©¹å§†æ–¯Â·é‚¦å¾·ç”µå½±ä¸­çš„è¿·äººç‰©è”ç½‘é¡¹ç›®ã€‚](https://www.packtpub.com/hardware-and-creative/internet-things-arduino-cookbook)

å¦‚æœæ‚¨å¯¹ç‰©è”ç½‘ä¸ Pusher çš„é›†æˆæœ‰ä»»ä½•é—®é¢˜æˆ–å…¶ä»–æƒ³æ³•ï¼Œè¯·åœ¨ä¸‹é¢ç•™ä¸‹è¯„è®ºï¼

è¿™ç¯‡æ–‡ç« æœ€åˆå‡ºç°åœ¨ [Pusher åšå®¢](https://blog.pusher.com/make-a-realtime-light-monitor-using-arduino-and-pusher/)ä¸Šã€‚**