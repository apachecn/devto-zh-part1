# git Wreckedâ€”â€”åœ¨ä¸ç ´åä¸œè¥¿çš„æƒ…å†µä¸‹ä¿æŒåˆ†æ”¯åŒæ­¥

> åŸæ–‡:[https://dev.to/rpalo/git-wrecked-ä¿æŒä½ çš„åˆ†æ”¯åŒæ­¥-ä¸ç ´åä¸œè¥¿-4p6](https://dev.to/rpalo/git-wrecked--keeping-your-branches-synced-without-breaking-things-4p6)

ä¸Šä¸ªæœˆï¼Œæˆ‘å‚åŠ äº†æ•°å­—æµ·æ´‹çš„ [Hacktoberfest](https://hacktoberfest.digitalocean.com/) æ´»åŠ¨ï¼Œæ„Ÿè§‰æ£’æäº†ã€‚å®ƒå¸®åŠ©æˆ‘é¼“èµ·å‹‡æ°”ä¸ºå¼€æºè½¯ä»¶åšè´¡çŒ®ã€‚è¿™ç»å¯¹æ˜¯ä¸€æ¬¡å¾ˆæ£’çš„ç»å†(æˆ‘è¿˜å› æ­¤å¾—åˆ°äº†ä¸€ä»¶ t æ¤ğŸ˜¬).è¿™çœŸçš„æ˜¯æˆ‘ç¬¬ä¸€æ¬¡ä¸[åˆ†å‰ Git å·¥ä½œæµ](https://www.atlassian.com/git/tutorials/comparing-workflows/forking-workflow)äº’åŠ¨ï¼Œæˆ‘ä¸ç¡®å®šè¯¥åšä»€ä¹ˆã€‚æˆ‘åœ¨è¿™é‡Œå’Œé‚£é‡Œçœ‹åˆ°äº†ä¸€äº›å…³äºåº”è¯¥å¦‚ä½•åšçš„ç‰‡æ®µï¼Œä½†æ˜¯é™¤äº†æœ¬åœ°/ä¸ªäºº git æ‰€éœ€çš„åŸºæœ¬çš„`push, pull, add, commit`å‘½ä»¤ä¹‹å¤–ï¼Œæˆ‘å¯¹é‚£äº›*æˆ–* git å‘½ä»¤è¿˜ä¸å¤Ÿç†Ÿæ‚‰ã€‚æ‰€ä»¥æˆ‘æƒ³åˆ†äº«ä¸€ä¸ªæ•…äº‹å’Œæˆ‘å­¦åˆ°çš„ä¸œè¥¿ã€‚

## [](#forking-gui)åˆ†å‰ GUI

ä¸ºäº†è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘æ­£åœ¨å¯¹ä¸€ä¸ªè‡ªè¿°æ–‡ä»¶åšä¸€äº›è¡¥å……ã€‚æˆ‘å·²ç»å®Œæˆäº†å›è´­ï¼Œåœ¨æˆ‘çš„æœºå™¨ä¸Šå…‹éš†äº†ä¸€ä¸ªæœ¬åœ°ç‰ˆæœ¬ï¼Œä¸ºä¿®å¤åˆ›å»ºäº†ä¸€ä¸ªåˆ†æ”¯ï¼Œåšäº†ä¸€äº›åˆå§‹æ›´æ”¹ï¼Œæ¨å›åˆ° Githubï¼Œå¹¶æ‰“å¼€äº†ä¸€ä¸ª pull è¯·æ±‚ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä¸€åˆ‡é¡ºåˆ©ã€‚æˆ‘è§‰å¾—å¾ˆæœ‰æˆå°±æ„Ÿã€‚

[![I love it when a plan comes together](../Images/a078274635b25f7342a5b7e372b11822.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Uh6ZR_qp--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://assertnotmagic.com/img/git-plan.gif)

å‡ å¤©åï¼Œç»´æŠ¤è€…ç»™äº†æˆ‘ä¸€äº›æƒ³æ³•å’Œå¯èƒ½çš„ä¿®æ”¹ã€‚å¤ªå¥½äº†ï¼è¿™æ˜¯çœŸæ­£çš„åˆä½œï¼å¤ªä»¤äººå…´å¥‹äº†ï¼æˆ‘å›åˆ°æˆ‘çš„æœ¬åœ°å›è´­ï¼Œä½†æˆ‘æ³¨æ„åˆ°åŸæ¥çš„ä¸Šæ¸¸å›è´­å·²ç»åšäº†ä¸€äº›æ”¹å˜ã€‚å¬è¯´è®©æ‚¨çš„æœ¬åœ°å›è´­å’Œåˆ†æ”¯æœºæ„ä¿æŒæœ€æ–°æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œæˆ‘å†³å®šå°è¯•åˆ·æ–°ä¸€åˆ‡â€¦ä½†æˆ‘çœŸçš„ä¸çŸ¥é“å¦‚ä½•åšã€‚æˆ‘ç¯é¡¾å››å‘¨ï¼Œä½†æ˜¯æˆ‘è¢«å®˜æ–¹çš„ git æ–‡æ¡£å“ä½äº†ã€‚è¿™æ—¶æˆ‘æƒ³èµ·æˆ‘æœ‰ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„ git GUI åº”ç”¨ç¨‹åºï¼Œ [GitKraken](https://www.gitkraken.com/) ã€‚æˆ‘æ‰“å¼€å®ƒï¼Œç‚¹å‡»äº†å‡ ä¸‹ï¼Œæˆ‘å°±æ›´æ–°äº†æˆ‘çš„`origin`å’Œæœ¬åœ°åˆ†æ”¯ï¼Œåšäº†æˆ‘æƒ³åšçš„å¿«é€Ÿç¼–è¾‘ï¼Œå¹¶æŠŠæ‰€æœ‰ä¸œè¥¿éƒ½ä¸Šä¼ åˆ° GitHubã€‚è‡³å°‘æˆ‘æ˜¯è¿™ä¹ˆè®¤ä¸ºçš„ã€‚

é‚£å¤©æ™šä¸Šï¼Œæˆ‘æ”¶åˆ°äº†ç»´æŠ¤è€…çš„ä¸€æ¡æ¶ˆæ¯ï¼Œè¯¢é—®æˆ‘æ·»åŠ åˆ°æ‹‰å–è¯·æ±‚ä¸­çš„è¿™äº›é¢å¤–æ–‡ä»¶æ˜¯ä»€ä¹ˆã€‚è®©æˆ‘æ„Ÿåˆ°ææƒ§çš„æ˜¯ï¼Œå½“æˆ‘æŸ¥çœ‹æˆ‘çš„ GitHub repo çš„æäº¤å†å²æ—¶ï¼Œå®ƒæ˜¯æ··ä¹±çš„ï¼Œæˆ‘ç”šè‡³åœ¨æˆ‘çš„ pull è¯·æ±‚åˆ†æ”¯æ›´æ”¹ä¸­åŠ å…¥äº†å…¶ä»–äººä»`upstream/master`æäº¤çš„å†…å®¹ã€‚æˆ‘éå¸¸å›°æƒ‘â€”â€”ä¹Ÿæ„Ÿåˆ°ç¾æ„§ã€‚ä¸ä»…æˆ‘åœ¨â€œåš gitâ€ä¸Šæç ¸äº†ï¼Œè€Œä¸”å…¶ä»–äºº(å¯èƒ½è¿˜æœ‰å¾ˆå¤šäºº)ä¹Ÿçœ‹åˆ°äº†æˆ‘è¿™æ ·åšã€‚

[![Oh no.](../Images/fd27324f87c77573bc6f9cf95ae6f8ff.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--ublTHaac--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://assertnotmagic.com/img/git-oh-no.png)

ä¸è¦è¯¯è§£æˆ‘ã€‚GitKraken æ˜¯ä¸€ä¸ªç¥å¥‡çš„å·¥å…·ï¼Œéå¸¸æ¼‚äº®ï¼Œéå¸¸å¼ºå¤§ã€‚æˆ‘åªæ˜¯è®¤ä¸ºï¼Œæˆ‘ä¸ªäººåº”è¯¥åªä½¿ç”¨å®ƒæ¥æ£€æŸ¥é¡¹ç›®ï¼Œè€Œä¸æ˜¯ä½¿ç”¨å®ƒçš„ç¼–è¾‘åŠŸèƒ½ã€‚åœ¨å‘½ä»¤è¡Œä¸Šï¼Œå½“æ‚¨é”®å…¥ git å‘½ä»¤æ—¶ï¼Œæ‚¨çŸ¥é“æ‚¨æ­£åœ¨æ›´æ”¹å†…å®¹ï¼Œè¿™æ˜¯ä¸€ä»¶å¤§äº‹ã€‚åœ¨å›¾å½¢ç”¨æˆ·ç•Œé¢ä¸­ï¼Œå¦‚æœä½ ä¸çŸ¥é“ä½ åœ¨åšä»€ä¹ˆï¼Œä»–ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°ç‚¹å‡»ä¸€äº›æŒ‰é’®ï¼Œåšå¾ˆå¤šæ½œåœ¨å±é™©çš„äº‹æƒ…ï¼Œè€Œæˆ‘ä¹ æƒ¯äº†å›¾å½¢ç”¨æˆ·ç•Œé¢ä¸­çš„æŒ‰é’®å‡ ä¹æ€»æ˜¯ä½é£é™©å’Œå¯æ’¤é”€çš„ã€‚æˆ‘ç¡®å®éœ€è¦é¢å¤–çš„æ€è€ƒæ—¶é—´æ¥è¾“å…¥ git å‘½ä»¤ã€‚

ä½†ä¸ç®¡æ€æ ·ï¼Œè¿™è®©æˆ‘æƒ³åˆ°äº†è¿™ç¯‡æ–‡ç« çš„é‡è¦éƒ¨åˆ†:

## [](#the-right-way%E2%84%A2)æ­£é“

æœ¬èŠ‚çš„ç›®æ ‡æ˜¯ä»¥æ­£ç¡®çš„æ–¹å¼(æˆ–è€…è‡³å°‘æ˜¯ä¸€ç§æ­£ç¡®çš„æ–¹å¼)åˆ—å‡ºåˆ†å‰ Git å·¥ä½œæµçš„æ¯ä¸€æ­¥ï¼Œä»¥åŠç›¸å…³çš„å‘½ä»¤ï¼Œä»¥ä¾¿æœªæ¥çš„æˆ‘åœ¨ä¸å¯é¿å…åœ°å¿˜è®°æ—¶å¯ä»¥å›æ¥é˜…è¯»ã€‚æˆ‘å°†æŠŠè¿™ä¸ªå±•ç¤ºå‡ºæ¥ï¼Œä½†æ˜¯å¦‚æœä½ çœ‹åˆ°æˆ‘åšé”™äº†æˆ–è€…å¯ä»¥åšå¾—æ›´å¥½çš„åœ°æ–¹ï¼Œè¯·ä¸€å®šè®©æˆ‘çŸ¥é“ï¼Œæˆ‘ä¼šå°½é‡ç”¨ä½ åˆ†äº«çš„æœ€ä½³å®è·µæ¥æ›´æ–°è¿™ä¸ªã€‚

```
# This is assuming you've already forked the Upstream Repo
# on GitHub/BitBucket/GitLab/etc.

# Clone to get an initial local copy.
git clone <url-to-your-fork>

# Add a remote link to the upstream repo
git remote add upstream <url-to-upstream-repo>

# Create a new branch for the feature/fix that you're doing
git checkout -b <new-branch-name>

# Do some work, edit some files
git add <files>
git commit -m <your-commit-message> 
```

å“¦ä¸ï¼å¯¹`upstream`å’Œ/æˆ–æ‚¨çš„`origin/master`å’Œ/æˆ–æ‚¨çš„`origin/<branch-name>`è¿›è¡Œäº†æ›´æ”¹ï¼Œè€Œè¿™äº›æ›´æ”¹ä¸åœ¨æ‚¨çš„æœ¬åœ°æœºå™¨ä¸Šã€‚

```
# Inspect the changes made to origin
git fetch origin

# Update your branch
git merge origin/<branch-name>

# Update your master
git checkout master
git merge origin/master

# Inspect the changes made to upstream
git fetch upstream

# If you don't have any commits on master ahead of upstream,
# you can just pull the upstream changes in
git checkout master
git merge upstream/master

# If your master branch is ahead of upstream, you may want to rebase
# In order to "work on top of" everyone else's changes, instead of merging
git rebase upstream/master

# Now that your master branch is up to date, you can decide whether
# or not you want to rebase your feature branch onto the new
# tip of your master branch.  Generally a good idea.
git checkout <your-feature-branch>
git rebase master

# OR, if you're about to submit a pull request and you  want to
# clean up your commit history, do an interactive rebase and
# squash and otherwise clean your commits/messages
git rebase --interactive master

# Finally, push your updated branch
git push -u origin <your-feature-branch>

# Sometimes, rebasing rewrites history, and pushing won't work.
# Try --force-with-lease, which is the safe way to force the push
# through.  More on that later
git push origin <your-feature-branch> --force-with-lease

# Optionally, push everything to update your origin/master too
git push origin --all 
```

## [](#what-is-git-rebase)ä»€ä¹ˆæ˜¯ Git Rebase

Git Rebase æŠŠæˆ‘æç³Šæ¶‚äº†ã€‚æˆ‘ä¸çŸ¥é“æˆ‘èƒ½æä¾›æ¯”[äºšç‰¹å…°è’‚æ–¯æ•™ç¨‹](https://www.atlassian.com/git/tutorials/rewriting-history/git-rebase)æ›´å¥½/æ›´æœ‰ç”»é¢æ„Ÿçš„è§£é‡Šã€‚è¿™æ˜¯ç»™ç‰¹åˆ«æ‡’çš„äººçš„ç®€çŸ­ç‰ˆæœ¬ã€‚

1.  æ‚¨çš„ç‰¹å¾åˆ†æ”¯åœ¨æŸä¸ªç‚¹ä»ä¸»ç‰¹å¾åˆ†æ”¯ï¼Œè¯¥ç‚¹ç§°ä¸ºâ€œåŸºç¡€â€ã€‚
2.  é‡å®šåŸºç¡€å°†è¿™ä¸ªâ€œåŸºç¡€â€æŒ‡å‘ä¸€ä¸ªæ–°çš„åœ°æ–¹ï¼Œé€šå¸¸å°†å®ƒå‘å‰ç§»åŠ¨åˆ°å¦ä¸€ä¸ªåˆ†æ”¯çš„æ–°ä¸»ç®¡ã€‚
3.  åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œæ‚¨å¯ä»¥æ”¹å†™æäº¤æ¶ˆæ¯ã€é‡æ–°æ’åºæäº¤ã€åˆ é™¤æäº¤å’Œä¸€èµ·æŒ¤å‹æäº¤ã€‚
4.  ä¸€èˆ¬æ¥è¯´ï¼Œä½ æ°¸è¿œä¸åº”è¯¥å¯¹å·²ç»å‘å¸ƒåˆ°å…¬å…±åœºåˆçš„ä¸œè¥¿è¿›è¡Œé‡æ–°è°ƒæ•´ï¼Œ*å°¤å…¶æ˜¯*å¦‚æœæœ‰å¯èƒ½å…¶ä»–äººå·²ç»å¼€å§‹å¯¹ä½ é‡æ–°è°ƒæ•´çš„ä¸œè¥¿è¿›è¡Œå·¥ä½œã€‚å°è¯•åªåœ¨æ‚¨çš„æœ¬åœ°ç³»ç»Ÿä¸Šé‡ç½®*ã€‚*
5.  åœ¨æ‹‰è¯·æ±‚è¿‡ç¨‹ä¸­ï¼Œä¸€æ—¦æäº¤äº†åˆå§‹è¯·æ±‚ï¼Œå°±ä¼šè¦æ±‚æ‚¨æ›´æ–°/ä¿®æ”¹åŸå§‹çš„æ‹‰è¯·æ±‚ä»£ç ï¼Œè¿™å°†å‘æ‹‰è¯·æ±‚å†å²è®°å½•ä¸­æ·»åŠ å¤šä¸ªæäº¤ã€‚æ‚¨å¯èƒ½ä¼šè¯•å›¾å‹ç¼©è¿™äº›å†…å®¹ï¼Œä»¥ä¿æŒæ‹‰å–è¯·æ±‚çœ‹èµ·æ¥æ¼‚äº®è€Œç®€æ´ã€‚æŠµåˆ¶è¿™ç§å†²åŠ¨ã€‚ç»è¿‡ç ”ç©¶ï¼Œä¼¼ä¹ a)è¿™æ ·åšä¼šè¿åç¬¬ 4 æ¡ï¼Œb)æ‹‰å–è¯·æ±‚åº”è¯¥æ˜¯è®¨è®ºçš„è®ºå›/è®°å½•ï¼Œå¦‚æœä½ é‡å†™å†…å®¹ä»¥éšè—æ‰€æœ‰çš„ä¸­é—´æ›´æ”¹ï¼Œä»»ä½•äº‹æƒ…éƒ½æ²¡æœ‰æ„ä¹‰ï¼Œä½ ä¼šé”™è¿‡é‚£æ®µå†å²ã€‚
6.  è¿œç¨‹å­˜å‚¨åº“ä¸ä¸€å®šå–œæ¬¢è¿™ç§é‡å†™å†å²çš„è¡Œä¸ºã€‚é€šå¸¸ï¼Œä¸€ä¸ªç®€å•çš„`git push`å°±ä¼šè¢«æ‹’ç»ã€‚æ‰§è¡Œ`git push --force`å°†è¿«ä½¿è¿œç¨‹å›è´­æ¥å—æ¨é€ï¼Œä½†ä½ å¯èƒ½ä¸åº”è¯¥ä½¿ç”¨`--force`ã€‚å®‰å…¨çš„æ–¹æ³•æ˜¯ä½¿ç”¨`--force-with-lease`ï¼Œå®ƒåªå…è®¸ä¸€ä¸ªä¸ä¼šå¼„ä¹±ä»»ä½•äººçš„åŠ›é‡ã€‚å—¯ï¼Œå¤§éƒ¨åˆ†æ—¶é—´ã€‚é˜…è¯»[è¿™ç¯‡å…³äºå¼ºåˆ¶ç§Ÿèµ](https://developer.atlassian.com/blog/2015/04/force-with-lease/)å’Œä¸å…ˆåˆå¹¶å°±è·å–å’Œæ¨é€çš„å±é™©çš„å¸–å­ã€‚

## [](#wrap-up)æ€»ç»“èµ·æ¥

å°±åƒæˆ‘å¼€å§‹è¯´çš„ï¼Œæˆ‘åœ¨è¿‡å»çš„ä¸¤ä¸ªæ˜ŸæœŸé‡Œä¸€ç›´åœ¨å­¦ä¹ è¿™ä¸ªå·¥ä½œæµç¨‹ï¼Œæ‰€ä»¥æˆ‘ç»ä¸ä»…ä»…æ˜¯ä¸€ä¸ªåˆå­¦è€…ã€‚å¸Œæœ›è¿™æœ‰æ‰€å¸®åŠ©ï¼Œä¹Ÿå¸Œæœ›æ¯”æˆ‘èªæ˜çš„äººä¼šè®©æˆ‘çŸ¥é“æˆ‘æ˜¯å¦åšé”™äº†ä»€ä¹ˆã€‚åœ¨æˆ‘ç¬¨æ‹™åœ°å®Œæˆæˆ‘çš„è´¡çŒ®æ—¶ï¼Œå¯¹æˆ‘å¦‚æ­¤è€å¿ƒçš„ Exercism Ruby Track å›¢é˜Ÿå¤§å£°å–Šå‡ºæ¥ã€‚

* * *

*åŸå¸– [`assert_not magic?`](https://assertnotmagic.com)*