# ç”¨ Gatsby å‘å¸ƒ RSS æº

> åŸæ–‡:[https://dev . to/mikewheaton/publishing-an-RSS-feed-with-Gatsby-a3m](https://dev.to/mikewheaton/publishing-an-rss-feed-with-gatsby-a3m)

## [](#wait-whats-rss)ç­‰ç­‰ï¼ŒRSS æ˜¯ä»€ä¹ˆï¼Ÿ

åœ¨ä»–ä»¬å…³äº[å¦‚ä½•å·åœŸé‡æ¥](https://www.wired.com/story/rss-readers-feedly-inoreader-old-reader/)çš„æ–‡ç« ä¸­ï¼Œã€Šè¿çº¿ã€‹è§£é‡Šé“:

> å®ƒçš„ç›®æ ‡å¾ˆç®€å•:ä»¥ä¸€ç§æ ‡å‡†åŒ–çš„æ ¼å¼è·Ÿè¸ªç»™å®šç½‘ç«™å†…å®¹çš„æ›´æ–°...å®ƒå¯ä»¥ç»™ä½ ä¸€ä¸ªå…¨é¢çš„ï¼Œå®šæœŸæ›´æ–°çš„ä½ æœ€å–œæ¬¢çš„ç½‘ç«™å…¨å¤©å‘å¸ƒçš„æ‰€æœ‰å†…å®¹ã€‚

è¿™ç§æ ‡å‡†åŒ–æ ¼å¼æ˜¯ä¸€ä¸ª XML æ–‡ä»¶(è§æœ¬ç½‘ç«™çš„ä¸€ä¸ªæ–‡ä»¶)ï¼Œå®ƒå…è®¸åƒ T2 è¿™æ ·çš„åº”ç”¨åœ¨ä½ å‘å¸ƒæ–°å†…å®¹æ—¶é€šçŸ¥ç”¨æˆ·ã€‚

ä¸ºä½ çš„ [Gatsby](https://www.gatsbyjs.org/) åšå®¢ç”Ÿæˆè¿™ä¸ªç›¸å½“ç®€å•ã€‚

## [](#publishing-a-feed)å‘å¸ƒè®¢é˜…æº

é¦–å…ˆå°† [gatsby-plugin-feed](https://www.npmjs.com/package/gatsby-plugin-feed) åŒ…æ·»åŠ åˆ°æ‚¨çš„ç«™ç‚¹ã€‚

```
npm install --save gatsby-plugin-feed 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨å°†å®ƒæ·»åŠ åˆ°`gatsby-config.js`ä¸­çš„æ’ä»¶æ•°ç»„ä¸­ã€‚

```
plugins: [
  // Other plugins will already be here, don't forget the comma.
  'gatsby-plugin-feed',
]; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

RSS æºä»…åœ¨ç”Ÿäº§æ¨¡å¼ä¸‹ç”Ÿæˆã€‚ä½ å¯ä»¥é€šè¿‡è¿è¡Œ`gatsby build && gatsby serve`å¹¶å¯¼èˆªåˆ° [http://localhost:9000/](http://localhost:9000/) æ¥æµ‹è¯•å®ƒã€‚

æ­å–œä½ ï¼Œä½ æœ‰ RSS æºäº†ï¼ğŸ‰

æˆ–è€…ä¹Ÿè®¸ä½ åƒæˆ‘ä¸€æ ·ç›¯ç€ä¸€ä¸ªä¸‘é™‹çš„é”™è¯¯ä¿¡æ¯ã€‚è®©æˆ‘ä»¬æŠŠå®ƒä¿®å¥½ã€‚

## [](#customizing-the-feed)å®šåˆ¶ feed

é»˜è®¤æƒ…å†µä¸‹ï¼Œæ’ä»¶ä¼šå¯»æ‰¾ä¸€ä¸ªä¸æ¯ç¯‡åšæ–‡ç›¸å…³è”çš„`slug`å­—æ®µã€‚è¿™æ˜¯ä»£è¡¨æ–‡ç« çš„ URL çš„ä¸€éƒ¨åˆ†ï¼Œä¾‹å¦‚ */blog/the-post-title* ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸ä¼šä¸ºæ¯ä¸ªå¸–å­ç”Ÿæˆã€‚

è™½ç„¶ä½ å¯ä»¥é…ç½®[å¦ä¸€ä¸ªæ’ä»¶](https://www.gatsbyjs.org/packages/gatsby-plugin-slug/)æ¥ç”Ÿæˆ slugsï¼Œä½†æ˜¯ä½ å¯ä»¥é€šè¿‡åœ¨æ¯ç¯‡æ–‡ç« çš„å‰é¢åŒ…å«ä¸€ä¸ª`path`æ¥å®Œå…¨æ§åˆ¶ä½ çš„ URLã€‚

```
--------
path: '/blog/the-post-title'
--------

The content of your post. 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ¥ä¸‹æ¥ï¼Œæ›´æ–°`gatsby-config.js`,ç”¨åŒ…å«æ‚¨çš„å®šåˆ¶é…ç½®çš„å¯¹è±¡æ›¿æ¢æ‚¨ä¹‹å‰æ·»åŠ çš„å•è¡Œ(ä½¿ç”¨é»˜è®¤é€‰é¡¹)ã€‚

```
{
  resolve: `gatsby-plugin-feed`,
  options: {
    query: `
      {
        site {
          siteMetadata {
            siteUrl
          }
        }
      }
    `,
    feeds: [
      {
        serialize: ({ query: { site, allMarkdownRemark } }) => {
          return allMarkdownRemark.edges.map(edge => {
            return Object.assign({}, edge.node.frontmatter, {
              description: edge.node.excerpt,
              date: edge.node.frontmatter.date,
              url: site.siteMetadata.siteUrl + edge.node.frontmatter.path,
              guid: site.siteMetadata.siteUrl + edge.node.frontmatter.path,
              custom_elements: [{ 'content:encoded': edge.node.html }],
            });
          });
        },
        query: `
          {
            allMarkdownRemark(
              limit: 1000,
              sort: { order: DESC, fields: [frontmatter___date] }
            ) {
              edges {
                node {
                  excerpt
                  html
                  frontmatter {
                    date
                    path
                  }
                }
              }
            }
          }
        `,
        output: '/rss.xml',
        title: "RSS Feed",
      },
    ],
  },
}, 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å¹¶ä¸åƒçœ‹èµ·æ¥é‚£ä¹ˆå¤æ‚ã€‚æ‚¨çš„ RSS æè¦æ˜¯ç”±`serialize()`å‡½æ•°ç”Ÿæˆçš„ã€‚æ‚¨å°†çœ‹åˆ°å®ƒè¿”å›ä¸€ä¸ªå¸–å­æ•°ç»„ï¼Œæ¯ä¸ªå¸–å­æœ‰ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«æè¿°å’Œå‘å¸ƒæ—¥æœŸç­‰å±æ€§ã€‚è¿™äº›å€¼æ¥è‡ªå¯¹ç½‘ç«™å…ƒæ•°æ®(é¡¶éƒ¨)å’Œåšå®¢æ–‡ç« (åº•éƒ¨)çš„ GraphQL æŸ¥è¯¢ã€‚

ä¸Šé¢çš„ä»£ç å¾ˆæœ‰å¯èƒ½å¯¹ä½ æœ‰ç”¨ã€‚å¦‚æœæ²¡æœ‰ï¼Œä½¿ç”¨ [GraphiQL](http://localhost:8000/___graphql) å·¥å…·æ¥æµ‹è¯•æŸ¥è¯¢å¹¶æ¢ç´¢å¯ç”¨çš„æ•°æ®ï¼Œç›´åˆ°èƒ½å¤Ÿå®Œæˆæ¯ä¸ªå¸–å­è¿”å›çš„å¯¹è±¡ã€‚

è™½ç„¶å¯èƒ½éœ€è¦å‡ æ¬¡å°è¯•æ¥è§£å†³è¿™äº›é”™è¯¯ï¼Œä½†æ‚¨å¾ˆå¿«å°±ä¼šæ‹¥æœ‰è‡ªå·±çš„åšå®¢é…ç½®äº†ã€‚è¿™æ˜¯ä¸€ä¸ª*è®¾ç½®å®ƒï¼Œç„¶åå¿˜è®°å®ƒ*çš„ä»»åŠ¡ï¼Œå½“ä½ çš„ç½‘ç«™å»ºç«‹æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæœ€æ–°å¸–å­çš„ RSS æºã€‚

## [](#next-steps)ä¸‹ä¸€æ­¥

*   ä½¿ç”¨åƒ [Feedly](https://feedly.com/) è¿™æ ·çš„åº”ç”¨ç¨‹åºè®¢é˜…ä½ çš„åšå®¢ï¼Œéšæ—¶å…³æ³¨ä½ çš„ RSS è®¢é˜…ã€‚
*   æ¢ç´¢[æ’ä»¶çš„å…¶ä»–é…ç½®é€‰é¡¹](https://www.npmjs.com/package/rss#itemoptions)ã€‚
*   äº†è§£æ›´å¤šå…³äº [GraphQL æŸ¥è¯¢](https://graphql.org/learn/queries/)çš„ä¿¡æ¯ã€‚