# 0cjsï¼Webpack4 æ•™ç¨‹:æ„å»ºä¸å¸¦é…ç½®æ–‡ä»¶çš„ React åº”ç”¨ç¨‹åºã€‚

> åŸæ–‡:[https://dev . to/Shi sama/0cjs-web pack 4-tutorial-building-react-app-without-config-file-1 nkb](https://dev.to/shisama/0cjs-webpack4-tutorial-building-react-app-without-config-file-1nkb)

~~1 æœˆï¼Œwebpack4 é¢„å‘å¸ƒä¸º beta 0ã€‚~~
2 æœˆ 25 æ—¥ï¼Œwebpack4 å‘å¸ƒğŸ‰
Webpack4 é»˜è®¤ä¸éœ€è¦é…ç½®æ–‡ä»¶ï¼
è¿™è®©æˆ‘å¾ˆå…´å¥‹ï¼Œæˆ‘è¯•å›¾åœ¨æ²¡æœ‰ webpack é…ç½®çš„æƒ…å†µä¸‹æ„å»ºæˆ‘çš„ React åº”ç”¨ã€‚

# å…³äº webpack4

è¯·å‚è€ƒä¸‹é¢çš„é“¾æ¥ã€‚

*   [å‘å¸ƒ 4.0.0-beta.0 webpack/webpack](https://github.com/webpack/webpack/releases/tag/v4.0.0-beta.0)
*   webpack 4 æµ‹è¯•ç‰ˆâ€”ç«‹å³è¯•ç”¨ï¼
*   [Webpack 4 æ•™ç¨‹:æ‰€æœ‰ä½ éœ€è¦çŸ¥é“çš„ï¼Œä» 0 Conf åˆ°ç”Ÿäº§æ¨¡å¼](https://www.valentinog.com/blog/webpack-4-tutorial/)
*   [å‘å¸ƒ 4.0.0 ç‰ˆ webpack/webpack](https://github.com/webpack/webpack/releases/tag/v4.0.0)

# å…¶ä»–å·¥å…·

*   å·´åˆ«é¢„è®¾ç¯å¢ƒ
*   å·´åˆ«å¡”-é¢„è®¾-ååº”
*   æµåŠ¨

# æˆ‘çš„ç½‘é¡µåŒ…é…ç½®

```
const path = require('path');
const webpack = require('webpack');

module.exports = {
  entry: {
    'index': [
      path.resolve(__dirname, 'src/index.js')
    ]
  },
  output: {
    filename: '[name].js',
    path: path.resolve(__dirname, 'public'),
    publicPath: '/',
  },
  plugins: [
    new webpack.DefinePlugin({
      'process.env.NODE_ENV': JSON.stringify(process.env.NODE_ENV)
    }),
    new webpack.optimize.UglifyJsPlugin(),
  ],
  module: {
    rules: [
      {
        test: /\.(js|jsx)$/,
        use: 'babel-loader',
      },
    ]
  },
  resolve: {
    extensions: ['.js', '.jsx'],
  },
}; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# å¦‚ä½•ä½¿ç”¨ webpack4

## å®‰è£…

æ‚¨å¿…é¡»å®‰è£… webpack 4 å’Œ webpack-cliã€‚åœ¨ webpack 4 ä¸­ï¼Œwebpack-cli æ˜¯åœ¨å‘½ä»¤è¡Œä¸Šæ‰§è¡Œ webpack æ‰€å¿…éœ€çš„ã€‚

```
npm install --save-dev webpack webpack-cli 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## æ„å»ºæ—¶ä¸é…ç½®

### æ¨¡å—-ç»‘å®š

é¦–å…ˆï¼Œæˆ‘åœ¨æ²¡æœ‰é…ç½®å’Œé€‰é¡¹çš„æƒ…å†µä¸‹æ‰§è¡Œäº† webpackã€‚
å‡ºç°é”™è¯¯ã€‚

```
Module parse failed: Unexpected token (15:6)
You may need an appropriate loader to handle this file type.
|   render() {
|     return (
|       <div> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸Šè¿°é”™è¯¯æ„å‘³ç€ babel æ— æ•ˆï¼Œwebpack ä¸åˆ†æ jsx è¯­æ³•ã€‚ä½¿ç”¨ configï¼Œä¸‹é¢çš„ä»£ç è§£å†³äº†è¿™ä¸ªé”™è¯¯ã€‚

```
module: {
  rules: [
    {
      test: /\.(js|jsx)$/,
      use: 'babel-loader',
    },
  ]
}, 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœä½ æƒ³ä½¿ç”¨ babel-loaderï¼Œä½ éœ€è¦ä½¿ç”¨`--module-bind`é€‰é¡¹ã€‚
ç”¨æ³•:`--module-bind {extension}={loader-name}`

```
webpack --module-bind 'js=babel-loader' --module-bind 'jsx=babel-loader' 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### è§£æ-æ‰©å±•

è™½ç„¶`--module-bind`é€‰é¡¹æœ‰æ•ˆï¼Œä½†å‡ºç°äº†å…¶ä»–é”™è¯¯ã€‚

```
Module not found: Error: Can't resolve './Foo' in '/path/to/src' 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™ä¸ªé”™è¯¯æ„å‘³ç€å¯¼å…¥æ¨¡å—å¤±è´¥ï¼Œ
è¿™ä¸ªé”™è¯¯å‘ç”Ÿçš„åŸå› æ˜¯æˆ‘å¿½ç•¥äº†å¦‚ä¸‹ä»£ç çš„æ‰©å±•ã€‚

```
import Foo from 'components/Foo' 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸‹é¢çš„é…ç½®è§£å†³äº†è¿™ä¸ªé”™è¯¯ã€‚

```
resolve: {
  extensions: ['.js', '.jsx'],
}, 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

Webpack4 æœ‰`--resolve-extensions` cli é€‰é¡¹ã€‚
ä½¿ç”¨`--module-bind`å’Œ`--resolve-extensions`é€‰é¡¹ï¼Œ
è®¾ç½®åº”è¯¥ç”¨äºè§£ææ¨¡å—çš„æ‰©å±•(ä¾‹å¦‚`--resolve-extensions .js,.jsx` )

```
webpack --module-bind 'js=babel-loader' --module-bind 'jsx=babel-loader' --resolve-extensions .js,.jsx 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### æ¨¡å¼

å¥½çš„ï¼Œé”™è¯¯å·²ç»è§£å†³ğŸ˜Šä½†æ˜¯æ˜¾ç¤ºè­¦å‘Šã€‚

```
WARNING in configuration
The 'mode' option has not been set. Set 'mode' option to 'development' or 'production' to enable defaults for this environment. 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¼•ç”¨è‡ª[ç‰ˆæœ¬è¯´æ˜ 4.0.0-beta.0](https://github.com/webpack/webpack/releases/tag/v4.0.0-beta.0)

*   ä½ ç°åœ¨å¿…é¡»åœ¨ä¸¤ç§æ¨¡å¼ä¹‹é—´åšå‡ºé€‰æ‹©:ç”Ÿäº§è¿˜æ˜¯å¼€å‘
    *   ç”Ÿäº§æ”¯æŒå„ç§ä¼˜åŒ–æ¥ç”Ÿæˆä¼˜åŒ–çš„åŒ…
    *   å¼€å‘å¯ç”¨æ³¨é‡Šå’Œå¼€å‘æç¤ºï¼Œå¹¶å¯ç”¨ eval devtool
    *   WIP:å¼€å‘æ¨¡å¼ä¸­çš„é™„åŠ æç¤º
    *   ç”Ÿäº§ä¸æ”¯æŒè§‚çœ‹ï¼Œå¼€å‘é’ˆå¯¹å¿«é€Ÿå¢é‡é‡å»ºè¿›è¡Œäº†ä¼˜åŒ–
    *   ç”Ÿäº§è¿˜æ”¯æŒæ¨¡å—è¿æ¥(èŒƒå›´æå‡)
    *   æ‚¨å¯ä»¥ä½¿ç”¨ä¼˜åŒ–ä¸­çš„æ ‡å¿—å¯¹æ­¤è¿›è¡Œè¯¦ç»†é…ç½®ã€‚*(æ„å»ºæ‚¨çš„è‡ªå®šä¹‰æ¨¡å¼)
    *   process.env.NODE_ENV è®¾ç½®ä¸ºç”Ÿäº§æˆ–å¼€å‘(ä»…åœ¨æ„å»ºçš„ä»£ç ä¸­ï¼Œä¸åœ¨é…ç½®ä¸­)
    *   æœ‰ä¸€ä¸ªéšè—çš„æ— æ¨¡å¼ï¼Œç¦ç”¨ä¸€åˆ‡

å¿…é¡»æ·»åŠ é€‰é¡¹ã€‚

```
webpack --module-bind 'js=babel-loader' --module-bind 'jsx=babel-loader' --resolve-extensions .js,.jsx --mode production 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### æ¡ç›®

æ‚¨å¯ä»¥æŒ‡å®šå…¥å£ç‚¹ã€‚
`--entry src`è¡¨ç¤ºåˆ‡å…¥ç‚¹æ˜¯`src/index.js`ã€‚
`--entry src/foo.js`è¡¨ç¤ºåˆ‡å…¥ç‚¹æ˜¯`src/foo.js`

### è¾“å‡º

æ­¤å¤–ï¼Œæ‚¨å¯ä»¥æŒ‡å®šè¾“å‡ºç‚¹ã€‚
`--output public`è¡¨ç¤ºè¾“å‡ºç›®å½•ä¸º`public`ã€‚
`--output public/index.bundle.js`è¡¨ç¤ºè¾“å‡ºç›®å½•ä¸º`public`ï¼Œè¾“å‡ºæ–‡ä»¶åä¸º`index.bundle.js`ã€‚
T5 æ˜¯`--output`çš„ç®€å†™ã€‚

### æœ€ç»ˆ

```
webpack --module-bind 'js=babel-loader' --module-bind 'jsx=babel-loader' --resolve-extensions .js,.jsx --mode production --entry ./src --output public/index.bundle.js 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## å…¶ä»–é€‰é¡¹

ç”¨`--help`é€‰é¡¹å¯ä»¥çŸ¥é“å…¶ä»–é€‰é¡¹ã€‚

```
webpack --help 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# è¿›ä¸€æ­¥é˜…è¯»

*   [å‘å¸ƒ 4.0.0-beta.0 webpack/webpack](https://github.com/webpack/webpack/releases/tag/v4.0.0-beta.0)
*   webpack 4 æµ‹è¯•ç‰ˆâ€”ç«‹å³è¯•ç”¨ï¼
*   [Webpack 4 æ•™ç¨‹:æ‰€æœ‰ä½ éœ€è¦çŸ¥é“çš„ï¼Œä» 0 Conf åˆ°ç”Ÿäº§æ¨¡å¼](https://www.valentinog.com/blog/webpack-4-tutorial/)
*   [ä¿æŒ webpack å¿«é€Ÿè¿è¡Œ:æé«˜æ„å»ºæ€§èƒ½çš„ç°åœºæŒ‡å—](https://slack.engineering/keep-webpack-fast-a-field-guide-for-better-build-performance-f56a5995e8f1)

è°¢è°¢ä½ ã€‚